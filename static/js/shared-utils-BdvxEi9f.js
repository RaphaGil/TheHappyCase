var q=Object.defineProperty,W=Object.defineProperties;var A=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var T=(e,r,s)=>r in e?q(e,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[r]=s,h=(e,r)=>{for(var s in r||(r={}))M.call(r,s)&&T(e,s,r[s]);if(B)for(var s of B(r))Q.call(r,s)&&T(e,s,r[s]);return e},z=(e,r)=>W(e,A(r));var P=(e,r,s)=>new Promise((o,i)=>{var u=c=>{try{a(s.next(c))}catch(l){i(l)}},t=c=>{try{a(s.throw(c))}catch(l){i(l)}},a=c=>c.done?o(c.value):Promise.resolve(c.value).then(u,t);a((s=s.apply(e,r)).next())});const E=[{id:1,name:"Economy Case",type:"economy",images:["/images/SmartCase/economycaselightpink.webp","/images/SmartCase/economycasered.webp","/images/SmartCase/economycasejeansblue.webp","/images/SmartCase/economycasebrown.webp","/images/SmartCase/economycaselightblue.webp","/images/SmartCase/economycasedarkbrown.webp","/images/SmartCase/economycaseblack.webp","/images/SmartCase/economycaselightbrown.webp"],colors:[{color:"#f49f90",image:"/images/SmartCase/economycaselightpink.webp"},{color:"#cb0025",image:"/images/SmartCase/economycasered.webp"},{color:"#9cb4b8",image:"/images/SmartCase/economycaselightblue.webp"},{color:"#627386",image:"/images/SmartCase/economycasejeansblue.webp"},{color:"#3a4763",image:"/images/SmartCase/economycasedarkblue.webp"},{color:"#c96e50",image:"/images/SmartCase/economycaselightbrown.webp"},{color:"#b0582c",image:"/images/SmartCase/economycasebrown.webp"},{color:"#59332e",image:"/images/SmartCase/economycasedarkbrown.webp"},{color:"#506258",image:"/images/SmartCase/economycasegreen.webp"},{color:"#89837e",image:"/images/SmartCase/economycasegray.webp"},{color:"#413f44",image:"/images/SmartCase/economycaseblack.webp"}],specifications:{dimensions:"14.9cm (W) x 10.7cm (H) x 1cm (D)",rfid:"Yes",material:"PU Leather",closure:"Magnetic Snap Closure",cardSlots:"3",features:"RFID Protection, Water Resistant, Lightweight Design",interior:"Document Pocket, Boarding Pass Slot, SIM Card Slot",care:"Wipe clean with damp cloth"},basePrice:8},{id:2,name:"Business Class Case",type:"business",images:["/images/BusinessClassCase/businessclasscasegray.webp","/images/BusinessClassCase/businessclasscasepink.webp","/images/BusinessClassCase/businessclasscaselightpink.webp","/images/BusinessClassCase/businessclasscasebrown.webp","/images/BusinessClassCase/businessclasscaseblack.webp","/images/BusinessClassCase/businessclasscaseblack.webp","/images/BusinessClassCase/businessclassinside.webp","/images/BusinessClassCase/businessclassinside2.webp"],colors:[{color:"#c8b593",image:"/images/BusinessClassCase/businessclasscasegray.webp"},{color:"#da8ca6",image:"/images/BusinessClassCase/businessclasscaselightpink.webp"},{color:"#daaf49",image:"/images/BusinessClassCase/businessclasscaseyellow.webp"},{color:"#d33d72",image:"/images/BusinessClassCase/businessclasscasepink.webp"},{color:"#c49154",image:"/images/BusinessClassCase/businessclasscasebrown.webp"},{color:"#36312b",image:"/images/BusinessClassCase/businessclasscaseblack.webp"}],specifications:{dimensions:"14cm (W) x 9.5cm (H) x 1cm (D)",rfid:"No",material:"Genuine Leather",closure:"No Closure",cardSlots:"4",interior:"Passport Pocket, Document Pocket",care:"Clean with leather conditioner, avoid excessive moisture"},basePrice:12},{id:3,name:"First Class Case",type:"firstclass",images:["/images/FirstClassCase/firstclassbrown.webp","/images/FirstClassCase/firstclasscaseblack.webp","/images/FirstClassCase/firstclasscasenavyblue.webp","/images/FirstClassCase/firstclasscasebrickred.webp","/images/FirstClassCase/firstclasscasepink.webp","/images/FirstClassCase/firstclasscasebrown.webp","/images/FirstClassCase/firstclasscaseblue.webp","/images/FirstClassCase/firstclasscasegray.webp","/images/FirstClassCase/firstclasscasepurple.webp","/images/FirstClassCase/firstclasscasegreen.webp","/images/FirstClassCase/firstclasscasedarkpink.webp"],colors:[{color:"#d17956",image:"/images/FirstClassCase/firstclasscasebrown.webp"},{color:"#c76f82",image:"/images/FirstClassCase/firstclasscasebrickred.webp"},{color:"#adcfa8",image:"/images/FirstClassCase/firstclasscasegreen.webp"},{color:"#ab8b72",image:"/images/FirstClassCase/firstclasscasedarkpink.webp"},{color:"#bfa29c",image:"/images/FirstClassCase/firstclasscasepink.webp"},{color:"#a799ab",image:"/images/FirstClassCase/firstclasscasepurple.webp"},{color:"#afab9b",image:"/images/FirstClassCase/firstclasscasegray.webp"},{color:"#5f6074",image:"/images/FirstClassCase/firstclasscasenavyblue.webp"},{color:"#768695",image:"/images/FirstClassCase/firstclasscaseblue.webp"},{color:"#cea55c",image:"/images/FirstClassCase/firstclasscaselightbrown.webp"},{color:"#272a34",image:"/images/FirstClassCase/firstclasscaseblack.webp"}],specifications:{dimensions:"14cm (W) x 10.5cm (H) x 1.5cm (D)",rfid:"Yes",material:"Genuine Leather",closure:"Button Snap Closure",cardSlots:"3",interior:" Document Pocket, Boarding Pass Slot, SIM Card Slot",features:"Coin Pouch, RFID Protection, Water Resistant"},basePrice:12}],x={flags:[{id:1,name:"Albania Flag",src:"/images/Flags/albania.webp",price:2,size:.5,continent:"europe"},{id:2,name:"Armenia Flag",src:"/images/Flags/armenia.webp",price:2,size:.5,continent:"europe"},{id:3,name:"Belgium Flag",src:"/images/Flags/belgium.webp",price:2,size:.5,continent:"europe"},{id:4,name:"Bosnia  Flag",src:"/images/Flags/bosnia.webp",price:2,size:.5,continent:"europe"},{id:5,name:"Brazil Flag",src:"/images/Flags/brazil.webp",price:2,size:.5,continent:"americas"},{id:6,name:"British Virgin Islands Flag",src:"/images/Flags/britishvirginislands.webp",price:2,size:.5,continent:"americas"},{id:7,name:"Croatia Flag",src:"/images/Flags/croatia.webp",price:2,size:.5,continent:"europe"},{id:8,name:"Dublin Flag",src:"/images/Flags/dublin.webp",price:2,size:.5,continent:"europe"},{id:9,name:"Egypt Flag",src:"/images/Flags/egypt.webp",price:2,size:.5,continent:"africa"},{id:10,name:"France Flag",src:"/images/Flags/france.webp",price:2,size:.5,continent:"europe"},{id:11,name:"Germany Flag",src:"/images/Flags/germany.webp",price:2,size:.5,continent:"europe"},{id:12,name:"India Flag",src:"/images/Flags/india.webp",price:2,size:.5,continent:"asia"},{id:13,name:"Italy Flag",src:"/images/Flags/italy.webp",price:2,size:.5,continent:"europe"},{id:14,name:"Jamaica  Flag",src:"/images/Flags/jamaica.webp",price:2,size:.5,continent:"americas"},{id:15,name:"Japan  Flag",src:"/images/Flags/japan.webp",price:2,size:.5,continent:"americas"},{id:16,name:"Hungary Flag",src:"/images/Flags/hungary.webp",price:2,size:.5,continent:"americas"},{id:17,name:"LGBTQIA+ Flag",src:"/images/Flags/lgbtqia.webp",price:2,size:.5,continent:"special"},{id:18,name:"Netherlands Flag",src:"/images/Flags/netherlands.webp",price:2,size:.5,continent:"europe"},{id:19,name:"Norway Flag",src:"/images/Flags/norway.webp",price:2,size:.5,continent:"europe"},{id:20,name:"Portugal Flag",src:"/images/Flags/portugal.webp",price:2,size:.5,continent:"europe"},{id:21,name:"Puerto Rico  Flag",src:"/images/Flags/puertorico.webp",price:2,size:.5,continent:"americas"},{id:22,name:"Scotland Flag",src:"/images/Flags/scotland.webp",price:2,size:.5,continent:"europe"},{id:23,name:"South Africa Flag",src:"/images/Flags/southafrica.webp",price:2,size:.5,continent:"africa"},{id:24,name:"Spain Flag",src:"/images/Flags/spain.webp",price:2,size:.5,continent:"europe"},{id:25,name:"Sweden Flag",src:"/images/Flags/sweden.webp",price:2,size:.5,continent:"europe"},{id:26,name:"Switzerland Flag",src:"/images/Flags/switzerland.webp",price:2,size:.5,continent:"europe"},{id:27,name:"United Kingdon Flag",src:"/images/Flags/uk.webp",price:2,size:.5,continent:"europe"},{id:28,name:"United States Flag",src:"/images/Flags/eua.webp",price:2,size:.5,continent:"americas"}],colorful:[{id:1,name:"Be a Good Human",src:"/images/ColorfulPins/beagoodhuman.webp",price:2,size:.7,subCategory:"inspiration"},{id:2,name:"Airplane",src:"/images/ColorfulPins/airplane.webp",price:2,size:.75,subCategory:"travel"},{id:3,name:"Heart Globe",src:"/images/ColorfulPins/heartglobe.webp",price:2,size:.7},{id:4,name:"Dream Big",src:"/images/ColorfulPins/dreambig.webp",price:2,size:.9,subCategory:"inspiration"},{id:5,name:"Paw",src:"/images/ColorfulPins/paw.webp",price:2,size:.4},{id:6,name:"Colorful Camera",src:"/images/ColorfulPins/camera.webp",price:2,size:.55,subCategory:"camera"},{id:7,name:"Be Kind",src:"/images/ColorfulPins/bekind.webp",price:2,size:.75,subCategory:"inspiration"},{id:8,name:"Football",src:"/images/ColorfulPins/football.webp",price:2,size:.75},{id:9,name:"Ticket to Happiness",src:"/images/ColorfulPins/tickettohappiness.webp",price:2,size:.8,subCategory:"inspiration"},{id:10,name:"Be Happy",src:"/images/ColorfulPins/behappy.webp",price:2,size:.75,subCategory:"inspiration"},{id:11,name:"Lucky Leaf",src:"/images/ColorfulPins/luckyleafcharm.webp",price:2,size:.5,subCategory:"nature"},{id:12,name:"Beer",src:"/images/ColorfulPins/beer.webp",price:2,size:.65,subCategory:"drinks"},{id:13,name:"Bottle of Wine",src:"/images/ColorfulPins/bottleofwine.webp",price:2,size:.8,subCategory:"drinks"},{id:14,name:"Heart Notification",src:"/images/ColorfulPins/heartnotification.webp",price:2,size:.5,subCategory:"hearts"},{id:15,name:"Small Boarding Pass",src:"/images/ColorfulPins/smallboardingpass.webp",price:2,size:.75,subCategory:"travel"},{id:16,name:"Little Heart",src:"/images/ColorfulPins/littleheart.webp",price:2,size:.5,subCategory:"hearts"},{id:17,name:"Disney",src:"/images/ColorfulPins/disney.webp",price:2,size:.75,subCategory:"disney"},{id:18,name:"Pluto",src:"/images/ColorfulPins/pluto.webp",price:2,size:.85,subCategory:"disney"},{id:19,name:"Round Minnnie",src:"/images/ColorfulPins/roundminnie.webp",price:2,size:.85,subCategory:"disney"},{id:20,name:"Round Mickey",src:"/images/ColorfulPins/roundmickey.webp",price:2,size:.85,subCategory:"disney"},{id:21,name:"Guufy",src:"/images/ColorfulPins/guufy.webp",price:2,size:.85,subCategory:"disney"},{id:22,name:"Map",src:"/images/ColorfulPins/map.webp",price:2,size:.85,subCategory:"travel"},{id:23,name:"London Phone",src:"/images/ColorfulPins/telephone.webp",price:2,size:.85},{id:24,name:"Adventure Awaits Ticket",src:"/images/ColorfulPins/adventureawaits.webp",price:2,size:.85,subCategory:"travel"},{id:25,name:"Passport",src:"/images/ColorfulPins/passport.webp",price:2,size:.75,subCategory:"travel"},{id:26,name:"Coffee",src:"/images/ColorfulPins/coffee.webp",price:2,size:.5,subCategory:"drinks"},{id:27,name:"Coconut Tree",src:"/images/ColorfulPins/coconuttree.webp",price:2,size:.8,subCategory:"nature"},{id:28,name:"Wave",src:"/images/ColorfulPins/wave.webp",price:3.5,size:.6},{id:29,name:"Suitcase",src:"/images/ColorfulPins/orangeluggage.webp",price:2,size:.7,subCategory:"travel"},{id:30,name:"Black Camera",src:"/images/ColorfulPins/blackcamera.webp",price:2,size:.8,subCategory:"camera"},{id:31,name:"Pink Camera",src:"/images/ColorfulPins/pinkcamera.webp",price:2,size:.5,subCategory:"camera"},{id:32,name:"Daisy Duck",src:"/images/ColorfulPins/daisyduck.webp",price:2,size:.7,subCategory:"disney"},{id:33,name:"Duck",src:"/images/ColorfulPins/duck.webp",price:2,size:.75,subCategory:"disney"},{id:34,name:"Minnie",src:"/images/ColorfulPins/minnie.webp",price:2,size:.7,subCategory:"disney"},{id:35,name:"Mickey Mouse",src:"/images/ColorfulPins/mickey.webp",price:2,size:.75,subCategory:"disney"},{id:36,name:"Combi",src:"/images/ColorfulPins/combi.webp",price:2,size:.7,subCategory:"travel"},{id:37,name:"Wine",src:"/images/ColorfulPins/wineglass.webp",price:2,size:.4,subCategory:"drinks"},{id:38,name:"Vacation",src:"/images/ColorfulPins/vacation.webp",price:2,size:.8,subCategory:"travel"},{id:39,name:"Love",src:"/images/ColorfulPins/love.webp",price:2,size:.8,subCategory:"travel"}],bronze:[{id:1,name:"Airplane",src:"/images/BronzePins/airplane.webp",price:1,size:.7,subCategory:"travel"},{id:2,name:"Cardinal Points",src:"/images/BronzePins/cardinalpoints.webp",price:1,size:.65,subCategory:"symbols"},{id:3,name:"Camera",src:"/images/BronzePins/camera.webp",price:1,size:.55,subCategory:"symbols"},{id:4,name:"Globe",src:"/images/BronzePins/globe.webp",price:1,size:.55,subCategory:"travel"},{id:5,name:"Passport",src:"/images/BronzePins/passport.webp",price:1,size:.4,subCategory:"travel"},{id:6,name:"NYC Taxi",src:"/images/BronzePins/nyctaxi.webp",price:1,size:.9,subCategory:"travel"},{id:7,name:"Liberty Statue",src:"/images/BronzePins/libertystatue.webp",price:1,size:1,subCategory:"travel"},{id:8,name:"Luggage",src:"/images/BronzePins/luggage.webp",price:1,size:.45,subCategory:"travel"},{id:9,name:"London Bus",src:"/images/BronzePins/london.webp",price:1,size:.7,subCategory:"travel"},{id:10,name:"Lucky Leaf",src:"/images/BronzePins/luckyleaf.webp",price:1,size:.45,subCategory:"nature"},{id:11,name:"Little Heart",src:"/images/BronzePins/littleheart.webp",price:1,size:.25,subCategory:"love"},{id:12,name:"Eiffel Towel",src:"/images/BronzePins/eiffeltowel.webp",price:1,size:.8},{id:13,name:"Kangaroo",src:"/images/BronzePins/kangaroo.webp",price:1,size:.9,subCategory:"animals"},{id:14,name:"Koala",src:"/images/BronzePins/koala.webp",price:1,size:.5,subCategory:"animals"},{id:15,name:"Hamsa Hand",src:"/images/BronzePins/hamsahand.webp",price:1,size:.9,subCategory:"symbols"},{id:16,name:"Thailand",src:"/images/BronzePins/thailand.webp",price:1,size:.9,subCategory:"symbols"},{id:17,name:"Mummy",src:"/images/BronzePins/mummy.webp",price:1,size:.7,subCategory:"symbols"},{id:18,name:"Llama",src:"/images/BronzePins/llama.webp",price:1,size:.7,subCategory:"animals"},{id:19,name:"India",src:"/images/BronzePins/india.webp",price:1,size:.5,subCategory:"symbols"},{id:20,name:"Pyramid",src:"/images/BronzePins/pyramid.webp",price:1,size:.8},{id:21,name:"Arc The Triomphe",src:"/images/BronzePins/arcthetriomphe.webp",price:1,size:.5},{id:22,name:"Maple Leaf",src:"/images/BronzePins/mapleleaf.webp",price:1,size:.6,subCategory:"nature"},{id:23,name:"Love",src:"/images/BronzePins/love.webp",price:1,size:.8,subCategory:"love"},{id:24,name:"Airplane War",src:"/images/BronzePins/airplanewar.webp",price:1,size:.8},{id:25,name:"Enjoy the Journey",src:"/images/BronzePins/enjoythejourney.webp",price:1,size:1,subCategory:"symbols"},{id:26,name:"Heart",src:"/images/BronzePins/heart.webp",price:1,size:.7,subCategory:"love"},{id:27,name:"I love Jesus",src:"/images/BronzePins/ilovejesus.webp",price:1,size:.5,subCategory:"love"},{id:28,name:"Butterfly",src:"/images/BronzePins/butterfly.webp",price:1,size:.7,subCategory:"nature"},{id:29,name:"Squirrel",src:"/images/BronzePins/squirrel.webp",price:1,size:.5},{id:30,name:"Canada",src:"/images/BronzePins/canada.webp",price:1,size:.6,subCategory:"symbols"},{id:31,name:"Flipflop",src:"/images/BronzePins/flipflop.webp",price:1,size:.5,subCategory:"nature"},{id:32,name:"Paw",src:"/images/BronzePins/paw.webp",price:1,size:.5,subCategory:"animals"},{id:33,name:"PawDog",src:"/images/BronzePins/pawheart.webp",price:1,size:.45,subCategory:"animals"},{id:34,name:"I love my dog",src:"/images/BronzePins/ilovemydog.webp",price:1,size:.5,subCategory:"animals"},{id:35,name:"Money",src:"/images/BronzePins/money.webp",price:1,size:.55},{id:36,name:"Dog Bone",src:"/images/BronzePins/dogbone.webp",price:1,size:.5,subCategory:"animals"}]},f={cases:E,pins:x},D=e=>{var r,s;if(e.customDesign||e.designImage)return`custom-${e.id||Date.now()}`;if(e.type==="charm"||e.category&&e.pin){const o=e.category||e.pin&&e.pin.category||"colorful",i=((r=e.pin)==null?void 0:r.name)||((s=e.pin)==null?void 0:s.src)||e.name||"";return`charm-${o}-${i}`}if(e.caseType&&e.color){if(e.pins&&e.pins.length>0){const o=e.pins.map(i=>i.name||i.src).sort().join("-");return`case-${e.caseType}-${e.color}-pins-${o}`}return`case-${e.caseType}-${e.color}`}return e.id&&e.id.startsWith("case-")?`unique-${e.id}`:e.id?`item-${e.id}`:`item-${Date.now()}`},j=(e,r)=>D(e)===D(r),O="http://localhost:3001",G=e=>{const r=e.startsWith("/")?e:`/${e}`;return`${O}${r}`},L=()=>P(void 0,null,function*(){try{const e=G("/api/inventory"),r=new AbortController,s=setTimeout(()=>r.abort(),1e4),o=i=>P(void 0,null,function*(){const u=i.headers.get("content-type"),t=yield i.text();if(!u||!u.includes("application/json"))throw t.trim().startsWith("<!DOCTYPE")||t.trim().startsWith("<html")?new Error("HTML_RESPONSE_FALLBACK"):new Error(`Expected JSON, got: ${t.substring(0,100)}...`);try{return JSON.parse(t)}catch(a){throw new Error(`Failed to parse JSON response: ${a.message}`)}});try{const i=yield fetch(e,{signal:r.signal,headers:{"Content-Type":"application/json"}});if(clearTimeout(s),i.ok){const u=yield o(i);if(u.success&&u.inventory){const t={cases:u.inventory.cases,caseColors:u.inventory.caseColors,pins:u.inventory.pins};return localStorage.setItem("productQuantities",JSON.stringify(t)),localStorage.setItem("productQuantitiesTimestamp",Date.now().toString()),t}}else if(i.status===404){const u=e.replace("/api/inventory","/.netlify/functions/inventory");try{const t=yield fetch(u,{signal:r.signal,headers:{"Content-Type":"application/json"}});if(t.ok){const a=yield o(t);if(a.success&&a.inventory){const c={cases:a.inventory.cases,caseColors:a.inventory.caseColors,pins:a.inventory.pins};return localStorage.setItem("productQuantities",JSON.stringify(c)),localStorage.setItem("productQuantitiesTimestamp",Date.now().toString()),c}}}catch(t){}}}catch(i){if(clearTimeout(s),i.message==="HTML_RESPONSE_FALLBACK"){const u=e.replace("/api/inventory","/.netlify/functions/inventory");try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),c=yield fetch(u,{signal:t.signal,headers:{"Content-Type":"application/json"}});if(clearTimeout(a),c.ok){const l=yield o(c);if(l.success&&l.inventory){const n={cases:l.inventory.cases,caseColors:l.inventory.caseColors,pins:l.inventory.pins};return localStorage.setItem("productQuantities",JSON.stringify(n)),localStorage.setItem("productQuantitiesTimestamp",Date.now().toString()),n}}}catch(t){}}if(i.name!=="AbortError"){if(!(i.message&&i.message.includes("Failed to fetch")))throw i}}}catch(e){}return null}),I=()=>P(void 0,null,function*(){var i,u,t,a,c,l;const e=localStorage.getItem("productQuantities"),r=localStorage.getItem("productQuantitiesTimestamp"),s=r&&Date.now()-parseInt(r)<5*60*1e3;if(e&&s)try{JSON.parse(e);return}catch(n){localStorage.removeItem("productQuantities"),localStorage.removeItem("productQuantitiesTimestamp")}if(!(yield L()))try{const n={cases:f.cases.map(p=>{var g;return(g=p.quantity)!=null?g:null}),caseColors:f.cases.map(p=>{var g;return((g=p.colors)==null?void 0:g.map(d=>{var b;return(b=d.quantity)!=null?b:null}))||[]}),pins:{flags:((u=(i=f.pins)==null?void 0:i.flags)==null?void 0:u.map(p=>{var g;return(g=p.quantity)!=null?g:null}))||[],colorful:((a=(t=f.pins)==null?void 0:t.colorful)==null?void 0:a.map(p=>{var g;return(g=p.quantity)!=null?g:null}))||[],bronze:((l=(c=f.pins)==null?void 0:c.bronze)==null?void 0:l.map(p=>{var g;return(g=p.quantity)!=null?g:null}))||[]}};(n.cases.some(p=>p!==null)||n.caseColors.some(p=>p.some(g=>g!==null))||Object.values(n.pins).some(p=>p.some(g=>g!==null)))&&(localStorage.setItem("productQuantities",JSON.stringify(n)),localStorage.setItem("productQuantitiesTimestamp",Date.now().toString()))}catch(n){}}),v=(e,r)=>{var i,u;localStorage.getItem("productQuantities")||I();const s=localStorage.getItem("productQuantities");let o=null;if(s)try{o=JSON.parse(s)}catch(t){}if(!o)return I(),null;if(e.caseType&&e.color){const t=f.cases.find(n=>n.type===e.caseType);if(!t)return null;let a=null;if(o&&o.caseColors){const n=f.cases.findIndex(m=>m.type===e.caseType);if(n!==-1&&o.caseColors[n]){const m=t.colors.findIndex(p=>p.color===e.color);m!==-1&&o.caseColors[n][m]!==void 0&&(a=o.caseColors[n][m])}}if(a===null&&o&&o.cases){const n=f.cases.findIndex(m=>m.type===e.caseType);n!==-1&&o.cases[n]!==void 0&&(a=o.cases[n])}if(a==null)return null;if(a===0)return 0;const c=r.reduce((n,m)=>m.caseType===e.caseType&&m.color===e.color?n+(m.quantity||1):n,0),l=a-c;return Math.max(0,l)}if(e.type==="charm"||e.category||e.pin){const t=e.category||e.pin&&e.pin.category,a=((i=e.pin)==null?void 0:i.name)||((u=e.pin)==null?void 0:u.src)||e.name;if(!t||!a)return null;let c=null;if(f.pins&&f.pins[t]&&(c=f.pins[t].find(g=>g.name===a||g.src===a)),!c)return null;let l=null;const n=t==="flags"?"flags":t;if(o&&o.pins&&o.pins[n]){const g=f.pins[n].findIndex(d=>d.name===a||d.src===a||d.id===c.id);g!==-1&&o.pins[n][g]!==void 0&&(l=o.pins[n][g])}if(l==null)return null;if(l===0)return 0;const m=r.reduce((g,d)=>j(e,d)?g+(d.quantity||1):g,0),p=l-m;return Math.max(0,p)}return null},_=()=>P(void 0,null,function*(){return localStorage.removeItem("productQuantities"),localStorage.removeItem("productQuantitiesTimestamp"),yield L()}),V=e=>{if(!e||e.startsWith("data:image/")||e.startsWith("data:application/")||e.startsWith("http://")||e.startsWith("https://"))return e;let r=e.replace(/^\/TheHappyCase\//,"/");return r=r.replace(/\/+/g,"/"),r.startsWith("/"),r},X=()=>{var r,s,o,i,u,t;const e=localStorage.getItem("productQuantities");if(!e)return f;try{const a=JSON.parse(e),c=h({},f);return a.cases&&(c.cases=c.cases.map((l,n)=>{const m=z(h({},l),{quantity:a.cases[n]!==void 0?a.cases[n]:l.quantity});return a.caseColors&&a.caseColors[n]&&(m.colors=m.colors.map((p,g)=>z(h({},p),{quantity:a.caseColors[n][g]!==void 0?a.caseColors[n][g]:p.quantity}))),m})),a.pins&&(c.pins=z(h({},c.pins),{flags:((s=(r=c.pins)==null?void 0:r.flags)==null?void 0:s.map((l,n)=>{var m;return z(h({},l),{quantity:((m=a.pins.flags)==null?void 0:m[n])!==void 0?a.pins.flags[n]:l.quantity})}))||[],colorful:((i=(o=c.pins)==null?void 0:o.colorful)==null?void 0:i.map((l,n)=>{var m;return z(h({},l),{quantity:((m=a.pins.colorful)==null?void 0:m[n])!==void 0?a.pins.colorful[n]:l.quantity})}))||[],bronze:((t=(u=c.pins)==null?void 0:u.bronze)==null?void 0:t.map((l,n)=>{var m;return z(h({},l),{quantity:((m=a.pins.bronze)==null?void 0:m[n])!==void 0?a.pins.bronze[n]:l.quantity})}))||[]})),c}catch(a){return console.error("Error loading saved quantities:",a),f}},F=(e,r=null)=>{let s=null,o=r;if(!r&&e&&!e.startsWith("#")?(o=e,s=null):(s=e&&e.startsWith("#")?e:null,o=r||(e&&!e.startsWith("#")?e:null)),o){let u=o.split("/").pop().replace(/\.(webp|png|jpg)$/i,"").toLowerCase().replace(/^economycase/i,"").replace(/^businessclasscase/i,"").replace(/^firstclasscase/i,"").replace(/^smartcase/i,"").replace(/^premiumcase/i,"").replace(/^firstclass/i,"");const t={lightpink:"Light Pink",lightblue:"Light Blue",lightbrown:"Light Brown",darkbrown:"Dark Brown",darkblue:"Dark Blue",jeansblue:"Jeans Blue",brickred:"Brick Red",ligthpink:"Light Pink",navyblue:"Navy Blue",gray:"Gray",grey:"Gray",black:"Black",brown:"Brown",red:"Red",pink:"Pink",blue:"Blue",green:"Green",purple:"Purple",yellow:"Yellow",orange:"Orange",darkpink:"Dark Pink"};if(t[u])return t[u];if(u=u.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/(dark|light|navy|jeans|brick)([a-z]+)/g,"$1 $2").split(/(?=[A-Z])|(?=dark|light|navy|jeans|brick)/).filter(a=>a.length>0).join(" ").toLowerCase().split(" ").map(a=>t[a]?t[a]:a.charAt(0).toUpperCase()+a.slice(1)).join(" "),u&&u!=="Color")return u}if(s){s.toLowerCase().replace("#","");const i={"#f49f90":"Light Pink","#cb0025":"Red","#9cb4b8":"Light Blue","#627386":"Jeans Blue","#3a4763":"Dark Blue","#c96e50":"Light Brown","#b0582c":"Brown","#59332e":"Dark Brown","#506258":"Green","#89837e":"Gray","#413f44":"Black","#c8b593":"Gray","#da8ca6":"Light Pink","#daaf49":"Yellow","#d33d72":"Pink","#c49154":"Brown","#36312b":"Black","#d17956":"Brown","#c76f82":"Brick Red","#adcfa8":"Green","#ab8b72":"Dark Pink","#bfa29c":"Pink","#a799ab":"Purple","#afab9b":"Gray","#5f6074":"Navy Blue","#768695":"Blue","#cea55c":"Light Brown","#272a34":"Black"};if(i[s.toLowerCase()])return i[s.toLowerCase()]}return s||""},Z=e=>{const r=e==null?void 0:e.get("case"),s=e==null?void 0:e.get("color"),o="economy";let i="",u="";if(r){const a=f.cases.find(c=>c.type===r);if(a){if(s){const c=a.colors.find(l=>l.color===s);if(c)return{caseType:a.type,color:c.color,image:c.image}}if(a.colors&&a.colors.length>0){const c=a.colors[0];return{caseType:a.type,color:c.color,image:c.image}}}}const t=f.cases.find(a=>a.type===o);if(t&&t.colors&&t.colors.length>0){const a=t.colors[0];return{caseType:o,color:a.color,image:a.image}}return{caseType:o,color:i,image:u}},J=(e,r,s)=>{if(!e.current)return null;const o=r.current?r.current.visible:!0,i=s.current?s.current.visible:!0;r.current&&(r.current.visible=!1),s.current&&(s.current.visible=!1);const u=e.current.toDataURL({format:"png",quality:1,multiplier:2,backgroundColor:"white"});return r.current&&(r.current.visible=o),s.current&&(s.current.visible=i),(r.current||s.current)&&e.current.renderAll(),u},U=(e,r,s=300,o=350)=>new Promise((i,u)=>{if(!e&&!r){i(null);return}const t=document.createElement("canvas");t.width=s,t.height=o;const a=t.getContext("2d");a.fillStyle="white",a.fillRect(0,0,s,o);const c=()=>{if(!e){console.log("âš ï¸ No case image URL provided, using canvas content only"),l();return}const n=new Image;!e.startsWith("data:")&&!e.startsWith("blob:")&&(n.crossOrigin="anonymous");const m=setTimeout(()=>{console.error("â±ï¸ Timeout loading case image:",e),l()},1e4);n.onload=()=>{clearTimeout(m),console.log("âœ… Case image loaded successfully:",{width:n.width,height:n.height,src:e.substring(0,50)+"..."});const p=n.width/n.height,g=s/o;let d,b,y,C;const w=270;p>g?(b=w,d=b*p):(d=w,b=d/p),y=(s-d)/2,C=o*.45-b/2,a.drawImage(n,y,C,d,b),l()},n.onerror=p=>{clearTimeout(m),console.error("âŒ Failed to load case image:",{url:e,error:p,message:"Will continue with canvas content only"}),l()},console.log("ðŸ”„ Loading case image:",e),n.src=e},l=()=>{if(!r){console.log("âš ï¸ No canvas data URL, resolving with case image or white canvas"),i(t.toDataURL("image/png",1));return}const n=new Image,m=setTimeout(()=>{console.error("â±ï¸ Timeout loading canvas content"),i(t.toDataURL("image/png",1))},1e4);n.onload=()=>{clearTimeout(m),console.log("âœ… Canvas content loaded successfully:",{width:n.width,height:n.height});const p=n.width/n.height,g=s/o;let d,b,y,C;p>g?(d=s,b=s/p):(b=o,d=o*p),y=(s-d)/2,C=(o-b)/2,a.drawImage(n,y,C,d,b);const w=t.toDataURL("image/png",1);console.log("ðŸŽ¨ Composite image created:",{isDataURL:w.startsWith("data:image/"),length:w.length}),i(w)},n.onerror=p=>{clearTimeout(m),console.error("âŒ Failed to load canvas content:",p),i(t.toDataURL("image/png",1))},console.log("ðŸ”„ Loading canvas content..."),n.src=r};c()}),R=(e,r,s)=>{const o=J(e,r,s);if(!o)return;const i=document.createElement("a");i.download=`passport-case-design-${Date.now()}.webp`,i.href=o,document.body.appendChild(i),i.click(),document.body.removeChild(i)},ee=(e,r,s,o,i)=>{var n;const t=v({caseType:e,color:r},s),a=(i==null?void 0:i.name)||"Passport Case",c=(n=i==null?void 0:i.colors)==null?void 0:n.find(m=>m.color===r),l=c?F(c.color,c.image):r?F(r):"";if(t!==null&&t===0){const m=l?` in ${l}`:"";return{valid:!1,errorMessage:`Oops! We don't have any more ${a}${m} in stock right now, so you can't add more to your basket.`}}if(t!==null&&o>t){const m=l?` in ${l}`:"";return{valid:!1,errorMessage:`Oops! We don't have any more ${a}${m} in stock right now, so you can't add more to your basket.`,maxAvailable:t}}return{valid:!0}},se=(e,r,s,o)=>{for(const{pin:i}of e){const u=(i==null?void 0:i.category)||o||"colorful",t=(i==null?void 0:i.name)||"charm",c=v({type:"charm",category:u,pin:i,name:t},r);if(c!==null&&c===0)return{valid:!1,errorMessage:`Oops! We don't have any more ${t} in stock right now, so you can't add more to your basket.`};if(c!==null&&s>c)return{valid:!1,errorMessage:`Oops! We don't have any more ${t} in stock right now, so you can't add more to your basket.`}}return{valid:!0}},ae=(e,r)=>P(void 0,null,function*(){let s=e;if(e&&r)try{s=yield U(e,r,300,350),(!s||!s.startsWith("data:image/"))&&(console.warn("âš ï¸ Composite image creation returned invalid result, using case image fallback"),s=e)}catch(o){console.error("âŒ Error creating composite design image:",o),s=e}else r?s=r:e&&(s=e);return(!s||typeof s=="string"&&s.trim().length===0)&&(console.error("âŒ No valid design image available, using case image fallback"),s=e||""),s}),re=(e,r)=>e.map(({pin:s})=>{const o=s!=null&&s.category&&s.category.trim()!==""?s.category:r&&r.trim()!==""?r:"colorful";return z(h({},s),{name:(s==null?void 0:s.name)||"Charm",src:(s==null?void 0:s.src)||"",price:(s==null?void 0:s.price)||0,category:o})}),ie=({selectedCase:e,selectedCaseType:r,selectedColor:s,selectedCaseImage:o,selectedPins:i,caseBasePrice:u,quantity:t,designImage:a,normalizedCaseImage:c,pinsDetails:l,selectedCategory:n})=>{const m=Math.max(t,1),p=Date.now(),g=(e==null?void 0:e.name)||"Passport Case",d={id:`case-${p}-${Math.random().toString(36).substr(2,9)}`,name:g,caseType:r,caseName:g,color:s,basePrice:u,casePrice:u,totalPrice:u,price:u,image:a,designImage:a,caseImage:c,customDesign:!0,quantity:m},b=l.map((y,C)=>{const w=y.category||n||"colorful",k=y.name||"Charm",S=y.price||2;return{id:`charm-${p}-${C}-${Math.random().toString(36).substr(2,9)}`,name:k,price:S,totalPrice:S,image:y.src||"",pin:y,category:w,type:"charm",quantity:m}});return{caseProduct:d,charmProducts:b}},$=(e,r,s,o,i,u)=>{let t=0;return e.forEach(a=>{if(a.type==="charm"){if(a.id===i||i===void 0&&e.indexOf(a)===u)return;const n=a.pin||a,m=n.name||n.src,p=n.category||a.category||o;(m===r||m===s)&&p===o&&(t+=a.quantity||1)}}),t},N=(e,r,s,o,i,u)=>{let t=0;return e.forEach(a=>{if(a.type==="charm"||a.id===i||e.indexOf(a)===u)return;(a.pins||a.pinsDetails||[]).forEach(l=>{if(!l)return;const n=l.name||l.src,m=l.src||"",p=l.category||o;(n===r||n===s||m===r||m===s)&&p===o&&(t+=a.quantity||1)})}),t},H=(e,r,s,o)=>e.filter(i=>{const u=i.pin||i,t=u.name||u.src,a=u.category||o;return(t===r||t===s)&&a===o}).length,K=(e,r="colorful")=>{const s=r&&r.trim()!==""?r:"colorful",o=e.name||e.src||"",i=e.src||"";return{name:o,price:e.price||2,totalPrice:e.price||2,image:i,pin:e,category:s,type:"charm"}},ne=(e,r,s,o)=>{var d,b,y,C,w;const i=v(e,r),u=e.category||((d=e.pin)==null?void 0:d.category)||"colorful",t=((b=e.pin)==null?void 0:b.name)||e.name||"",a=((y=e.pin)==null?void 0:y.src)||"";if(i!==null&&i===0)return{canIncrement:!1,errorMessage:`Oops! We don't have any more ${e.name||((C=e.pin)==null?void 0:C.name)||"Charm"} in stock right now, so you can't add more to your basket.`};if(i===null)return{canIncrement:!0};const c=$(r,t,a,u,s,o),l=N(r,t,a,u,s,o),n=e.quantity||1,m=i+c;return n+1+l>m?{canIncrement:!1,errorMessage:`Oops! We don't have any more ${e.name||((w=e.pin)==null?void 0:w.name)||"Charm"} in stock right now, so you can't add more to your basket.`}:{canIncrement:!0}},oe=(e,r,s,o)=>{const i=v(e,r),u=e.pins||e.pinsDetails||[],t=e.quantity||1;if(!(i===null||i>0)){const c=e.caseName||e.name||"Passport Case",l=e.color?F(e.color,e.caseImage||e.case_image||e.image):"",n=l?` in ${l}`:"";return{canIncrement:!1,errorMessage:`Oops! We don't have any more ${c}${n} in stock right now, so you can't add more to your basket.`,errorType:"case"}}for(const c of u){if(!c)continue;const l=c.category&&c.category.trim()!==""?c.category:"colorful",n=c.name||c.src||"",m=c.src||"",p=K(c,l),g=v(p,r);if(g===null)continue;const d=$(r,n,m,l,s,o),b=N(r,n,m,l,s,o),y=H(u,n,m,l),C=g+d,k=d+b+y*t+y;if(g===0||k>C)return{canIncrement:!1,errorMessage:`Oops! We don't have any more ${c.name||"this charm"} in stock right now, so you can't add more to your basket.`,errorType:"charm",errorKey:`${n}-${l}`,charmProduct:p}}return{canIncrement:!0}};export{f as P,j as a,F as b,Z as c,R as d,J as e,X as f,v as g,se as h,ae as i,ie as j,ne as k,oe as l,K as m,V as n,G as o,re as p,_ as r,ee as v};
