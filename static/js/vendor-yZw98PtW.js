var te=Object.defineProperty;var X=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var Y=(e,t,a)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,U=(e,t)=>{for(var a in t||(t={}))ae.call(t,a)&&Y(e,a,t[a]);if(X)for(var a of X(t))se.call(t,a)&&Y(e,a,t[a]);return e};var l=(e,t,a)=>new Promise((n,u)=>{var p=i=>{try{v(a.next(i))}catch(f){u(f)}},d=i=>{try{v(a.throw(i))}catch(f){u(f)}},v=i=>i.done?n(i.value):Promise.resolve(i.value).then(p,d);v((a=a.apply(e,t)).next())});import{g as W}from"./react-vendor-LWyrAfI5.js";var z={exports:{}},Q={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(s,c){var r=s.length;s.push(c);e:for(;0<r;){var m=r-1>>>1,y=s[m];if(0<u(y,c))s[m]=c,s[r]=y,r=m;else break e}}function a(s){return s.length===0?null:s[0]}function n(s){if(s.length===0)return null;var c=s[0],r=s.pop();if(r!==c){s[0]=r;e:for(var m=0,y=s.length,D=y>>>1;m<D;){var R=2*(m+1)-1,M=s[R],_=R+1,x=s[_];if(0>u(M,r))_<y&&0>u(x,M)?(s[m]=x,s[_]=r,m=_):(s[m]=M,s[R]=r,m=R);else if(_<y&&0>u(x,r))s[m]=x,s[_]=r,m=_;else break e}}return c}function u(s,c){var r=s.sortIndex-c.sortIndex;return r!==0?r:s.id-c.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var p=performance;e.unstable_now=function(){return p.now()}}else{var d=Date,v=d.now();e.unstable_now=function(){return d.now()-v}}var i=[],f=[],b=1,h=null,o=3,O=!1,T=!1,g=!1,P=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate!="undefined"?setImmediate:null;function q(s){for(var c=a(f);c!==null;){if(c.callback===null)n(f);else if(c.startTime<=s)n(f),c.sortIndex=c.expirationTime,t(i,c);else break;c=a(f)}}function H(s){if(g=!1,q(s),!T)if(a(i)!==null)T=!0,k||(k=!0,N());else{var c=a(f);c!==null&&$(H,c.startTime-s)}}var k=!1,I=-1,G=5,L=-1;function J(){return P?!0:!(e.unstable_now()-L<G)}function F(){if(P=!1,k){var s=e.unstable_now();L=s;var c=!0;try{e:{T=!1,g&&(g=!1,w(I),I=-1),O=!0;var r=o;try{t:{for(q(s),h=a(i);h!==null&&!(h.expirationTime>s&&J());){var m=h.callback;if(typeof m=="function"){h.callback=null,o=h.priorityLevel;var y=m(h.expirationTime<=s);if(s=e.unstable_now(),typeof y=="function"){h.callback=y,q(s),c=!0;break t}h===a(i)&&n(i),q(s)}else n(i);h=a(i)}if(h!==null)c=!0;else{var D=a(f);D!==null&&$(H,D.startTime-s),c=!1}}break e}finally{h=null,o=r,O=!1}c=void 0}}finally{c?N():k=!1}}}var N;if(typeof A=="function")N=function(){A(F)};else if(typeof MessageChannel!="undefined"){var V=new MessageChannel,ee=V.port2;V.port1.onmessage=F,N=function(){ee.postMessage(null)}}else N=function(){E(F,0)};function $(s,c){I=E(function(){s(e.unstable_now())},c)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(s){s.callback=null},e.unstable_forceFrameRate=function(s){0>s||125<s?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<s?Math.floor(1e3/s):5},e.unstable_getCurrentPriorityLevel=function(){return o},e.unstable_next=function(s){switch(o){case 1:case 2:case 3:var c=3;break;default:c=o}var r=o;o=c;try{return s()}finally{o=r}},e.unstable_requestPaint=function(){P=!0},e.unstable_runWithPriority=function(s,c){switch(s){case 1:case 2:case 3:case 4:case 5:break;default:s=3}var r=o;o=s;try{return c()}finally{o=r}},e.unstable_scheduleCallback=function(s,c,r){var m=e.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?m+r:m):r=m,s){case 1:var y=-1;break;case 2:y=250;break;case 5:y=1073741823;break;case 4:y=1e4;break;default:y=5e3}return y=r+y,s={id:b++,callback:c,priorityLevel:s,startTime:r,expirationTime:y,sortIndex:-1},r>m?(s.sortIndex=r,t(f,s),a(i)===null&&s===a(f)&&(g?(w(I),I=-1):g=!0,$(H,r-m))):(s.sortIndex=y,t(i,s),T||O||(T=!0,k||(k=!0,N()))),s},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(s){var c=o;return function(){var r=o;o=c;try{return s.apply(this,arguments)}finally{o=r}}}})(Q);z.exports=Q;var we=z.exports,ne=function(e,t,a,n,u,p,d,v){if(!e){var i;if(t===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[a,n,u,p,d,v],b=0;i=new Error(t.replace(/%s/g,function(){return f[b++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}},re=ne;const Te=W(re);var ce=function(t,a,n,u){var p=n?n.call(u,t,a):void 0;if(p!==void 0)return!!p;if(t===a)return!0;if(typeof t!="object"||!t||typeof a!="object"||!a)return!1;var d=Object.keys(t),v=Object.keys(a);if(d.length!==v.length)return!1;for(var i=Object.prototype.hasOwnProperty.bind(a),f=0;f<d.length;f++){var b=d[f];if(!i(b))return!1;var h=t[b],o=a[b];if(p=n?n.call(u,h,o,b):void 0,p===!1||p===void 0&&h!==o)return!1}return!0};const ge=W(ce);var K={exports:{}},ie="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",le=ie,oe=le;function Z(){}function B(){}B.resetWarningCache=Z;var ue=function(){function e(n,u,p,d,v,i){if(i!==oe){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}e.isRequired=e;function t(){return e}var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:B,resetWarningCache:Z};return a.PropTypes=a,a};K.exports=ue();var fe=K.exports;const Oe=W(fe);function Ee(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,n=Object.getOwnPropertySymbols(e);u<n.length;u++)t.indexOf(n[u])<0&&Object.prototype.propertyIsEnumerable.call(e,n[u])&&(a[n[u]]=e[n[u]]);return a}function _e(e,t,a,n){function u(p){return p instanceof a?p:new a(function(d){d(p)})}return new(a||(a=Promise))(function(p,d){function v(b){try{f(n.next(b))}catch(h){d(h)}}function i(b){try{f(n.throw(b))}catch(h){d(h)}}function f(b){b.done?p(b.value):u(b.value).then(v,i)}f((n=n.apply(e,t||[])).next())})}var C=class extends Error{constructor(e,t){var a;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((a=t.icebergType)==null?void 0:a.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function pe(e,t,a){const n=new URL(t,e);if(a)for(const[u,p]of Object.entries(a))p!==void 0&&n.searchParams.set(u,p);return n.toString()}function he(e){return l(this,null,function*(){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?yield e.getHeaders():{}})}function me(e){var a;const t=(a=e.fetchImpl)!=null?a:globalThis.fetch;return{request(f){return l(this,arguments,function*({method:u,path:p,query:d,body:v,headers:i}){var P;const b=pe(e.baseUrl,p,d),h=yield he(e.auth),o=yield t(b,{method:u,headers:U(U(U({},v?{"Content-Type":"application/json"}:{}),h),i),body:v?JSON.stringify(v):void 0}),O=yield o.text(),T=(o.headers.get("content-type")||"").includes("application/json"),g=T&&O?JSON.parse(O):O;if(!o.ok){const E=T?g:void 0,w=E==null?void 0:E.error;throw new C((P=w==null?void 0:w.message)!=null?P:`Request failed with status ${o.status}`,{status:o.status,icebergType:w==null?void 0:w.type,icebergCode:w==null?void 0:w.code,details:E})}return{status:o.status,headers:o.headers,data:g}})}}}function j(e){return e.join("")}var de=class{constructor(e,t=""){this.client=e,this.prefix=t}listNamespaces(e){return l(this,null,function*(){const t=e?{parent:j(e.namespace)}:void 0;return(yield this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))})}createNamespace(e,t){return l(this,null,function*(){const a={namespace:e.namespace,properties:t==null?void 0:t.properties};return(yield this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:a})).data})}dropNamespace(e){return l(this,null,function*(){yield this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${j(e.namespace)}`})})}loadNamespaceMetadata(e){return l(this,null,function*(){return{properties:(yield this.client.request({method:"GET",path:`${this.prefix}/namespaces/${j(e.namespace)}`})).data.properties}})}namespaceExists(e){return l(this,null,function*(){try{return yield this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${j(e.namespace)}`}),!0}catch(t){if(t instanceof C&&t.status===404)return!1;throw t}})}createNamespaceIfNotExists(e,t){return l(this,null,function*(){try{return yield this.createNamespace(e,t)}catch(a){if(a instanceof C&&a.status===409)return;throw a}})}};function S(e){return e.join("")}var be=class{constructor(e,t="",a){this.client=e,this.prefix=t,this.accessDelegation=a}listTables(e){return l(this,null,function*(){return(yield this.client.request({method:"GET",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables`})).data.identifiers})}createTable(e,t){return l(this,null,function*(){const a={};return this.accessDelegation&&(a["X-Iceberg-Access-Delegation"]=this.accessDelegation),(yield this.client.request({method:"POST",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables`,body:t,headers:a})).data.metadata})}updateTable(e,t){return l(this,null,function*(){const a=yield this.client.request({method:"POST",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":a.data["metadata-location"],metadata:a.data.metadata}})}dropTable(e,t){return l(this,null,function*(){var a;yield this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((a=t==null?void 0:t.purge)!=null?a:!1)}})})}loadTable(e){return l(this,null,function*(){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(yield this.client.request({method:"GET",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata})}tableExists(e){return l(this,null,function*(){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return yield this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${S(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(a){if(a instanceof C&&a.status===404)return!1;throw a}})}createTableIfNotExists(e,t){return l(this,null,function*(){try{return yield this.createTable(e,t)}catch(a){if(a instanceof C&&a.status===409)return yield this.loadTable({namespace:e.namespace,name:t.name});throw a}})}},Pe=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const a=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=me({baseUrl:a,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new de(this.client,t),this.tableOps=new be(this.client,t,this.accessDelegation)}listNamespaces(e){return l(this,null,function*(){return this.namespaceOps.listNamespaces(e)})}createNamespace(e,t){return l(this,null,function*(){return this.namespaceOps.createNamespace(e,t)})}dropNamespace(e){return l(this,null,function*(){yield this.namespaceOps.dropNamespace(e)})}loadNamespaceMetadata(e){return l(this,null,function*(){return this.namespaceOps.loadNamespaceMetadata(e)})}listTables(e){return l(this,null,function*(){return this.tableOps.listTables(e)})}createTable(e,t){return l(this,null,function*(){return this.tableOps.createTable(e,t)})}updateTable(e,t){return l(this,null,function*(){return this.tableOps.updateTable(e,t)})}dropTable(e,t){return l(this,null,function*(){yield this.tableOps.dropTable(e,t)})}loadTable(e){return l(this,null,function*(){return this.tableOps.loadTable(e)})}namespaceExists(e){return l(this,null,function*(){return this.namespaceOps.namespaceExists(e)})}tableExists(e){return l(this,null,function*(){return this.tableOps.tableExists(e)})}createNamespaceIfNotExists(e,t){return l(this,null,function*(){return this.namespaceOps.createNamespaceIfNotExists(e,t)})}createTableIfNotExists(e,t){return l(this,null,function*(){return this.tableOps.createTableIfNotExists(e,t)})}};const ke=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{Pe as I,Oe as P,_e as _,ge as a,Ee as b,Te as i,we as s,ke as w};
