var ie=Object.defineProperty,ce=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var ne=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var oe=(a,i,d)=>i in a?ie(a,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):a[i]=d,Q=(a,i)=>{for(var d in i||(i={}))me.call(i,d)&&oe(a,d,i[d]);if(ne)for(var d of ne(i))ue.call(i,d)&&oe(a,d,i[d]);return a},W=(a,i)=>ce(a,de(i));var R=(a,i,d)=>new Promise((c,x)=>{var w=p=>{try{h(d.next(p))}catch(k){x(k)}},u=p=>{try{h(d.throw(p))}catch(k){x(k)}},h=p=>p.done?c(p.value):Promise.resolve(p.value).then(w,u);h((d=d.apply(a,i)).next())});import{j as e,r as b,u as he}from"./react-vendor-oGZ_6Ua-.js";import{o as H,P}from"./shared-utils-D17Q5lK6.js";import{g as ge}from"./index-DsvDasMz.js";import"./vendor-Q-ueIuah.js";import"./fontawesome-vendor-DeakGBTR.js";import"./supabase-vendor-rHdX91gy.js";const xe=({activeTab:a,onTabChange:i})=>e.jsxs("div",{className:"mb-6 border-b",children:[e.jsx("button",{onClick:()=>i("inventory"),className:`mr-6 pb-2 ${a==="inventory"?"border-b-2 border-black":"text-gray-400"}`,children:"Inventory"}),e.jsx("button",{onClick:()=>i("orders"),className:`pb-2 ${a==="orders"?"border-b-2 border-black":"text-gray-400"}`,children:"Orders"})]}),pe=({source:a,loading:i})=>{if(i)return e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 text-blue-800 rounded-sm text-sm font-inter",children:e.jsx("span",{children:"â³ Loading inventory from Supabase..."})});if(!a)return null;const d=()=>{switch(a){case"supabase":return"bg-green-50 border border-green-200 text-green-800";case"localStorage":return"bg-yellow-50 border border-yellow-200 text-yellow-800";default:return"bg-gray-50 border border-gray-200 text-gray-800"}},c=()=>{switch(a){case"supabase":return e.jsxs("span",{children:["âœ… ",e.jsx("strong",{children:"Loaded from Supabase:"})," All saved inventory quantities are displayed. Data is persisted and will be available after deployment."]});case"localStorage":return e.jsxs("span",{children:["âš ï¸ ",e.jsx("strong",{children:"Using cached data:"})," Supabase unavailable. Showing cached quantities from localStorage."]});default:return e.jsxs("span",{children:["â„¹ï¸ ",e.jsx("strong",{children:"Using default quantities:"}),' No saved data found. Set quantities and click "Save Changes" to persist to Supabase.']})}};return e.jsx("div",{className:`mb-4 p-3 rounded-sm text-sm font-inter ${d()}`,children:c()})},be=({onRefresh:a,onSave:i,loadingInventory:d,saved:c})=>e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:a,disabled:d,className:"font-inter px-4 py-2 uppercase text-xs bg-gray-100 text-gray-700 hover:bg-gray-200 disabled:opacity-50",children:d?"Refreshing...":"ðŸ”„ Refresh from Supabase"}),e.jsx("button",{onClick:i,disabled:d,className:`font-inter px-6 py-2 uppercase text-sm ${c?"bg-green-600 text-white":d?"bg-gray-400 text-white cursor-not-allowed":"bg-black text-white hover:bg-gray-800"}`,children:d?"Loading...":c?"âœ“ Saved to Supabase":"Save Changes to Supabase"})]}),G=({quantity:a,size:i="small"})=>{const d=a===0,c=a!==null&&a>0&&a<=5,x=a!==null&&a>5;if(a==null)return null;const u=i==="large"?"w-6 h-6":"w-5 h-5",h=i==="large"?"w-4 h-4":"w-3 h-3";return d?e.jsx("div",{className:`bg-red-500 text-white rounded-full ${u} flex items-center justify-center shadow-lg`,children:e.jsx("svg",{className:h,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}):c?e.jsx("div",{className:`bg-orange-500 text-white rounded-full ${u} flex items-center justify-center shadow-lg`,children:e.jsx("svg",{className:h,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}):x?e.jsx("div",{className:`bg-green-500 text-white rounded-full ${u} flex items-center justify-center shadow-lg`,children:e.jsx("svg",{className:h,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}):null},Z=({quantity:a,size:i="normal"})=>{const d=a===0,c=a!==null&&a>0&&a<=5,x=a!==null&&a>5,w=a==null,u=i==="small"?"p-1.5":"p-2",h=i==="small"?"text-[10px]":"text-xs",p=i==="small"?"mt-1 w-full":"";return d?e.jsx("div",{className:`${u} bg-red-50 border border-red-200 rounded-sm ${p}`,children:e.jsx("p",{className:`${h} text-red-700 font-medium font-inter ${i==="small"?"text-center":""}`,children:"OUT OF STOCK"})}):c?e.jsx("div",{className:`${u} bg-orange-50 border border-orange-200 rounded-sm ${p}`,children:e.jsxs("p",{className:`${h} text-orange-700 font-medium font-inter ${i==="small"?"text-center":""}`,children:["LOW STOCK (",a,")"]})}):x?e.jsx("div",{className:`${u} bg-green-50 border border-green-200 rounded-sm ${p}`,children:e.jsxs("p",{className:`${h} text-green-700 font-medium font-inter ${i==="small"?"text-center":""}`,children:["IN STOCK (",a,")"]})}):w?e.jsx("div",{className:`${u} bg-gray-50 border border-gray-200 rounded-sm ${p}`,children:e.jsx("p",{className:`${h} text-gray-600 font-medium font-inter ${i==="small"?"text-center":""}`,children:"UNLIMITED"})}):null},fe=({caseItem:a,index:i,onQuantityChange:d})=>{var u;const c=a.quantity!==void 0?a.quantity:null,x=c===0,w=c==null;return e.jsxs("div",{className:"mb-8 border border-gray-200 rounded-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 font-inter",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[!w&&e.jsx("div",{children:e.jsx(G,{quantity:c,size:"large"})}),x&&e.jsx("span",{className:"text-xs text-red-600 font-medium",children:"SOLD OUT"})]})]}),e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-100",children:[e.jsx("label",{className:"text-sm text-gray-600 font-medium mb-2 block font-inter",children:"Overall Quantity (Optional):"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:"0",value:(u=a.quantity)!=null?u:"",onChange:h=>d("case",i,null,h.target.value),className:"w-24 px-3 py-2 border border-gray-300 rounded-sm text-sm focus:outline-none focus:border-gray-400 font-inter",placeholder:"0"}),e.jsx(Z,{quantity:c,size:"normal"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4 font-inter",children:"Quantity per Color:"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:a.colors.map((h,p)=>{var C;const k=h.quantity!==void 0?h.quantity:null,y=k==null;return e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 border border-gray-200 rounded-sm hover:border-gray-300 transition-colors relative",children:[!y&&e.jsx("div",{className:"absolute -top-1 -right-1 z-10",children:e.jsx(G,{quantity:k,size:"small"})}),e.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-gray-300 shadow-sm",style:{backgroundColor:h.color},title:h.color}),h.name&&e.jsx("span",{className:"text-xs text-gray-600 text-center font-inter",children:h.name}),e.jsxs("div",{className:"w-full flex flex-col items-center gap-1",children:[e.jsx("label",{className:"text-xs text-gray-500 font-inter",children:"Qty:"}),e.jsx("input",{type:"number",min:"0",value:(C=h.quantity)!=null?C:"",onChange:D=>d("case",i,null,D.target.value,p),className:"w-full px-2 py-1 border border-gray-300 rounded-sm text-xs text-center focus:outline-none focus:border-gray-400 font-inter",placeholder:"0"})]}),e.jsx(Z,{quantity:k,size:"small"})]},p)})})]})]})},ye=({cases:a,onQuantityChange:i})=>e.jsxs("div",{className:"bg-white border p-6 rounded-sm",children:[e.jsx("h2",{className:"text-xl mb-6 font-inter",children:"Passport Cases"}),a.map((d,c)=>e.jsx(fe,{caseItem:d,index:c,onQuantityChange:i},c))]}),K=({charm:a,index:i,category:d,onQuantityChange:c})=>{var u;const x=a.quantity!==void 0?a.quantity:null,w=x==null;return e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 border border-gray-200 rounded-sm hover:border-gray-300 transition-colors relative",children:[!w&&e.jsx("div",{className:"absolute -top-1 -right-1 z-10",children:e.jsx(G,{quantity:x,size:"small"})}),a.image&&e.jsx("div",{className:"w-16 h-16 flex items-center justify-center border border-gray-200 rounded-sm bg-white",children:e.jsx("img",{src:a.image,alt:a.name,className:"max-w-full max-h-full object-contain"})}),e.jsx("span",{className:"text-xs text-gray-700 text-center font-inter font-medium",children:a.name}),e.jsxs("div",{className:"w-full flex flex-col items-center gap-1",children:[e.jsx("label",{className:"text-xs text-gray-500 font-inter",children:"Qty:"}),e.jsx("input",{type:"number",min:"0",value:(u=a.quantity)!=null?u:"",onChange:h=>c("charm",i,d,h.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded-sm text-xs text-center focus:outline-none focus:border-gray-400 font-inter",placeholder:"0"})]}),e.jsx(Z,{quantity:x,size:"small"})]})},ve=({charms:a,onQuantityChange:i})=>e.jsxs("div",{className:"bg-white border p-6 rounded-sm mt-8",children:[e.jsx("h2",{className:"text-xl mb-6 font-inter",children:"Charms"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4 font-inter",children:"Flags"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:a.flags.map((d,c)=>e.jsx(K,{charm:d,index:c,category:"flags",onQuantityChange:i},c))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4 font-inter",children:"Colorful Charms"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:a.colorful.map((d,c)=>e.jsx(K,{charm:d,index:c,category:"colorful",onQuantityChange:i},c))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4 font-inter",children:"Bronze Charms"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4",children:a.bronze.map((d,c)=>e.jsx(K,{charm:d,index:c,category:"bronze",onQuantityChange:i},c))})]})]}),je=({products:a,inventorySource:i,loadingInventory:d,saved:c,onRefresh:x,onSave:w,onQuantityChange:u})=>e.jsxs(e.Fragment,{children:[e.jsx(pe,{source:i,loading:d}),e.jsx(be,{onRefresh:x,onSave:w,loadingInventory:d,saved:c}),e.jsx(ye,{cases:a.cases,onQuantityChange:u}),e.jsx(ve,{charms:a.pins,onQuantityChange:u})]}),Ne=({orders:a,loadingOrders:i,ordersError:d,onRefresh:c})=>{var q,V;const[x,w]=b.useState(null),[u,h]=b.useState("all"),[p,k]=b.useState(new Set),[y,C]=b.useState(null),[D,$]=b.useState(""),[E,M]=b.useState(""),O=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",v=(s,r="gbp")=>!s&&s!==0?"N/A":new Intl.NumberFormat("en-GB",{style:"currency",currency:r.toUpperCase()}).format(s),F=s=>{w(x===s?null:s)},B=(s,r)=>{var n,o;const t=a.find(l=>l.order_id===s);r?window.confirm("Are you sure you want to mark this order as not dispatched? This will clear tracking information.")&&A(s,!1,"",""):($(((n=t==null?void 0:t.tracking)==null?void 0:n.tracking_number)||""),M(((o=t==null?void 0:t.metadata)==null?void 0:o.tracking_link)||""),C({orderId:s,currentDispatched:r}))},I=s=>{var t,n;const r=a.find(o=>o.order_id===s);$(((t=r==null?void 0:r.tracking)==null?void 0:t.tracking_number)||""),M(((n=r==null?void 0:r.tracking)==null?void 0:n.tracking_link)||""),C({orderId:s,currentDispatched:U(r)})},A=(s,r,t,n)=>R(void 0,null,function*(){k(o=>new Set(o).add(s));try{const o=H(`/api/orders/${s}/dispatched`);console.log("Updating dispatched status:",{orderId:s,dispatched:r,tracking_number:t,tracking_link:n,apiUrl:o});const l={dispatched:r,tracking_number:t?t.trim():"",tracking_link:n?n.trim():""};console.log("ðŸ“¤ Sending dispatch update:",l);const m=yield fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),N=m.headers.get("content-type");if(N&&N.includes("text/html"))throw new Error("Backend server returned HTML (likely 404). Is the server running on port 3001?");if(!m.ok){let f="Failed to update dispatched status";try{const j=yield m.json();f=j.message||j.error||f}catch(j){f=`HTTP ${m.status}: ${m.statusText}`}throw new Error(f)}const S=yield m.json();console.log("âœ… Dispatched status updated:",S),C(null),$(""),M(""),c&&c()}catch(o){console.error("Error updating dispatched status:",o);const l=o.message||"Failed to update dispatched status. Make sure the backend server is running.";alert(`Failed to update dispatched status: ${l}`)}finally{k(o=>{const l=new Set(o);return l.delete(s),l})}}),T=()=>{if(y){a.find(r=>r.order_id===y.orderId);const s=y.currentDispatched!==!1;A(y.orderId,s,D,E)}},U=s=>{var r;return((r=s.metadata)==null?void 0:r.dispatched)===!0},z=b.useMemo(()=>{if(!a||a.length===0)return[];const s=new Map;return a.forEach(r=>{if(r.order_date){const t=new Date(r.order_date),n=t.getFullYear(),o=t.getMonth(),l=`${n}-${String(o+1).padStart(2,"0")}`,m=t.toLocaleDateString("en-US",{year:"numeric",month:"long"});s.has(l)||s.set(l,{key:l,label:m,year:n,month:o})}}),Array.from(s.values()).sort((r,t)=>r.year!==t.year?t.year-r.year:t.month-r.month)},[a]),_=b.useMemo(()=>{if(u==="all")return a;const[s,r]=u.split("-").map(Number);return a.filter(t=>{if(!t.order_date)return!1;const n=new Date(t.order_date);return n.getFullYear()===s&&n.getMonth()===r-1})},[a,u]),J=b.useMemo(()=>_.reduce((s,r)=>s+(r.total_amount||0),0),[_]);return i?e.jsxs("div",{className:"bg-white border rounded-lg p-8 text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading orders..."})]}):d?e.jsx("div",{className:"bg-white border rounded-lg p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:[e.jsx("p",{className:"text-red-800 font-medium",children:"Error loading orders"}),e.jsx("p",{className:"text-red-600 text-sm mt-1",children:d}),c&&e.jsx("button",{onClick:c,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:"Retry"})]})}):!a||a.length===0?e.jsxs("div",{className:"bg-white border rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-600",children:"No orders found."}),c&&e.jsx("button",{onClick:c,className:"mt-4 px-4 py-2 bg-gray-900 text-white rounded hover:bg-gray-800",children:"Refresh"})]}):_.length===0&&u!=="all"?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-white border rounded-lg p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Orders"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.length," total order(s) â€¢ ",_.length," in selected period"]})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("select",{value:u,onChange:s=>h(s.target.value),className:"px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent text-sm",children:[e.jsx("option",{value:"all",children:"All Orders"}),z.map(s=>e.jsx("option",{value:s.key,children:s.label},s.key))]}),c&&e.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-900 text-white rounded hover:bg-gray-800 text-sm",children:"Refresh"})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-gray-600",children:"No orders found for the selected period."}),e.jsx("button",{onClick:()=>h("all"),className:"mt-4 px-4 py-2 bg-gray-900 text-white rounded hover:bg-gray-800 text-sm",children:"Show All Orders"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 bg-white border rounded-lg p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Orders"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[u==="all"?e.jsxs("span",{children:[_.length," order(s) found"]}):e.jsxs("span",{children:[_.length," order(s) in ",((q=z.find(s=>s.key===u))==null?void 0:q.label)||"selected period",J>0&&_.length>0&&e.jsxs("span",{className:"ml-2 font-medium",children:["â€¢ Total: ",v(J,((V=_[0])==null?void 0:V.currency)||"gbp")]})]}),u!=="all"&&e.jsxs("span",{className:"text-gray-400 ml-2",children:["(of ",a.length," total)"]})]})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("select",{value:u,onChange:s=>h(s.target.value),className:"px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent text-sm bg-white",children:[e.jsx("option",{value:"all",children:"All Orders"}),z.map(s=>e.jsx("option",{value:s.key,children:s.label},s.key))]}),c&&e.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-900 text-white rounded hover:bg-gray-800 text-sm",children:"Refresh"})]})]}),_.map(s=>{var o,l,m,N,S,f,j,X,ee,se,re,te;const r=x===s.order_id,t=s.items||[],n=s.shipping_address||{};return s.tracking&&(s.tracking.tracking_number||s.tracking.tracking_link)&&console.log("Order tracking info:",{orderId:s.order_id,tracking:s.tracking,tracking_number:s.tracking.tracking_number,tracking_link:s.tracking.tracking_link,dispatched:(o=s.metadata)==null?void 0:o.dispatched}),e.jsxs("div",{className:"bg-white border rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>F(s.order_id),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("h3",{className:"font-semibold text-lg",children:["Order #",(l=s.order_id)==null?void 0:l.substring(0,20),"..."]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${s.status==="succeeded"?"bg-green-100 text-green-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.status||"unknown"}),U(s)&&e.jsxs("span",{className:"px-2 py-1 text-xs rounded bg-blue-100 text-blue-800 flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Dispatched"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Customer:"})," ",s.customer_name||s.customer_email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",O(s.order_date)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total:"})," ",v(s.total_amount,s.currency)]})]}),(((m=s.tracking)==null?void 0:m.tracking_number)||((N=s.tracking)==null?void 0:N.tracking_link))&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm",children:[((S=s.tracking)==null?void 0:S.tracking_number)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Tracking #:"}),e.jsx("span",{className:"text-gray-900 font-mono text-xs bg-gray-100 px-2 py-1 rounded",children:s.tracking.tracking_number})]}),((f=s.tracking)==null?void 0:f.tracking_link)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Track:"}),e.jsxs("a",{href:s.tracking.tracking_link,target:"_blank",rel:"noopener noreferrer",onClick:g=>g.stopPropagation(),className:"text-blue-600 hover:text-blue-800 hover:underline flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"View Tracking"]})]})]})}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[t.length," item(s) â€¢ ",s.customer_email]})]}),e.jsxs("div",{className:"ml-4 flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2",onClick:g=>{g.stopPropagation(),B(s.order_id,U(s))},children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:U(s),onChange:()=>{},disabled:p.has(s.order_id),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer disabled:opacity-50"}),e.jsx("span",{className:"text-sm text-gray-600",children:p.has(s.order_id)?"Updating...":"Dispatched"})]})}),e.jsx("div",{className:"cursor-pointer",onClick:()=>F(s.order_id),children:e.jsx("svg",{className:`w-5 h-5 text-gray-400 transition-transform ${r?"transform rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})}),r&&e.jsxs("div",{className:"border-t bg-gray-50 p-6",children:[(((j=s.tracking)==null?void 0:j.tracking_number)||((X=s.tracking)==null?void 0:X.tracking_link)||((ee=s.metadata)==null?void 0:ee.dispatched_at))&&e.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold mb-3 text-gray-900 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Dispatch Information"]}),e.jsxs("div",{className:"space-y-3",children:[((se=s.metadata)==null?void 0:se.dispatched_at)&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Dispatched Date:"})," ",e.jsx("span",{className:"text-gray-900",children:O(s.metadata.dispatched_at)})]}),((re=s.tracking)==null?void 0:re.tracking_number)&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Tracking Number:"})," ",e.jsx("span",{className:"text-gray-900 font-mono bg-white px-2 py-1 rounded border border-blue-200",children:s.tracking.tracking_number})]}),((te=s.tracking)==null?void 0:te.tracking_link)&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Tracking Link:"})," ",e.jsxs("a",{href:s.tracking.tracking_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline inline-flex items-center gap-1 break-all",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),e.jsx("span",{className:"break-all",children:s.tracking.tracking_link})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{onClick:g=>{g.stopPropagation(),I(s.order_id)},className:"px-3 py-1.5 text-xs text-gray-700 hover:text-gray-900 border border-gray-300 rounded hover:bg-white transition-colors",disabled:p.has(s.order_id),children:U(s)?"Edit Tracking Info":"Add/Edit Tracking Info"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-900",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Name:"})," ",s.customer_name||"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Email:"})," ",e.jsx("a",{href:`mailto:${s.customer_email}`,className:"text-blue-600 hover:underline",children:s.customer_email})]}),s.customer_phone&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Phone:"})," ",e.jsx("a",{href:`tel:${s.customer_phone}`,className:"text-blue-600 hover:underline",children:s.customer_phone})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-900",children:"Shipping Address"}),n.line1?e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("div",{children:n.line1}),n.line2&&e.jsx("div",{children:n.line2}),e.jsxs("div",{children:[n.city,n.state&&`, ${n.state}`]}),e.jsxs("div",{children:[n.postal_code," ",n.country]})]}):e.jsx("p",{className:"text-sm text-gray-500",children:"No shipping address provided"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-900",children:"Order Items"}),e.jsx("div",{className:"space-y-4",children:t.map((g,le)=>e.jsxs("div",{className:"bg-white border rounded p-4 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:g.design_image?e.jsx("img",{src:g.design_image,alt:g.name||"Custom design",className:"w-24 h-24 object-cover rounded border",onError:L=>{g.case_image&&L.target.src!==g.case_image?L.target.src=g.case_image:L.target.style.display="none"}}):g.case_image?e.jsx("img",{src:g.case_image,alt:g.name||"Case",className:"w-24 h-24 object-cover rounded border",onError:L=>{L.target.style.display="none"}}):e.jsx("div",{className:"w-24 h-24 bg-gray-200 rounded border flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No image"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:g.name||"Custom Case"}),e.jsxs("div",{className:"mt-1 space-y-1 text-sm text-gray-600",children:[g.case_type&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",g.case_type]}),g.color&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Color:"})," ",g.color]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Quantity:"})," ",g.quantity||1]}),g.pins&&g.pins.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Pins:"})," ",g.pins.map((L,ae)=>e.jsxs("span",{children:[L.name||L,ae<g.pins.length-1?", ":""]},ae))]}),g.custom_design&&e.jsx("span",{className:"inline-block px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded mt-1",children:"Custom Design"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:v(g.total_price||g.unit_price||0,s.currency)}),g.quantity>1&&e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[v(g.unit_price||0,s.currency)," each"]})]})]},le))})]}),e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Payment Intent:"})," ",e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:s.payment_intent_id||"N/A"})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("span",{className:"font-medium",children:"Order ID:"})," ",e.jsx("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:s.order_id})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:v(s.total_amount,s.currency)})]})]})})]})]},s.order_id)}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:y.currentDispatched?"Edit Tracking Information":"Dispatch Order"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:y.currentDispatched?"Update tracking information for this dispatched order:":"Enter tracking information for this order (optional):"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tracking Number"}),e.jsx("input",{type:"text",value:D,onChange:s=>$(s.target.value),placeholder:"e.g., 1Z999AA10123456784",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tracking Link"}),e.jsx("input",{type:"url",value:E,onChange:s=>M(s.target.value),placeholder:"https://tracking.example.com/...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-900 focus:border-transparent"})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>{C(null),$(""),M("")},className:"px-4 py-2 text-sm text-gray-700 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors",disabled:p.has(y.orderId),children:"Cancel"}),e.jsx("button",{onClick:T,disabled:p.has(y.orderId),className:"px-4 py-2 text-sm bg-gray-900 text-white rounded-md hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p.has(y.orderId)?y.currentDispatched?"Updating...":"Dispatching...":y.currentDispatched?"Update Tracking":"Dispatch Order"})]})]})})]})},Y=ge(),Ee=()=>{const a=he(),[i,d]=b.useState("inventory"),[c,x]=b.useState(P),[w,u]=b.useState(!1),[h,p]=b.useState([]),[k,y]=b.useState(!1),[C,D]=b.useState(null),[$,E]=b.useState(!0),[M,O]=b.useState(null),[v,F]=b.useState(null),[B,I]=b.useState(!1),[A,T]=b.useState(!1),U="thehappycase.shop@gmail.com",z=(s,r)=>{r.cases&&(s.cases=s.cases.map((t,n)=>{var l;const o=W(Q({},t),{quantity:r.cases[n]!==void 0&&r.cases[n]!==null?r.cases[n]:t.quantity});return(l=r.caseColors)!=null&&l[n]&&(o.colors=o.colors.map((m,N)=>W(Q({},m),{quantity:r.caseColors[n][N]!==void 0&&r.caseColors[n][N]!==null?r.caseColors[n][N]:m.quantity}))),o})),r.pins&&["flags","colorful","bronze"].forEach(t=>{r.pins[t]&&(s.pins[t]=s.pins[t].map((n,o)=>W(Q({},n),{quantity:r.pins[t][o]!==void 0&&r.pins[t][o]!==null?r.pins[t][o]:n.quantity})))})};window.__dashboardInventoryLoading||(window.__dashboardInventoryLoading=!1,window.__dashboardInventoryLoaded=!1),b.useEffect(()=>{if(window.__dashboardInventoryLoading){console.log("â­ï¸ Dashboard: Already loading (skipping StrictMode duplicate)");return}if(window.__dashboardInventoryLoaded){console.log("â­ï¸ Dashboard: Already loaded (skipping StrictMode duplicate)");return}window.__dashboardInventoryLoading=!0,console.log("ðŸ”’ Dashboard: Set loading flag (module-level), starting fetch"),R(void 0,null,function*(){E(!0),console.log("ðŸ“¥ Dashboard: Loading inventory from Supabase...");try{yield new Promise(l=>setTimeout(l,100));const r=H("/api/inventory");console.log("ðŸ“¡ Dashboard: Fetching from:",r);const t=yield fetch(r),n=t.headers.get("content-type")||"";if(!n.includes("application/json")){const l=yield t.text();throw console.error("âŒ Dashboard: Expected JSON, got:",n),console.error("âŒ Dashboard: Response status:",t.status,t.statusText),console.error("âŒ Dashboard: Response text:",l),new Error(`Expected JSON, got ${n}: ${l.substring(0,500)}`)}const o=yield t.json();if(t.ok){if(o.success&&o.inventory){const l={cases:o.inventory.cases,caseColors:o.inventory.caseColors,pins:o.inventory.pins},m=structuredClone(P);z(m,l),x(m),O("supabase"),console.log("âœ… Dashboard: Inventory loaded from Supabase inventory_items table"),console.log("âœ… Dashboard: All saved quantities are now displayed"),console.log("ðŸ’¾ Dashboard: Data source: Supabase (persisted, will be available after deployment)"),window.__dashboardInventoryLoaded=!0,window.__dashboardInventoryLoading=!1,E(!1);return}}else{console.error("âŒ Dashboard: Supabase API returned non-OK response:",t.status);let l=`HTTP ${t.status}: ${t.statusText}`;try{const m=yield t.json();console.error("âŒ Dashboard: Error details:",m),l=m.error||m.message||l,t.status===500&&(console.error("âŒ Dashboard: Server error - check server console for details"),console.error("âŒ Dashboard: Error:",m.error||"Internal server error"),m.details&&console.error("âŒ Dashboard: Error details:",m.details))}catch(m){console.error("âŒ Dashboard: Non-JSON error response received"),console.error("âŒ Dashboard: Failed to parse error as JSON:",m);try{const S=yield t.clone().text();console.error("âŒ Dashboard: Response status:",t.status),console.error("âŒ Dashboard: Response headers:",Object.fromEntries(t.headers.entries())),console.error("âŒ Dashboard: Response text (first 500 chars):",S.substring(0,500)),console.error("âŒ Dashboard: Full response text length:",S.length)}catch(N){console.error("âŒ Dashboard: Could not read error response:",N)}}}}catch(r){console.error(`
âŒ ========== DASHBOARD INVENTORY LOAD ERROR ==========`),console.error("Failed to load from Supabase:",r.message),console.error("Error name:",r.name),r.stack&&console.error("Error stack:",r.stack),console.error(`========================================================
`),window.__dashboardInventoryLoading=!1,x(P),O("default"),console.warn("âš ï¸ Dashboard: Failed to load from Supabase, using default quantities from products.json"),window.__dashboardInventoryLoaded=!0,window.__dashboardInventoryLoading=!1,E(!1)}})},[]),b.useEffect(()=>()=>{},[]),b.useEffect(()=>{const s=typeof window!="undefined"?localStorage.getItem("userEmail"):null,r=U.toLowerCase().trim();if(s){const t=s.toLowerCase().trim();if(t===r){T(!0),I(!0),console.log("âœ… User authorized via localStorage:",t),Y&&Y.auth.getUser().then(({data:n,error:o})=>{var l;!o&&(n!=null&&n.user)&&(F(n.user),console.log("âœ… Supabase user also authenticated:",(l=n.user)==null?void 0:l.id))});return}}if(!Y){console.warn("âš ï¸ Supabase client not initialized. Set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY in .env"),I(!0),T(!1);return}Y.auth.getUser().then(({data:t,error:n})=>{var m;if(n){if(console.error("âŒ Error getting user:",n),s&&s.toLowerCase().trim()===r){T(!0),I(!0),console.log("âœ… User authorized via localStorage (Supabase auth failed)");return}I(!0),T(!1);return}const o=t.user;F(o),I(!0);const l=(m=o==null?void 0:o.email)==null?void 0:m.toLowerCase().trim();if(l===r)T(!0),console.log("âœ… User authenticated and authorized via Supabase:",o==null?void 0:o.id);else{if(s&&s.toLowerCase().trim()===r){T(!0),console.log("âœ… User authorized via localStorage (Supabase email different)");return}T(!1),console.warn("âŒ Unauthorized access attempt. User email:",l||s),console.warn("âŒ Authorized email:",r)}})},[]),b.useEffect(()=>{!B||!A||i==="orders"&&_((v==null?void 0:v.id)||null)},[i,B,A,v]);const _=(s=null)=>R(void 0,null,function*(){var r,t,n,o;y(!0),D(null);try{yield new Promise(j=>setTimeout(j,100));const l=H("/get-orders?limit=100");console.log("ðŸ“¡ Fetching all orders from:",l),console.log("ðŸ“Š Dashboard: Fetching all orders (no email filter)"),s?console.log("ðŸ‘¤ User ID:",s):console.log("ðŸ“Š Fetching orders without user ID (showing all orders)");const m=yield fetch(l);if((m.headers.get("content-type")||"").includes("text/html"))throw new Error("Backend server returned HTML (likely 404). Is the server running on port 3001?");const S=yield m.text();if(!S||S.trim()==="")throw console.error("âŒ Empty response received. Status:",m.status,m.statusText),console.error("âŒ Response headers:",Object.fromEntries(m.headers.entries())),new Error("Server returned empty response. Check server logs for errors. Make sure the backend server is running on port 3001.");let f;try{f=JSON.parse(S)}catch(j){throw console.error("âŒ Failed to parse JSON response:",j),console.error("âŒ Response status:",m.status,m.statusText),console.error("âŒ Response text (first 500 chars):",S.substring(0,500)),new Error(`Server returned invalid JSON: ${j.message}. Response: ${S.substring(0,200)}`)}if(!m.ok){const j=(f==null?void 0:f.error)||(f==null?void 0:f.message)||`Server error: ${m.status} ${m.statusText}`;throw console.error("âŒ Server error response:",{status:m.status,error:j,data:f}),new Error(j)}if(f.success)p(f.orders||[]),console.log(`âœ… Loaded ${((r=f.orders)==null?void 0:r.length)||0} orders from Supabase`);else{const j=f.error||f.message||"Failed to fetch orders";console.error("âŒ API returned success=false:",j),D(j)}}catch(l){console.error("âŒ Error fetching orders:",l),console.error("âŒ Error details:",{name:l.name,message:l.message,stack:l.stack});let m=l.message||"Failed to fetch orders.";(t=l.message)!=null&&t.includes("HTML")||(n=l.message)!=null&&n.includes("404")?m="Backend server not reachable. Make sure the server is running: npm run server":(o=l.message)!=null&&o.includes("empty response")&&(m="Server returned empty response. Check if the backend server is running on port 3001."),D(m)}finally{y(!1)}}),J=(s,r,t,n,o=null)=>{const l=structuredClone(c);s==="case"&&(o!==null?l.cases[r].colors[o].quantity=parseInt(n)||0:l.cases[r].quantity=parseInt(n)||0),s==="charm"&&(l.pins[t][r].quantity=parseInt(n)||0),x(l),u(!1)},q=()=>R(void 0,null,function*(){const s={cases:c.cases.map(r=>{var t;return(t=r.quantity)!=null?t:null}),caseColors:c.cases.map(r=>{var t;return(t=r.colors)==null?void 0:t.map(n=>{var o;return(o=n.quantity)!=null?o:null})}),pins:{flags:c.pins.flags.map(r=>{var t;return(t=r.quantity)!=null?t:null}),colorful:c.pins.colorful.map(r=>{var t;return(t=r.quantity)!=null?t:null}),bronze:c.pins.bronze.map(r=>{var t;return(t=r.quantity)!=null?t:null})}};try{const r=yield fetch(H("/api/inventory"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=r.headers.get("content-type")||"";let n;if(t.includes("application/json"))try{n=yield r.json()}catch(o){throw console.error("âŒ Failed to parse JSON response:",o),new Error("Server returned invalid JSON response. Make sure the backend server is running on port 3001.")}else{let o="";try{o=yield r.text()}catch(m){o="Could not read response body"}const l=t.includes("text/html")||t.includes("text/plain")?`Backend server returned ${t} instead of JSON. This usually means:
1. The backend server is not running (start with: npm run server)
2. The proxy is not configured correctly
3. The endpoint does not exist

Response preview: ${o.substring(0,200)}`:`Server returned non-JSON response (${t||"unknown"}). Make sure the backend server is running on port 3001.

Response preview: ${o.substring(0,200)}`;throw console.error("âŒ Error saving inventory:",l),console.error("âŒ Full response text:",o),new Error(`Server returned non-JSON response (${t}). Make sure the backend server is running on port 3001.`)}if(r.ok){if(console.log("âœ… Inventory saved to Supabase:",n),console.log(`ðŸ“Š Saved ${n.updatedCount||0} items to inventory_items table`),console.log("ðŸ’¾ All inventory data is now persisted in Supabase and will be available after deployment"),n.success&&n.updatedCount>0){console.log("âœ… Verification: Inventory successfully saved to Supabase database"),console.log("âœ… This data will persist after deployment");const o={cases:s.cases,caseColors:s.caseColors,pins:s.pins},l=structuredClone(P);z(l,o),x(l),O("supabase"),window.dispatchEvent(new CustomEvent("inventoryUpdated",{detail:{timestamp:Date.now(),updatedCount:n.updatedCount}})),console.log("ðŸ“¢ Broadcasted inventoryUpdated event to refresh other pages")}u(!0),setTimeout(()=>u(!1),3e3)}else{let o="Unknown error";try{const l=yield r.json();o=l.error||l.message||"Unknown error"}catch(l){o=`HTTP ${r.status}: ${r.statusText}`}console.error("Failed to save inventory to Supabase:",o),alert(`Failed to save to Supabase: ${o}`),u(!1)}}catch(r){console.error("Error saving inventory to Supabase:",r);const t=r.message||"Unknown error",n=t.includes("HTML")||t.includes("404")?`Error: Backend server not reachable.

Troubleshooting steps:
1. Check if backend server is running: npm run server
2. Verify server is on port 3001
3. Restart React dev server if you just configured proxy
4. Check setupProxy.js is in src/ directory`:`Error saving to Supabase: ${t}`;alert(n),u(!1)}}),V=()=>R(void 0,null,function*(){E(!0),O(null);try{const s=yield fetch(H("/api/inventory"));if(s.ok){const r=yield s.json();if(r.success&&r.inventory){const t={cases:r.inventory.cases,caseColors:r.inventory.caseColors,pins:r.inventory.pins},n=structuredClone(P);z(n,t),x(n),O("supabase"),console.log("âœ… Refreshed: Inventory reloaded from Supabase")}}}catch(s){console.error("Failed to refresh from Supabase:",s)}finally{E(!1)}});return B?A?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h1",{className:"text-3xl font-light mb-6 font-inter",children:"Dashboard"}),e.jsx(xe,{activeTab:i,onTabChange:d}),i==="inventory"&&e.jsx(je,{products:c,inventorySource:M,loadingInventory:$,saved:w,onRefresh:V,onSave:q,onQuantityChange:J}),i==="orders"&&e.jsx(Ne,{orders:h,loadingOrders:k,ordersError:C,onRefresh:()=>A&&_((v==null?void 0:v.id)||null)})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 md:p-12 text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:e.jsx("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",style:{fontFamily:"'Poppins', sans-serif"},children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-6 font-inter",children:"You do not have permission to access the dashboard. This area is restricted to authorized personnel only."}),(v==null?void 0:v.email)&&e.jsxs("p",{className:"text-sm text-gray-500 mb-6 font-inter",children:["Your email: ",e.jsx("span",{className:"font-medium",children:v.email})]}),e.jsx("button",{onClick:()=>a("/"),className:"px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-md transition-colors font-inter",children:"Go to Home"})]})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),e.jsx("p",{className:"mt-4 text-gray-600 font-inter",children:"Checking authorization..."})]})})})};export{Ee as default};
