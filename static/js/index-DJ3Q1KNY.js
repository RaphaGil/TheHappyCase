var xt=Object.defineProperty,ht=Object.defineProperties;var ft=Object.getOwnPropertyDescriptors;var We=Object.getOwnPropertySymbols;var gt=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Ye=(t,n,s)=>n in t?xt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[n]=s,we=(t,n)=>{for(var s in n||(n={}))gt.call(n,s)&&Ye(t,s,n[s]);if(We)for(var s of We(n))pt.call(n,s)&&Ye(t,s,n[s]);return t},Ce=(t,n)=>ht(t,ft(n));var Ee=(t,n,s)=>new Promise((i,o)=>{var l=r=>{try{a(s.next(r))}catch(x){o(x)}},d=r=>{try{a(s.throw(r))}catch(x){o(x)}},a=r=>r.done?i(r.value):Promise.resolve(r.value).then(l,d);a((s=s.apply(t,n)).next())});import{j as e,r as f,F as Se,a as yt,e as bt,u as wt}from"./react-vendor-BwkbXqKG.js";import{n as se,d as vt,e as jt,g as me,P as oe,b as Ue,v as Nt,c as kt,f as Ct,p as St,h as At}from"./shared-utils-DkooxM7j.js";import{j as _e,o as Tt,X as Lt,U as Pt}from"./fabric-vendor-cjQCy6PH.js";import{f as Et}from"./filterHelpers-BdMq4J7p.js";import{n as Mt,o as Bt,q as Ot,r as Rt}from"./fontawesome-vendor-BEuASCuQ.js";import{u as Dt,a as It}from"./index-CC-rt800.js";import{A as Xe}from"./index-CuP7Ro5G.js";import"./vendor-BupaDLyo.js";const zt=()=>e.jsxs("div",{className:"text-center flex-shrink-0 mt-4 md:mt-6",children:[e.jsx("h1",{className:"text-title text-gray-900 tracking-title mb-1 md:mb-2",children:"CREATE YOURS"}),e.jsx("div",{className:"w-16 sm:w-20 md:w-24 h-px bg-gray-200 mx-auto mb-2 md:mb-4"}),e.jsx("p",{className:"md:block hidden text-sm text-gray-500 max-w-2xl mx-auto font-light",style:{fontFamily:"'Poppins', sans-serif"},children:"Design your perfect passport case with our interactive creator"})]}),$t=({onClose:t})=>e.jsx("button",{onClick:t,className:"absolute right-2 xs:right-3 sm:right-4 z-50 w-7 h-7 xs:w-8 xs:h-8 flex items-center justify-center transition-colors","aria-label":"Close and go back to home",children:e.jsx("svg",{className:"w-12 h-12 xs:w-5 xs:h-5 mt-4 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),Ft=({showControls:t,controlsPosition:n,onRotateLeft:s,onRotateRight:i,onDelete:o})=>t?e.jsxs("div",{className:"absolute flex items-center gap-0.5 bg-white bg-opacity-50 text-gray-800 rounded-sm px-1.5 py-0.5 z-[60] ",style:{left:`${n.x}px`,top:`${n.y}px`,position:"absolute",pointerEvents:"auto"},children:[e.jsx("button",{onClick:s,className:"w-5 h-5 flex items-center justify-center text-gray-800 hover:text-gray-900 rounded ","aria-label":"Rotate Left",title:"Rotate Left",style:{color:"#1f2937"},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"16",height:"16",fill:"currentColor",style:{color:"#1f2937"},children:e.jsx("path",{d:"M24 192l144 0c9.7 0 18.5-5.8 22.2-14.8s1.7-19.3-5.2-26.2l-46.7-46.7c75.3-58.6 184.3-53.3 253.5 15.9 75 75 75 196.5 0 271.5s-196.5 75-271.5 0c-10.2-10.2-19-21.3-26.4-33-9.5-14.9-29.3-19.3-44.2-9.8s-19.3 29.3-9.8 44.2C49.7 408.7 61.4 423.5 75 437 175 537 337 537 437 437S537 175 437 75C342.8-19.3 193.3-24.7 92.7 58.8L41 7C34.1 .2 23.8-1.9 14.8 1.8S0 14.3 0 24L0 168c0 13.3 10.7 24 24 24z"})})}),e.jsx("button",{onClick:i,className:"w-5 h-5 flex items-center justify-center text-gray-800 hover:text-gray-900 rounded transition-colors bg-transparent","aria-label":"Rotate Right",title:"Rotate Right",style:{color:"#1f2937"},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"16",height:"16",fill:"currentColor",style:{color:"#1f2937"},children:e.jsx("path",{d:"M488 192l-144 0c-9.7 0-18.5-5.8-22.2-14.8s-1.7-19.3 5.2-26.2l46.7-46.7c-75.3-58.6-184.3-53.3-253.5 15.9-75 75-75 196.5 0 271.5s196.5 75 271.5 0c8.2-8.2 15.5-16.9 21.9-26.1 10.1-14.5 30.1-18 44.6-7.9s18 30.1 7.9 44.6c-8.5 12.2-18.2 23.8-29.1 34.7-100 100-262.1 100-362 0S-25 175 75 75c94.3-94.3 243.7-99.6 344.3-16.2L471 7c6.9-6.9 17.2-8.9 26.2-5.2S512 14.3 512 24l0 144c0 13.3-10.7 24-24 24z"})})}),e.jsx("button",{onClick:o,className:"w-6 h-6 flex items-center justify-center text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-colors","aria-label":"Remove",title:"Delete",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 384 512",width:"24",height:"24",fill:"currentColor",style:{color:"#dc2626"},children:e.jsx("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})})})]}):null,Wt=(t,n,s,i,o)=>{const l=f.useCallback(a=>{if(!a||!t.current||a.isCase)return;const r=o.current.get(a);r&&(t.current.remove(r),o.current.delete(a));const x=a.getBoundingRect(!0),h=new _e({left:x.left,top:x.top,width:x.width,height:x.height,originX:"left",originY:"top",fill:"transparent",stroke:"#111827",strokeWidth:1,strokeDashArray:[3,3],selectable:!1,evented:!1,excludeFromExport:!1});o.current.set(a,h),t.current.add(h);const g=n.current;g&&t.current.sendObjectToBack(g),s.current&&t.current.sendObjectToBack(s.current),i.current&&t.current.sendObjectToBack(i.current),t.current.bringObjectToFront(a),t.current.renderAll()},[t,n,s,i,o]),d=f.useCallback(a=>{if(!a||!t.current)return;const r=o.current.get(a);r&&(t.current.remove(r),o.current.delete(a),t.current.renderAll())},[t,o]);return{updateBorderRect:l,removeBorderRect:d}},Yt=()=>{const[t,n]=f.useState({x:0,y:0}),[s,i]=f.useState(!1),o=f.useCallback((l,d)=>{if(!l||!d.current)return;const a=l.getBoundingRect(!0),x=d.current.getElement(),h=x.parentElement;if(!h)return;const g=x.getBoundingClientRect(),p=h.getBoundingClientRect(),k=g.left-p.left,v=g.top-p.top,P=k+a.left+a.width/2,y=v+a.top+a.height+14,u=70,b=32,C=Math.max(6,Math.min(P-u/2,p.width-u-6)),A=Math.max(6,Math.min(y,p.height-b-6));n({x:C,y:A})},[]);return{controlsPosition:t,showControls:s,setShowControls:i,updateControls:o}},Ut=({selectedCaseType:t,selectedColor:n,selectedPins:s,onPinSelect:i,onPinRemove:o,products:l,onSaveImage:d})=>{const a=f.useRef(null),r=f.useRef(null),x=f.useRef(null),h=f.useRef(null),g=f.useRef(null),p=f.useRef(new Map),k=f.useRef(null),[v,P]=f.useState(null),{controlsPosition:y,showControls:u,setShowControls:b,updateControls:C}=Yt(),{updateBorderRect:A,removeBorderRect:U}=Wt(r,x,h,g,p),D=f.useCallback((S,w=!1,O=85,j=85)=>new Promise((M,$)=>{const E=new Image;E.crossOrigin="anonymous",E.src=S,E.onload=()=>{const T=r.current.getWidth(),c=r.current.getHeight();let R,X,re=T/2,ae=c/2;if(w){const G=Math.min(T*1/E.width,c*1/E.height);R=G,X=G}else{const G=Math.max(O,j),I=E.width/E.height;let V,ee;E.width>=E.height?(V=G,ee=G/I):(ee=G,V=G*I),R=V/E.width,X=ee/E.height}const H=new Tt(E,{left:re,top:ae,originX:"center",originY:"center",scaleX:R,scaleY:X,selectable:!w,hasControls:w,lockScalingX:w,lockScalingY:w,borderColor:"transparent",cornerColor:w?"transparent":"blue",cornerSize:w?0:8,transparentCorners:!1,hasBorders:!1,isCase:w});w?(k.current&&(clearTimeout(k.current),k.current=null),r.current.getObjects().forEach(I=>{I&&I.type==="rect"&&(I.isBoundaryRect===!0||Array.isArray(I.strokeDashArray)&&(I.strokeDashArray[0]===4&&I.strokeDashArray[1]===4||I.strokeDashArray[0]===3&&I.strokeDashArray[1]===3)&&(!I.fill||I.fill==="transparent")&&I.selectable===!1&&I.evented===!1)&&r.current.remove(I)}),h.current=null,g.current&&(r.current.remove(g.current),g.current=null),H.set("evented",!1),x.current=H,r.current.add(H),r.current.sendObjectToBack(H),k.current=setTimeout(()=>{if(x.current!==H)return;h.current&&r.current.remove(h.current);const I=H.getBoundingRect(),V=t==="business"?140:120,ee=t==="business"?50:40,K=new _e({left:I.left+V,top:I.top+ee,width:I.width-V*2,height:I.height-ee*2,fill:"transparent",stroke:"rgba(239, 68, 68, 0.3)",strokeWidth:1,strokeDashArray:[4,4],selectable:!1,evented:!1,visible:!1,isBoundaryRect:!0});h.current=K,r.current.add(K),r.current.sendObjectToBack(K),g.current=null,r.current.sendObjectToBack(H),r.current.renderAll(),k.current=null},100)):r.current.add(H),r.current.renderAll(),M(H)},E.onerror=$}),[t]),m=f.useCallback(S=>{C(S,r)},[C]),W=f.useCallback(()=>{const S=r.current;if(!S||!a.current)return;const w=a.current.parentElement;if(!w)return;const O=w.clientWidth,j=w.clientHeight;S.setWidth(O),S.setHeight(j),S.renderAll()},[]);f.useEffect(()=>{if(!a.current)return;const S=a.current.parentElement;if(!S)return;const w=S.clientWidth,O=S.clientHeight;r.current=new Lt(a.current,{width:w,height:O,backgroundColor:"transparent"}),r.current.on("object:moving",T=>{const c=T.target;if(!c||!c.getBoundingRect||c.isCase||c===h.current||c===g.current)return;const R=r.current.getWidth(),X=r.current.getHeight(),re=c.getBoundingRect(!0),ae=re.width,H=re.height,G=ae/2,I=H/2;let V=c.left,ee=c.top;const K=5;re.left<K&&(V=K+G),re.left+ae>R-K&&(V=R-K-G),re.top<K&&(ee=K+I),re.top+H>X-K&&(ee=X-K-I),(V!==c.left||ee!==c.top)&&(c.set({left:V,top:ee}),c.setCoords());const le=p.current.get(c);if(le){const ne=c.getBoundingRect(!0),fe=Math.min(ne.width,ne.height),ie=Math.max(2,fe*.025);le.set({left:ne.left+ie,top:ne.top+ie,width:ne.width-ie*2,height:ne.height-ie*2}),le.setCoords(),r.current.bringObjectToFront(c)}r.current.getActiveObject()===c&&m(c)}),r.current.on("object:modified",T=>{const c=T.target;if(h.current&&c&&!c.isCase&&c!==h.current&&h.current.set("visible",!1),g.current&&c&&!c.isCase&&c!==g.current&&g.current.set("visible",!1),c&&!c.isCase&&c!==h.current&&c!==g.current&&r.current.renderAll(),c&&!c.isCase){const R=r.current.getActiveObject()===c;c.type==="textbox"||c.type==="text"||c.type==="i-text"?c.set({lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0,hasControls:!1,hasBorders:!1,borderColor:"transparent",cornerColor:"transparent",cornerSize:0,transparentCorners:!0}):c.type==="image"&&c.set({hasBorders:!1,borderColor:"transparent"}),R?A(c):U(c),r.current.getActiveObject()===c&&m(c)}}),r.current.on("selection:created",T=>{const c=T.selected[0];c&&!c.isCase&&(p.current.forEach((R,X)=>{X!==c&&(r.current.remove(R),p.current.delete(X))}),c.type==="textbox"||c.type==="text"||c.type==="i-text"?c.set({lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0,hasControls:!1,hasBorders:!1,borderColor:"transparent",cornerColor:"transparent",cornerSize:0,transparentCorners:!0}):c.type==="image"&&c.set({hasBorders:!1,borderColor:"transparent"}),A(c),P(c),b(!0),m(c),r.current.renderAll())}),r.current.on("selection:updated",T=>{const c=T.selected[0];c&&!c.isCase&&(p.current.forEach((R,X)=>{X!==c&&(r.current.remove(R),p.current.delete(X))}),c.type==="textbox"||c.type==="text"||c.type==="i-text"?c.set({lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0,hasControls:!1,hasBorders:!1,borderColor:"transparent",cornerColor:"transparent",cornerSize:0,transparentCorners:!0}):c.type==="image"&&c.set({hasBorders:!1,borderColor:"transparent"}),A(c),P(c),b(!0),m(c),r.current.renderAll())}),r.current.on("object:scaling",T=>{const c=T.target;c&&(c.type==="textbox"||c.type==="text"||c.type==="i-text")&&(c.set({scaleX:1,scaleY:1,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0,hasControls:!1,hasBorders:!1,borderColor:"transparent",cornerColor:"transparent",cornerSize:0,transparentCorners:!0}),r.current.renderAll())}),r.current.on("selection:cleared",()=>{h.current&&h.current.set("visible",!1),g.current&&g.current.set("visible",!1),p.current.forEach((T,c)=>{r.current.remove(T),p.current.delete(c)}),r.current.renderAll(),P(null),b(!1),i&&i(null)}),r.current.on("text:changed",T=>{const c=T.target;if(c&&(c.type==="textbox"||c.type==="text"||c.type==="i-text")){const R=c.text||"",X=R.toUpperCase();R!==X&&(c.set("text",X),r.current.renderAll())}});const j=()=>{W()};window.addEventListener("resize",j);const M=p.current,$=r.current,E=k;return()=>{window.removeEventListener("resize",j),E.current&&(clearTimeout(E.current),E.current=null),$&&M&&(M.forEach(T=>{$.remove(T)}),M.clear()),$==null||$.dispose()}},[i,m,A,U,W,b]),f.useEffect(()=>{v&&u&&requestAnimationFrame(()=>{m(v)})},[v,u,m,C]);const Z=f.useCallback((S,w={})=>{if(!r.current)return;const O=(S||"").trim().toUpperCase();if(!O)return;const j=r.current.getWidth(),M=r.current.getHeight(),$=new Pt(O,{left:j/2,top:M/2,originX:"center",originY:"center",fontSize:Number(w.fontSize)||28,fill:w.fill||"#1f2937",fontFamily:w.fontFamily||"'Poppins', sans-serif",textAlign:"center",lineHeight:1.2,borderColor:"transparent",cornerColor:"transparent",cornerSize:0,transparentCorners:!0,padding:6,editable:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0,hasControls:!1,hasBorders:!1});r.current.add($),r.current.setActiveObject($),A($),r.current.renderAll(),P($),b(!0),m($)},[m,A,b]);f.useEffect(()=>{if(!r.current)return;k.current&&(clearTimeout(k.current),k.current=null);const S=r.current.getObjects(),w=j=>{if(!j||j.type!=="rect")return!1;if(j.isBoundaryRect===!0)return!0;const M=j.strokeDashArray,$=Array.isArray(M)&&(M[0]===4&&M[1]===4||M[0]===3&&M[1]===3),E=!j.fill||j.fill==="transparent",T=j.selectable===!1,c=j.evented===!1;return $&&E&&T&&c};S.forEach(j=>{(j.isCase||w(j)||j===h.current||j===g.current)&&r.current.remove(j)}),p.current.forEach(j=>{r.current.remove(j)}),p.current.clear(),x.current=null,h.current=null,g.current=null,r.current.getObjects().forEach(j=>{!j.isCase&&!w(j)&&r.current.bringObjectToFront(j)}),r.current.renderAll()},[t,n]);const Q=f.useCallback(S=>Ee(void 0,null,function*(){if(r.current)try{const O=S.size!==void 0?S.size:.5,j=100*O;console.log("Adding pin to canvas:",S.name,"Size factor:",O,"Calculated size:",j);const M=yield D(se(S.src),!1,j,j),$=r.current.getWidth(),E=r.current.getHeight(),T=(M.width||j)*(M.scaleX||1),c=(M.height||j)*(M.scaleY||1),R=20,X=R+T/2,re=$-R-T/2,ae=R+c/2,H=E-R-c/2,G=Math.random()*(re-X)+X,I=Math.random()*(H-ae)+ae;M.set({left:G,top:I}),M.pinData=S,M.set({hasBorders:!1,borderColor:"transparent"}),r.current.setActiveObject(M),A(M),r.current.renderAll(),i&&i(M)}catch(w){console.error("Error loading pin:",w)}}),[i,A,D]),Y=f.useCallback(()=>{vt(r,h,g)},[]),L=f.useCallback(()=>jt(r,h,g),[]),N=()=>{if(v){const S=v.angle||0;v.set("angle",S-15),r.current.renderAll(),m(v)}},z=()=>{if(v){const S=v.angle||0;v.set("angle",S+15),r.current.renderAll(),m(v)}},_=()=>{v&&(U(v),r.current.remove(v),r.current.discardActiveObject(),r.current.renderAll(),P(null),b(!1),o&&o(v))};return f.useEffect(()=>(window.addPinToCanvas=Q,window.addTextToCanvas=Z,window.getDesignImageDataURL=L,d&&d(Y),()=>{delete window.addPinToCanvas,delete window.addTextToCanvas,delete window.getDesignImageDataURL}),[Z,Q,d,L,Y]),e.jsx("div",{className:"w-full h-full flex flex-col  sm:items-center ",children:e.jsxs("div",{className:"w-full h-full relative flex item-top justify-center  ",children:[e.jsx("canvas",{ref:a,className:"w-full h-screen ",style:{background:"transparent",width:"100%",height:"100%"}}),e.jsx(Ft,{showControls:u,controlsPosition:y,onRotateLeft:N,onRotateRight:z,onDelete:_})]})})},Xt=({caseImages:t,onOpenModal:n})=>!t||t.length===0?null:e.jsx("div",{className:"flex-1 min-w-0 mt-12",children:e.jsxs("button",{onClick:n,className:"w-full px-3 md:px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100 transition-all duration-200 flex items-center justify-center gap-2 shadow-sm hover:shadow-md",style:{fontFamily:"'Poppins', sans-serif"},children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{className:"whitespace-nowrap truncate",children:"IMAGES"}),t.length>0&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full flex-shrink-0",children:t.length})]})}),Ht=({selectedCase:t,onOpenModal:n})=>t?e.jsx("div",{className:"flex-1 min-w-0 mt-12",children:e.jsxs("button",{onClick:n,className:"w-full px-3 md:px-4 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-200 transition-all duration-200 flex items-center justify-center gap-2 shadow-sm hover:shadow-md hover:bg-gray-50 hover:border-gray-400 active:bg-gray-100",style:{fontFamily:"'Poppins', sans-serif"},children:[e.jsx("svg",{className:"w-4 h-4 text-gray-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"whitespace-nowrap truncate",children:"DETAILS"})]})}):null,qt=({selectedCaseType:t,selectedColor:n,selectedCaseImage:s,selectedCase:i,caseImages:o,isCaseDropdownOpen:l,isCharmsDropdownOpen:d,isAddTextDropdownOpen:a,isMobile:r,onPinSelect:x,onPinRemove:h,onOpenImageModal:g,onOpenDescriptionModal:p,Products:k})=>e.jsx("div",{className:`flex flex-col flex-shrink-0 ${r?"justify-start sm:flex-1 sm:justify-center":"md:w-1/2 md:flex-1 md:overflow-hidden md:px-0 md:py-0"} px-2 xs:px-3 sm:px-4 py-0 xs:py-1 sm:py-2 ${l||d||a?"md:sticky md:top-0 md:self-start":""}`,children:e.jsxs("div",{className:"w-full h-full flex flex-col justify-start xs:justify-start sm:justify-center items-center md:justify-between",children:[e.jsxs("div",{className:"w-full max-w-[300px] aspect-[300/350] relative md:mt-2",style:{isolation:"isolate"},children:[s&&e.jsx("img",{src:se(s),alt:"",className:"absolute inset-0 w-full h-full object-contain pointer-events-none",style:{zIndex:0,objectFit:"contain",objectPosition:"center 45%",width:"270px",height:"auto",maxWidth:"100%",margin:"0 auto"},loading:"eager",fetchPriority:"high",decoding:"async",width:"270",height:"350","aria-hidden":"true"},`case-bg-${t}-${n}`),e.jsx("div",{className:"w-full h-full absolute inset-0",style:{zIndex:10,pointerEvents:"auto",width:"100%",height:"100%"},children:e.jsx(Ut,{selectedCaseType:t,selectedColor:n,onPinSelect:x,onPinRemove:h,products:k})})]}),e.jsxs("div",{className:"mt-8 md:mt-8 mb-0 hidden md:flex flex-row gap-2 md:gap-2.5 lg:gap-3 flex-shrink-0 w-full max-w-full md:max-w-[480px] lg:max-w-[520px] relative z-0",children:[e.jsx(Xt,{caseImages:o,onOpenModal:g}),e.jsx(Ht,{selectedCase:i,onOpenModal:p})]})]})}),Be="#675a3a",Oe=28,Ae=15,Me=[{value:"economy",label:"Economy - £8.00",image:"/images/SmartCase/economycaselightpink.webp"},{value:"business",label:"Business - £12.00",image:"/images/BusinessClassCase/businessclasscasegray.webp"},{value:"firstclass",label:"First Class - £12.00",image:"/images/FirstClassCase/firstclasscasebrown.webp"}],Ge=[{value:"bronze",label:"Bronze - £1.00",image:"/images/BronzePins/airplane.webp"},{value:"colorful",label:"Colorful - £2.00",image:"/images/ColorfulPins/beagoodhuman.webp"},{value:"flags",label:"Flags - £2.00",image:"/images/Flags/albania.webp"}],Qt=[{key:"all",label:"ALL"},{key:"europe",label:"EUROPE"},{key:"americas",label:"AMERICAS"},{key:"africa",label:"AFRICA"},{key:"asia",label:"ASIA"},{key:"special",label:"SPECIAL"}],_t=[{key:"all",label:"ALL"},{key:"travel",label:"TRAVEL"},{key:"disney",label:"DISNEY"},{key:"drinks",label:"DRINKS"},{key:"inspiration",label:"INSPIRATION"},{key:"hearts",label:"HEARTS"},{key:"nature",label:"NATURE"},{key:"camera",label:"CAMERA"}],Gt=[{key:"all",label:"ALL"},{key:"travel",label:"TRAVEL"},{key:"animals",label:"ANIMALS"},{key:"love",label:"LOVE"},{key:"nature",label:"NATURE"},{key:"symbols",label:"SYMBOLS"}],Vt=({selectedCaseType:t,onSelect:n,Products:s,onDropdownToggle:i,cart:o=[]})=>{const l=a=>{if(s&&s.cases){const x=s.cases.find(h=>h.type===a);if(x&&x.colors&&x.colors.length>0)return x.colors[0].image}const r=Me.find(x=>x.value===a);return r&&r.image?r.image:null},d=a=>{const r=s&&s.cases?s.cases.find(x=>x.type===a):null;return r&&r.colors&&r.colors.length>0?!r.colors.some(h=>{const g={caseType:a,color:h.color},p=me(g,o);return p===null||p>0}):!1};return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex flex-nowrap gap-2 xs:gap-2.5 sm:gap-3 md:gap-4 lg:gap-5 xl:gap-6 justify-center items-start",children:Me.map(a=>{const r=l(a.value),x=d(a.value),h=t===a.value;return e.jsxs("div",{className:`transition-all duration-200 md:duration-300 lg:duration-500 flex flex-col items-center p-1.5 xs:p-2 sm:p-2.5 md:p-3 rounded-lg flex-1 max-w-[120px] xs:max-w-[140px] sm:max-w-[160px] md:max-w-[180px] lg:max-w-[200px] xl:max-w-[220px] ${h?"bg-gray-50":""} ${x?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{x||(n(a.value),i&&i())},children:[e.jsxs("div",{className:"relative w-full",children:[r&&e.jsx("div",{className:`w-full aspect-square transition-all duration-200 md:duration-300 lg:duration-500 overflow-hidden flex items-center justify-center ${h?"  scale-110":""} ${x?"opacity-50":""}`,children:e.jsx("img",{src:se(r),alt:a.label,className:"w-full h-full object-contain p-1 xs:p-1.5 sm:p-2 md:p-2.5 lg:p-3 xl:p-4",loading:"lazy",onError:g=>{g.target.style.display="none"}})}),h&&!x&&e.jsx("div",{className:"absolute top-0 right-0 md:top-1 md:right-4 lg:top-2 lg:right-4 xl:top-2.5 xl:right-4.5 w-5 h-5 md:w-6 md:h-6 lg:w-7 lg:h-7 xl:w-8 xl:h-8 bg-gray-900 rounded-full flex items-center justify-center shadow-md z-10",children:e.jsx("svg",{className:"w-3 h-3 md:w-3.5 md:h-3.5 lg:w-4 lg:h-4 xl:w-5 xl:h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"flex flex-col items-center mt-2 md:mt-3 lg:mt-4 text-center",children:[e.jsx("span",{className:`text-xs md:text-sm font-medium tracking-wider ${h?"text-gray-700":"text-gray-500"}`,style:{fontFamily:"'Poppins', sans-serif"},children:a.label.split(" - ")[0]}),e.jsx("span",{className:`text-xs md:text-sm font-medium mt-0.5 ${h?"text-gray-500":"text-gray-400"}`,style:{fontFamily:"'Poppins', sans-serif"},children:a.label.split(" - ")[1]})]}),x&&e.jsx("span",{className:"text-[10px] md:text-xs lg:text-sm text-red-600 font-medium mt-1 md:mt-2",children:"Sold Out"})]},a.value)})})})},Zt=t=>{if(!t)return"";let s=t.split("/").pop().replace(".webp","").replace(".png","").replace(".jpg","").toLowerCase().replace(/^economycase/i,"").replace(/^businessclasscase/i,"").replace(/^firstclasscase/i,"").replace(/^smartcase/i,"").replace(/^premiumcase/i,"").replace(/^firstclass/i,"");const i={lightpink:"Light Pink",lightblue:"Light Blue",lightbrown:"Light Brown",darkbrown:"Dark Brown",darkblue:"Dark Blue",jeansblue:"Jeans Blue",brickred:"Brick Red",ligthpink:"Light Pink",navyblue:"Navy Blue",gray:"Gray",grey:"Gray",black:"Black",brown:"Brown",red:"Red",pink:"Pink",blue:"Blue",green:"Green",purple:"Purple",yellow:"Yellow",orange:"Orange"};return i[s]?i[s]:(s=s.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/(dark|light|navy|jeans|brick)([a-z]+)/g,"$1 $2").split(/(?=[A-Z])|(?=dark|light|navy|jeans|brick)/).filter(o=>o.length>0).join(" ").toLowerCase().split(" ").map(o=>i[o]?i[o]:o.charAt(0).toUpperCase()+o.slice(1)).join(" "),s||"Color")},Ve=({colors:t,selectedColor:n,onSelect:s})=>e.jsx("div",{className:"overflow-visible",children:e.jsx("div",{className:"flex flex-wrap gap-3 overflow-visible justify-center justify-center ",children:t.map(({color:i,image:o,quantity:l})=>{const d=Zt(o),a=n===i,r=l!==void 0&&l===0;return e.jsxs("div",{className:`transition-all duration-200 flex flex-col items-center overflow-visible ${r?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>!r&&s(i,o),children:[e.jsxs("div",{className:"relative overflow-visible",children:[e.jsx("div",{className:`w-10 h-10 rounded-full border-2 transition-all duration-200 ${a?"border-gray-900 ring-2 ring-gray-300 scale-110":"border-gray-200 hover:border-gray-400"} ${r?"opacity-50":""}`,style:{backgroundColor:i}}),a&&!r&&e.jsx("div",{className:"absolute top-0 right-0 w-4 h-4 bg-gray-900 rounded-full flex items-center justify-center z-10",children:e.jsx("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),a&&d&&e.jsx("span",{className:"text-xs text-gray-700 font-medium mt-2 text-center font-inter",children:d}),r&&e.jsx("span",{className:"text-[10px] text-red-600 font-medium mt-1",children:"Sold Out"})]},i)})})}),Kt=({isOpen:t,onToggle:n,selectedCaseType:s,selectedColor:i,selectedCase:o,onCaseSelect:l,onColorSelect:d,setIsCaseDropdownOpen:a,Products:r,cart:x})=>e.jsxs("div",{className:"pb-6 border-b border-gray-100 flex-shrink-0 mt-6 overflow-visible hidden md:block",children:[e.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-gray-900 font-medium",style:{fontFamily:"'Poppins', sans-serif"},children:"1. Choose Case"}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform duration-200 ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&e.jsxs("div",{className:"space-y-6 overflow-visible",children:[e.jsx(Vt,{selectedCaseType:s,onSelect:l,Products:r,isCaseDropdownOpen:t,setIsCaseDropdownOpen:a,cart:x}),i&&e.jsx("div",{className:"mt-10 overflow-visible",children:e.jsx(Ve,{colors:(o==null?void 0:o.colors)||[],selectedColor:i,onSelect:d,caseType:s,cart:x})})]})]}),He=(t,n,s)=>!s||s==="all"?t:t.filter(i=>n==="colorful"||n==="bronze"?i.subCategory===s:n==="flags"?i.continent===s:!0),Jt=[{value:"bronze",label:"Bronze Charms",price:"£1.50 each"},{value:"colorful",label:"Colorful Charms",price:"£2.00 each"},{value:"flags",label:"Flags Collection",price:"£2.00 each"}],er={colorful:[{key:"all",label:"ALL"},{key:"travel",label:"TRAVEL"},{key:"disney",label:"DISNEY"},{key:"drinks",label:"DRINKS"},{key:"inspiration",label:"INSPIRATION"},{key:"hearts",label:"HEARTS"},{key:"nature",label:"NATURE"},{key:"camera",label:"CAMERA"}],bronze:[{key:"all",label:"ALL"},{key:"travel",label:"TRAVEL"},{key:"animals",label:"ANIMALS"},{key:"love",label:"LOVE"},{key:"nature",label:"NATURE"},{key:"symbols",label:"SYMBOLS"}],flags:[{key:"all",label:"ALL"},{key:"europe",label:"EUROPE"},{key:"americas",label:"AMERICAS"},{key:"africa",label:"AFRICA"},{key:"asia",label:"ASIA"},{key:"special",label:"SPECIAL"}]},tr=({selectedCategory:t,setSelectedCategory:n,onDropdownToggle:s,getPreviewImage:i})=>e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Jt.map(o=>{const l=i(o.value),d=t===o.value;return e.jsxs("button",{type:"button",role:"option","aria-selected":d,className:`font-inter flex flex-col items-center p-2.5 rounded-lg transition-colors ${d?"bg-gray-50":"hover:bg-gray-50"}`,onClick:()=>{n(o.value),s&&s()},children:[l&&e.jsxs("div",{className:"relative mb-2 flex items-center justify-center rounded overflow-visible",style:{width:"4rem",height:"4rem"},children:[e.jsx("div",{className:"w-full h-full flex items-center justify-center rounded overflow-hidden",children:e.jsx("img",{src:se(l),alt:o.label,className:"max-w-full max-h-full object-contain p-1",loading:"lazy",decoding:"async"})}),d&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-gray-900 rounded-full flex items-center justify-center z-20 shadow-sm ",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("span",{className:`text-xs text-center font-light ${d?"text-gray-900":"text-gray-600"}`,children:o.label}),e.jsx("span",{className:"text-[10px] text-gray-500 mt-0.5",children:o.price})]},o.value)})}),rr=({selectedCategory:t,subCategory:n,setSubCategory:s,getSubCategoryCount:i})=>{if(!t)return null;const o=er[t];if(!o)return null;const l="px-3 py-2 text-caption uppercase tracking-wider transition-all duration-200 font-inter";return e.jsx("div",{className:"mb-4 flex flex-wrap gap-1 border-b border-gray-200 justify-center",children:o.map(({key:d,label:a})=>{const r=i(d),x=n===d,h=t==="flags"?"text-gray-900 font-medium":"border-b-2 border-gray-900 text-gray-900 font-medium",g=t==="flags"?"border-transparent text-gray-500 hover:text-gray-900 hover:border-gray-300":"border-b-2 border-transparent text-gray-500 hover:text-gray-900 hover:border-gray-300";return e.jsxs("button",{onClick:()=>s(d),className:`${l} ${x?h:g}`,children:[a," ",e.jsxs("span",{className:"text-gray-400 font-normal",children:["(",r,")"]})]},d)})})},sr=({pin:t,isSelected:n,isSoldOut:s,onClick:i})=>{const l=(d=>d?d<=.3?"XS":d<=.45?"S":d<=.6?"M":d<=.75?"L":"XL":"")(t.size);return e.jsxs("div",{className:`flex flex-col items-center justify-center text-center space-y-1 sm:space-y-2 p-2 sm:p-3 h-full transition-colors group touch-manipulation ${s?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:i,children:[e.jsxs("div",{className:"relative",style:{overflow:"visible"},children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 aspect-square flex items-center justify-center bg-transparent",children:e.jsx("img",{src:se(t.src),alt:t.name,className:`w-full h-full object-contain transition-all duration-200 rounded ${s?"opacity-50":""}`,loading:"lazy"})}),n&&!s&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-black text-white w-6 h-6 flex items-center justify-center text-xs rounded-full z-10 shadow-md",children:"✓"}),l&&e.jsx("div",{className:"absolute -top-1 -left-1 bg-gray-100 text-gray-700 text-[8px] font-medium px-1.5 py-0.5 rounded-full z-10 border border-gray-300",children:l})]}),e.jsx("span",{className:"text-xs text-center text-gray-700 transition-colors line-clamp-2 font-inter",children:t.name}),s&&e.jsx("span",{className:"text-[9px] text-red-600 font-medium",children:"Sold Out"})]})},nr=({filteredPins:t,selectedPins:n,onSelect:s,onRemove:i,cart:o,selectedCategory:l})=>{const d=a=>{const r=a.category||l||"colorful",x=a.name||a.src||"",g=me({type:"charm",category:r,pin:a,name:x},o||[]);if(g===null)return!1;let p=0;(o||[]).forEach(u=>{if(u.type==="charm"){const b=u.pin||u,C=b.name||b.src,A=b.category||u.category||r;(C===x||C===a.src)&&A===r&&(p+=u.quantity||1)}});let k=0;(o||[]).forEach(u=>{u.pins&&Array.isArray(u.pins)&&u.pins.forEach(b=>{const C=b.name||b.src,A=b.category||r;(C===x||C===a.src)&&A===r&&(k+=u.quantity||1)})});const v=n.filter(u=>{const b=u.pin||u,C=b.name||b.src,A=b.category||r;return(C===x||C===a.src)&&A===r}).length,P=g+p,y=p+k+v;return g===0||y>=P};return e.jsx("div",{className:"max-h-80 sm:max-h-96 overflow-y-auto p-2",children:e.jsx("div",{className:"grid grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-2 sm:gap-2 justify-items-center md:max-w-3xl mx-auto",children:t.map((a,r)=>{const x=n.find(v=>v.pin===a),h=!!x,g=d(a),p=a.src?`${a.src}-${r}`:`${a.name}-${r}`,k=()=>{g||(h&&i&&x?i(x.imgInstance):s(a))};return e.jsx(sr,{pin:a,isSelected:h,isSoldOut:g,onClick:k},p)})})})},ar=({pins:t,selectedCategory:n,setSelectedCategory:s,selectedPins:i,onSelect:o,onRemove:l,onDropdownToggle:d,Products:a,cart:r})=>{const[x,h]=f.useState("all");f.useEffect(()=>{h("all")},[n]);const g=f.useMemo(()=>He(t,n,x),[t,n,x]),p=v=>{if(a&&a.pins){if(v==="bronze"&&a.pins.bronze&&a.pins.bronze.length>0)return a.pins.bronze[0].src;if(v==="colorful"&&a.pins.colorful&&a.pins.colorful.length>0)return a.pins.colorful[0].src;if(v==="flags"&&a.pins.flags&&a.pins.flags.length>0)return a.pins.flags[0].src}const P=Ge.find(y=>y.value===v);return P&&P.image?P.image:null},k=v=>He(t,n,v).length;return e.jsxs("div",{children:[e.jsx(tr,{selectedCategory:n,setSelectedCategory:s,onDropdownToggle:d,getPreviewImage:p}),n&&e.jsxs("div",{className:"mt-4 pb-4",children:[e.jsx(rr,{selectedCategory:n,subCategory:x,setSubCategory:h,getSubCategoryCount:k}),e.jsx(nr,{filteredPins:g,selectedPins:i,onSelect:o,onRemove:l,cart:r,selectedCategory:n})]})]})},or=({isOpen:t,onToggle:n,pins:s,selectedCategory:i,setSelectedCategory:o,selectedPins:l,onPinSelect:d,Products:a,cart:r})=>e.jsxs("div",{className:"pb-6 border-b border-gray-100 mt-6 hidden md:block",children:[e.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-gray-900 font-medium",style:{fontFamily:"'Poppins', sans-serif"},children:"3. Choose Charms"}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform duration-200 ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&e.jsx("div",{className:"relative z-10",children:e.jsx(ar,{pins:s,selectedCategory:i,setSelectedCategory:o,selectedPins:l,onSelect:d,Products:a,cart:r})})]}),lr=({customText:t,setCustomText:n,customTextError:s,setCustomTextError:i,customTextAdded:o,setCustomTextAdded:l,onTextAdded:d,onClose:a})=>{const r=()=>{if(!t.trim()){i("Please enter the text you want to add.");return}typeof window!="undefined"&&window.addTextToCanvas?(window.addTextToCanvas(t,{fill:Be,fontSize:Oe}),l(!0),i(""),d&&d(),a&&setTimeout(()=>{a()},1e3)):i("Canvas is still loading. Please try again in a moment.")},x=()=>{n(""),l(!1),i("")},h=g=>{const p=window.scrollY||window.pageYOffset,k=window.scrollX||window.pageXOffset;setTimeout(()=>{window.scrollTo({left:k,top:p,behavior:"instant"})},0),requestAnimationFrame(()=>{window.scrollTo({left:k,top:p,behavior:"instant"})})};return e.jsxs("div",{className:"space-y-4 ",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:t||"",onChange:g=>{n(g.target.value),i(""),l(!1)},onFocus:h,placeholder:"e.g. Your name",className:"w-full px-3 py-2 border border-gray-200  focus:outline-none focus:border-gray-400 bg-white text-gray-900 placeholder-gray-400 font-thin text-sm font-inter",maxLength:40}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500 font-inter",children:["Up to ",Ae," characters. Double-click the text on the case to edit or move it."]})]}),s&&e.jsx("div",{className:"text-sm text-gray-600 border border-gray-200 bg-gray-50 px-3 py-2",children:s}),o&&e.jsx("div",{className:"text-sm text-green-600 py-2",children:"Text added to your design! You can drag it to reposition it."}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("button",{onClick:r,disabled:!t.trim(),className:"flex-1 px-3 py-1.5 text-xs font-medium uppercase tracking-wider active:bg-blue-200 disabled:bg-gray-50 disabled:text-gray-400 disabled:cursor-not-allowed active:scale-95 disabled:scale-100 font-inter bg-btn-light-blue hover:bg-btn-light-blue-hover text-btn-light-blue-text border hover:border-btn-light-blue-hover transition-all duration-200",children:"Add Text"}),e.jsx("button",{onClick:x,disabled:!t.trim(),className:"px-3 py-1.5 text-xs font-medium uppercase tracking-wider active:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 disabled:border-gray-100 disabled:cursor-not-allowed active:scale-95 disabled:scale-100 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-1 font-inter bg-btn-light-gray hover:bg-btn-light-gray-hover text-btn-light-gray-text border border-btn-light-gray-border hover:border-btn-light-gray-hover transition-all duration-200",children:"Clear"})]})]})},ir=({isOpen:t,onToggle:n,customText:s,setCustomText:i,customTextError:o,setCustomTextError:l,customTextAdded:d,setCustomTextAdded:a})=>e.jsxs("div",{className:"pb-6 border-b border-gray-100 mt-6 hidden md:block",children:[e.jsxs("button",{onClick:n,className:"w-full flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-gray-900 font-medium",style:{fontFamily:"'Poppins', sans-serif"},children:"4. Add Text"}),e.jsx("svg",{className:`w-4 h-4 text-gray-500 transition-transform duration-200 ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),t&&e.jsx(lr,{customText:s,setCustomText:i,customTextError:o,setCustomTextError:l,customTextAdded:d,setCustomTextAdded:a})]}),cr=({mobileCurrentStep:t,setMobileCurrentStep:n,selectedCaseType:s,selectedColor:i,selectedCategory:o,setSelectedCategory:l,mobileSubCategory:d,setMobileSubCategory:a,pins:r,selectedPins:x,handleCaseTypeSelection:h,handleColorSelection:g,handlePinSelection:p,Products:k,cart:v})=>{var U,D;const[P,y]=f.useState(!1);if(!t)return null;const u=Et(r,o,d),C=o==="flags"?Qt:o==="colorful"?_t:o==="bronze"?Gt:[],A=((U=C.find(m=>m.key===d))==null?void 0:U.label)||"ALL";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 xs:p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:`bg-white rounded-sm p-3 xs:p-4 sm:p-5 md:p-6 lg:p-8 xl:p-10 w-full overflow-y-auto border border-gray-200 ${t==="charms"?"max-w-[calc(100vw-1rem)] xs:max-w-sm md:max-w-md lg:max-w-lg h-fit":t==="case"?"max-w-[calc(100vw-1rem)] xs:max-w-sm sm:max-w-md md:max-w-2xl lg:max-w-3xl xl:max-w-4xl max-h-[85vh] xs:max-h-[80vh] md:max-h-[75vh]":"max-w-[calc(100vw-1rem)] xs:max-w-sm md:max-w-md lg:max-w-lg max-h-[85vh] xs:max-h-[80vh] md:max-h-[75vh]"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 xs:mb-5 sm:mb-6 md:mb-8 border-b border-gray-100 pb-3 xs:pb-4 md:pb-5",children:[e.jsxs("h2",{className:"text-xs xs:text-sm md:text-base lg:text-lg uppercase tracking-wider text-gray-900 font-medium",style:{fontFamily:"'Poppins', sans-serif"},children:[t==="case"&&"Choose Case",t==="color"&&"Choose Color",t==="charms"&&"Choose Charms"]}),e.jsx("button",{onClick:()=>n(null),className:"p-0.5 xs:p-1 hover:bg-gray-50 transition-colors",children:e.jsx("svg",{className:"w-4 h-4 xs:w-5 xs:h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-3 xs:space-y-4 md:space-y-5",children:[t==="case"&&e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"grid grid-cols-3 gap-1.5 xs:gap-2 sm:gap-3 md:gap-5 lg:gap-6 xl:gap-8",children:Me.map(m=>{const W=()=>{if(k&&k.cases){const N=k.cases.find(z=>z.type===m.value);if(N&&N.colors&&N.colors.length>0)return N.colors[0].image}return m.image||null},Z=()=>{const N=k&&k.cases?k.cases.find(z=>z.type===m.value):null;return N&&N.colors&&N.colors.length>0?!N.colors.some(_=>{const S={caseType:m.value,color:_.color},w=me(S,v||[]);return w===null||w>0}):!1},Q=W(),Y=Z(),L=s===m.value;return e.jsxs("button",{onClick:()=>{Y||h(m.value)},disabled:Y,className:`p-0.5 xs:p-1 sm:p-2.5 md:p-4 lg:p-5 xl:p-6 text-center transition-all duration-200 flex flex-col items-center gap-0.5 xs:gap-1 sm:gap-2 md:gap-3 lg:gap-4 ${s===m.value?" text-gray-900":" hover:border-gray-300"} ${Y?"opacity-50 cursor-not-allowed":""}`,style:{fontFamily:"'Poppins', sans-serif"},children:[Q&&e.jsxs("div",{className:"relative w-full aspect-square overflow-hidden ",children:[e.jsx("img",{src:se(Q),alt:m.label,className:`w-full h-full object-contain p-0 xs:p-0.5 sm:p-1.5 md:p-3 lg:p-4 xl:p-5 ${Y?"opacity-50":""}`,loading:"lazy",onError:N=>{N.target.style.display="none"}}),L&&!Y&&e.jsx("div",{className:"absolute top-0.5 right-0.5 xs:top-1 xs:right-1 sm:top-1.5 sm:right-1.5 md:top-2 md:right-2 lg:top-3 lg:right-3 xl:top-4 xl:right-4 w-3 h-3 xs:w-4 xs:h-4 sm:w-5 sm:h-5 md:w-7 md:h-7 lg:w-8 lg:h-8 xl:w-10 xl:h-10 bg-gray-900 rounded-full flex items-center justify-center shadow-md",children:e.jsx("svg",{className:"w-2 h-2 xs:w-2.5 xs:h-2.5 sm:w-3 sm:h-3 md:w-4 md:h-4 lg:w-5 lg:h-5 xl:w-6 xl:h-6 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("span",{className:`text-xs xs:text-sm sm:text-base md:text-base lg:text-lg xl:text-xl font-medium mt-0.5 xs:mt-1 md:mt-2 ${Y?"text-gray-500":""}`,children:m.label}),Y&&e.jsx("span",{className:"text-[8px] xs:text-[9px] sm:text-[10px] md:text-xs text-red-600 font-medium mt-0.5 xs:mt-1",children:"Sold Out"})]},m.value)})})}),t==="color"&&s&&e.jsx("div",{children:e.jsx(Ve,{colors:((D=k.cases.find(m=>m.type===s))==null?void 0:D.colors)||[],selectedColor:i,onSelect:g,caseType:s,cart:v})}),t==="charms"&&s&&i&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 xs:mb-4",children:e.jsx("div",{className:"grid grid-cols-3 gap-1.5 xs:gap-2",children:Ge.map(m=>e.jsxs("button",{onClick:()=>l(m.value),className:"p-1.5 xs:p-2 text-[10px] xs:text-xs text-center transition-all duration-200 flex flex-col items-center gap-1.5 xs:gap-2 relative",style:{fontFamily:"'Poppins', sans-serif"},children:[m.image&&e.jsxs("div",{className:`w-16 h-16 xs:w-20 xs:h-20 flex-shrink-0 rounded flex items-center justify-center overflow-hidden relative ${o===m.value?"bg-gray-100":"bg-white"}`,children:[e.jsx("img",{src:se(m.image),alt:m.label,className:"w-full h-full object-contain"}),o===m.value&&e.jsx("div",{className:"absolute top-0 right-0 bg-gray-900 text-white w-4 h-4 xs:w-5 xs:h-5 flex items-center justify-center rounded-full shadow-md",children:e.jsx("svg",{className:"w-2.5 h-2.5 xs:w-3 xs:h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),e.jsx("span",{className:"font-medium text-xs xs:text-sm",children:m.label})]},m.value||"all"))})}),o&&C.length>0&&e.jsxs("div",{className:"mb-3 xs:mb-4 relative",children:[e.jsxs("button",{onClick:()=>y(!P),className:"w-full flex items-center justify-between px-3 xs:px-4 py-2 xs:py-2.5 bg-gray-100 border border-gray-300 text-left transition-all duration-200 hover:bg-gray-200 hover:border-gray-400",style:{fontFamily:"'Poppins', sans-serif"},children:[e.jsx("span",{className:"text-xs xs:text-sm font-medium text-gray-900 uppercase tracking-wider",children:A}),e.jsx("svg",{className:`w-4 h-4 xs:w-5 xs:h-5 text-gray-500 transition-transform duration-200 ${P?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M19 9l-7 7-7-7"})})]}),P&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>y(!1)}),e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 shadow-lg max-h-60 overflow-y-auto",children:C.map(({key:m,label:W})=>e.jsx("button",{onClick:()=>{a(m),y(!1)},className:`w-full text-left px-3 xs:px-4 py-2 xs:py-2.5 text-xs xs:text-sm uppercase tracking-wider transition-all duration-200 ${d===m?"bg-gray-100 text-gray-900 font-medium":"text-gray-700 hover:bg-gray-50"}`,style:{fontFamily:"'Poppins', sans-serif"},children:W},m))})]})]}),o&&e.jsx("div",{children:e.jsx("div",{className:"max-h-[60vh] xs:max-h-96 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-3 gap-2 xs:gap-2.5 sm:gap-3",children:u.map(m=>{const W=x.some(N=>N.pin===m),Q=(N=>N?N<=.3?"XS":N<=.45?"S":N<=.6?"M":N<=.75?"L":"XL":"")(m.size),L=(()=>{const N=m.category||o||"colorful",z=m.name||m.src||"",S=me({type:"charm",category:N,pin:m,name:z},v||[]);if(S===null)return!1;let w=0;(v||[]).forEach(E=>{if(E.type==="charm"){const T=E.pin||E,c=T.name||T.src,R=T.category||E.category||N;(c===z||c===m.src)&&R===N&&(w+=E.quantity||1)}});let O=0;(v||[]).forEach(E=>{E.pins&&Array.isArray(E.pins)&&E.pins.forEach(T=>{const c=T.name||T.src,R=T.category||N;(c===z||c===m.src)&&R===N&&(O+=E.quantity||1)})});const j=x.filter(E=>{const T=E.pin||E,c=T.name||T.src,R=T.category||N;return(c===z||c===m.src)&&R===N}).length,M=S+w,$=w+O+j;return S===0||$>=M})();return e.jsxs("button",{onClick:()=>!L&&p(m),disabled:L,className:`p-1.5 xs:p-2 transition-all duration-200 flex flex-col items-center ${L?"opacity-50 cursor-not-allowed":""}`,children:[e.jsxs("div",{className:`relative w-16 h-16 xs:w-20 xs:h-20 flex items-center justify-center transition-all duration-200 overflow-visible ${W?"rounded":""}`,children:[e.jsx("img",{src:se(m.src),alt:m.name,className:`max-w-full max-h-full object-contain ${L?"opacity-50":""}`}),W&&!L&&e.jsx("div",{className:"absolute top-0 right-0 bg-gray-900 text-white w-5 h-5 xs:w-6 xs:h-6 flex items-center justify-center text-[10px] xs:text-xs rounded-full shadow-md z-10",children:e.jsx("svg",{className:"w-3 h-3 xs:w-4 xs:h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),Q&&e.jsx("div",{className:"absolute top-0 left-0 bg-gray-100 text-gray-700 text-[8px] xs:text-[9px] font-medium px-1 xs:px-1.5 py-0.5 rounded-full z-10 border border-gray-300",children:Q})]}),e.jsx("span",{className:`text-xs xs:text-sm sm:text-base text-center line-clamp-2 mt-0.5 xs:mt-1 ${L?"text-gray-500":"text-gray-700"}`,style:{fontFamily:"'Poppins', sans-serif"},children:m.name}),L&&e.jsx("span",{className:"text-[8px] xs:text-[9px] text-red-600 font-medium mt-0.5",children:"Sold Out"})]},m.name)})})})})]})]})]})})},dr=({selectedCaseType:t,selectedColor:n,onCaseClick:s,onColorClick:i,onCharmsClick:o,onTextClick:l,isAddTextDropdownOpen:d})=>e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsxs("div",{className:"grid grid-cols-4 gap-1.5 xs:gap-2 sm:gap-2.5 max-w-fit",children:[e.jsxs("button",{onClick:s,className:"py-2.5 flex flex-col items-center justify-center gap-1 transition-all duration-200 touch-manipulation bg-btn-primary-blue text-btn-primary-blue-text border border-btn-primary-blue-border hover:bg-btn-primary-blue-hover px-3 xs:px-4",children:[e.jsx(Se,{icon:Mt,className:"w-4 h-4 text-btn-primary-blue-text"}),e.jsx("span",{className:"text-sm font-medium uppercase tracking-wide leading-tight text-btn-primary-blue-text",style:{fontFamily:"'Poppins', sans-serif"},children:"Case"})]}),e.jsxs("button",{onClick:i,disabled:!t,className:`py-2.5 flex flex-col items-center justify-center gap-1 transition-all duration-200 touch-manipulation px-3 xs:px-4 ${t?"bg-btn-primary-blue text-btn-primary-blue-text border border-btn-primary-blue-border hover:bg-btn-primary-blue-hover":"bg-gray-50 text-gray-400 border border-gray-200 cursor-not-allowed opacity-50"}`,children:[e.jsx(Se,{icon:Bt,className:`w-4 h-4 ${t?"text-btn-primary-blue-text":"text-gray-400"}`}),e.jsx("span",{className:`text-sm font-medium uppercase tracking-wide leading-tight ${t?"text-btn-primary-blue-text":"text-gray-400"}`,style:{fontFamily:"'Poppins', sans-serif"},children:"Color"})]}),e.jsxs("button",{onClick:o,disabled:!t||!n,className:`py-2.5 flex flex-col items-center justify-center gap-1 transition-all duration-200 touch-manipulation px-3 xs:px-4 ${!t||!n?"bg-gray-50 text-gray-400 border border-gray-200 cursor-not-allowed opacity-50":"bg-btn-primary-blue text-btn-primary-blue-text border border-btn-primary-blue-border hover:bg-btn-primary-blue-hover"}`,children:[e.jsx(Se,{icon:Ot,className:`w-4 h-4 ${!t||!n?"text-gray-400":"text-btn-primary-blue-text"}`}),e.jsx("span",{className:`text-sm font-medium uppercase tracking-wide leading-tight ${!t||!n?"text-gray-400":"text-btn-primary-blue-text"}`,style:{fontFamily:"'Poppins', sans-serif"},children:"Charms"})]}),e.jsxs("button",{onClick:l,className:"py-2.5 flex flex-col items-center justify-center gap-1 transition-all duration-200 touch-manipulation bg-btn-primary-blue text-btn-primary-blue-text border border-btn-primary-blue-border hover:bg-btn-primary-blue-hover px-3 xs:px-4",children:[e.jsx(Se,{icon:Rt,className:"w-4 h-4 text-btn-primary-blue-text"}),e.jsx("span",{className:"text-sm font-medium uppercase tracking-wide leading-tight text-btn-primary-blue-text",style:{fontFamily:"'Poppins', sans-serif"},children:"Text"})]})]})}),mr=({customText:t,setCustomText:n,customTextError:s,setCustomTextError:i,customTextAdded:o,setCustomTextAdded:l,onAddText:d})=>e.jsxs("div",{className:"px-2 xs:px-3 sm:px-4 space-y-2 pt-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t||"",onChange:a=>{n(a.target.value),i(""),l(!1)},onKeyDown:a=>{a.key==="Enter"&&t.trim()&&d()},placeholder:"e.g. Your name",className:"flex-1 px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:border-gray-400 bg-white text-gray-900 placeholder-gray-400 font-thin text-sm font-inter",style:{fontSize:"16px"},maxLength:Ae}),e.jsx("button",{onClick:d,disabled:!t.trim(),className:"px-4 py-2 text-xs font-medium uppercase tracking-wider disabled:bg-gray-50 disabled:text-gray-400 disabled:cursor-not-allowed disabled:border-gray-100 rounded-sm active:scale-95 disabled:scale-100 focus:outline-none font-inter bg-btn-light-blue hover:bg-btn-light-blue-hover text-btn-light-blue-text border border-btn-light-blue-border hover:border-btn-light-blue-hover transition-all duration-200",children:"Add"})]}),e.jsxs("p",{className:"text-xs text-gray-500 font-inter",children:["Up to ",Ae," characters. Double-click the text on the case to edit or move it."]}),s&&e.jsx("div",{className:"text-xs text-gray-600 border border-gray-200 bg-gray-50 px-3 py-2 rounded",children:s}),o&&e.jsx("div",{className:"text-xs text-green-700 bg-green-50 px-1 py-2",children:"Text added to your design! You can drag it to reposition it."})]}),qe=({totalPrice:t,caseBasePrice:n,groupedPinsList:s,showPriceBreakdown:i,quantity:o,setQuantity:l,onIncrementQuantity:d,onDecrementQuantity:a,selectedCase:r,selectedCaseType:x,selectedColor:h,selectedPins:g,selectedCaseImage:p,pinsPrice:k,onAddToCart:v,onShowTerms:P,agreedToTerms:y,setAgreedToTerms:u,showTermsError:b,inventoryMessage:C,inventoryType:A,isMobile:U=!1})=>{const{formatPrice:D}=Dt();return e.jsxs("div",{className:`${U?"pt-0 mt-0 bg-gray-100":"pt-14"} flex-shrink-0 relative z-0  ${U?"":"mt-auto flex flex-col justify-between"}`,children:[U?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex flex-row items-start justify-between mt-2 ",children:[e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex flex-row items-center gap-1.5 mb-1",children:[e.jsx("h3",{className:"text-[14px] xs:text-sm text-gray-400 font-light font-inter",children:"Total:"}),e.jsx("h3",{className:"text-md font-bold xs:text-base sm:text-lg text-gray-900  font-inter leading-none mb-1",children:D(t)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y||!1,onChange:m=>u(m.target.checked),className:"w-3.5 h-3.5 xs:w-4 xs:h-4 text-gray-900 border-gray-300 rounded"}),e.jsx("span",{className:"text-xs xs:text-sm text-gray-700 leading-tight font-light font-inter",children:e.jsx("button",{type:"button",onClick:P,className:"text-gray-900 underline hover:text-gray-700 transition-colors font-light",children:"Terms of Use"})})]}),b&&e.jsx("div",{className:"mt-1 text-xs xs:text-sm text-red-600 font-light font-inter",children:"You must accept the terms to add items to cart."})]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-sm py-2.5 xs:py-2 px-0.5 flex-shrink-0 gap-0",children:[e.jsx("button",{onClick:a||(()=>l(Math.max(0,o-1))),className:"w-6 h-6 xs:w-7 xs:h-7 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Decrease quantity",children:"−"}),e.jsx("div",{className:"px-1 xs:px-1.5 py-0.5 text-sm xs:text-base text-gray-900 font-light font-inter min-w-[1.5rem] xs:min-w-[2rem] text-center",children:Math.max(o,1)}),e.jsx("button",{onClick:d||(()=>l(o+1)),className:"w-6 h-6 xs:w-7 xs:h-7 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Increase quantity",children:"+"})]}),e.jsx("div",{className:"flex-1 min-w-0 ",children:e.jsx(Xe,{product:{id:`custom-${Date.now()}`,name:`${(r==null?void 0:r.name)||"Custom Case"} with ${g.length} charms`,caseType:x,caseName:(r==null?void 0:r.name)||"Custom Case",color:h,pins:g.map(({pin:m})=>m),pinsDetails:g.map(({pin:m})=>m),basePrice:n,casePrice:n,pinsPrice:k,totalPrice:parseFloat(t),price:parseFloat(t),image:p,caseImage:p,customDesign:!0,quantity:o},onAdd:v,className:"!w-full cursor-pointer bg-btn-success hover:bg-btn-success-hover text-btn-success-text border border-btn-success-border hover:border-btn-success-hover transition-all duration-200 py-2.5 px-8 text-sm font-light whitespace-nowrap",disabled:!1})})]})]}),C&&e.jsx("div",{className:`mt-1.5 text-xs xs:text-sm font-light font-inter ${A==="error"?"text-red-600":"text-orange-600"}`,children:C})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-end flex-row mb-4 gap-2",children:[e.jsx("h3",{className:"text-sm text-gray-400 font-light  ",children:"Total:"}),e.jsx("h3",{className:"text-md font-bold text-gray-900 font-inter ",children:D(t)})]}),e.jsxs("div",{className:"mb-4 ",children:[e.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y||!1,onChange:m=>u(m.target.checked),className:"mt-0.5 w-4 h-4 text-gray-900 border-gray-300 rounded "}),e.jsxs("span",{className:"text-sm text-gray-700 leading-relaxed font-light font-inter",children:["I agree to the"," ",e.jsx("button",{type:"button",onClick:P,className:"text-gray-900 underline hover:text-gray-700 transition-colors text-sm font-light",children:"Terms of Use"})," ","and understand that it is my responsibility to create the passport case design, and that as items are handmade, they may vary."]})]}),b&&e.jsx("div",{className:"mt-2 text-sm text-red-600 font-light font-inter",children:"You must accept the terms to add items to cart."})]}),e.jsxs("div",{className:"mt-auto flex flex-row gap-1.5 xs:gap-2 items-center",children:[e.jsxs("div",{className:"flex items-center border border-gray-200 rounded-sm py-2.5 px-1",children:[e.jsx("button",{onClick:a||(()=>l(Math.max(0,o-1))),className:"w-6 h-6 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Decrease quantity",children:"−"}),e.jsx("div",{className:"px-3 py-0 text-sm text-gray-900 font-light font-inter min-w-[2rem] text-center",children:Math.max(o,1)}),e.jsx("button",{onClick:d||(()=>l(o+1)),className:"w-6 h-6 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Increase quantity",children:"+"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(Xe,{product:{id:`custom-${Date.now()}`,name:`${(r==null?void 0:r.name)||"Custom Case"} with ${g.length} charms`,caseType:x,caseName:(r==null?void 0:r.name)||"Custom Case",color:h,pins:g.map(({pin:m})=>m),pinsDetails:g.map(({pin:m})=>m),basePrice:n,casePrice:n,pinsPrice:k,totalPrice:parseFloat(t),price:parseFloat(t),image:p,caseImage:p,customDesign:!0,quantity:o},onAdd:v,className:"cursor-pointer bg-btn-success hover:bg-btn-success-hover text-btn-success-text border border-btn-success-border hover:border-btn-success-hover transition-all duration-200 py-2.5 text-sm font-light",disabled:!1})})]}),C&&e.jsx("div",{className:`mt-4 text-sm font-light font-inter ${A==="error"?"text-red-600":"text-orange-600"}`,children:C})]}),i&&e.jsxs("div",{className:`space-y-1 ${U?"text-xs xs:text-sm mb-1 pt-1":"text-xs mb-4 pt-4"} text-gray-600 border-t border-gray-100`,children:[e.jsxs("div",{className:"flex justify-between font-light font-inter",children:[e.jsx("span",{children:"Case:"}),e.jsx("span",{className:"font-light font-inter",children:D(n)})]}),s.map((m,W)=>e.jsxs("div",{className:"flex justify-between font-light font-inter",children:[e.jsxs("span",{children:[m.name,m.count>1?` (x${m.count})`:"",":"]}),e.jsx("span",{className:"font-light font-inter",children:D(m.price*m.count)})]},W))]})]})},ur=({show:t,selectedCase:n,selectedColorData:s,caseImages:i,selectedModalImage:o,setSelectedModalImage:l,onClose:d})=>!t||!n||!i||i.length===0?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:d,children:e.jsxs("div",{className:"bg-white rounded-sm max-w-4xl w-full h-[90vh] overflow-hidden flex flex-col",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-gray-200 flex-shrink-0",children:[e.jsx("h3",{className:"text-xs sm:text-sm uppercase tracking-wider text-gray-900 font-medium font-inter",children:n.name}),e.jsx("button",{onClick:d,className:"p-2 hover:bg-gray-50 transition-colors","aria-label":"Close modal",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden p-4 sm:p-6 min-h-0",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center min-h-0 mb-4",children:e.jsxs("div",{className:"relative  p-4 sm:p-6 md:p-8 flex items-center justify-center w-full h-full",children:[e.jsx("img",{src:se(i[o]),alt:`${n.name} - View ${o+1}`,className:"max-w-full max-h-full object-contain",loading:"lazy",fetchPriority:"low",decoding:"async",onError:a=>{a.target.style.display="none",a.target.nextSibling&&(a.target.nextSibling.style.display="flex")}}),e.jsx("div",{className:"hidden w-full h-full items-center justify-center text-gray-400",children:e.jsx("p",{className:"text-gray-500 font-inter",children:"Image not available"})})]})}),i.length>1&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"grid grid-cols-6 sm:grid-cols-8 gap-1.5 sm:gap-2 mx-auto",children:i.map((a,r)=>e.jsxs("button",{onClick:()=>l(r),className:`aspect-square overflow-hidden border transition-all duration-200 ${o===r?"border-gray-900 ring-2 ring-gray-300":"border-gray-200 hover:border-gray-400"}`,children:[e.jsx("img",{src:se(a),alt:`${n.name} - Detail ${r+1}`,className:"w-full h-full object-contain p-1",loading:"lazy",fetchPriority:"low",decoding:"async",width:"80",height:"80",onError:x=>{x.target.style.display="none",x.target.nextSibling&&(x.target.nextSibling.style.display="flex")}}),e.jsx("div",{className:"hidden w-full h-full items-center justify-center text-gray-300",children:e.jsx("span",{className:"text-sm",children:"📷"})})]},r))})})]})]})}),xr=({show:t,onClose:n,selectedCase:s})=>{const[i,o]=f.useState(!0);if(!t||!s)return null;const l=s.specifications||{};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center  p-4",onClick:n,children:e.jsxs("div",{className:"bg-white rounded-sm max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 sm:p-6 border-b border-gray-200 flex-shrink-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-medium text-gray-900 font-inter",children:s.name}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-50 rounded-full transition-colors","aria-label":"Close modal",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:Object.keys(l).length>0&&e.jsxs("div",{className:"",children:[e.jsx("button",{onClick:()=>o(!i),className:"w-full flex items-center justify-between py-2 text-sm uppercase tracking-wider text-gray-900 font-medium hover:text-gray-700 transition-colors font-inter",children:e.jsx("span",{children:"Specifications"})}),i&&e.jsxs("div",{className:"flex flex-col gap-3 mt-4",children:[l.dimensions&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Dimensions"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.dimensions})]}),l.size&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Size"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.size})]}),l.weight&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Weight"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.weight})]}),l.material&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Material"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.material})]}),l.closure&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Closure"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.closure})]}),l.cardSlots&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Card Slots"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.cardSlots})]}),l.interior&&e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Interior"}),e.jsx("span",{className:"text-sm text-gray-900 text-right font-inter",children:l.interior})]}),l.rfid&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"RFID Protection"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.rfid})]}),l.features&&e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Features"}),e.jsx("span",{className:"text-sm text-gray-900 text-right font-inter",children:l.features})]}),l.passportCapacity&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Capacity"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.passportCapacity})]}),l.care&&e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-gray-50",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Care Instructions"}),e.jsx("span",{className:"text-sm text-gray-900 text-right font-inter",children:l.care})]}),l.warranty&&e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-gray-500 font-inter",children:"Warranty"}),e.jsx("span",{className:"text-sm text-gray-900 font-inter",children:l.warranty})]})]})]})})]})})},hr=({show:t,onClose:n,onAgree:s})=>t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:n,children:e.jsxs("div",{className:"bg-white rounded-sm max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-gray-200 shadow-lg",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 font-inter",children:"Terms of Use - Create Yours"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-50 transition-colors rounded","aria-label":"Close modal",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3 font-inter",children:"User Responsibility"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed font-inter",children:"It is the user's responsibility to create and design the passport case using our interactive creator. Please ensure that your design meets your requirements and preferences before placing your order. We are not responsible for any design choices made by the user through the creator tool."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-semibold text-gray-900 mb-3 font-inter",children:"Handmade Items - Natural Variations"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed font-inter",children:"All our passport cases are handmade with care and attention to detail. As each item is individually crafted, there may be natural variations in color, texture, and appearance. These variations are not defects but rather characteristics of handmade products that make each piece unique. Please note that the final product may vary slightly from the digital preview shown in the creator."})]}),e.jsx("div",{className:"bg-gray-50 border-l-4 border-gray-400 p-4 rounded",children:e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed font-inter",children:'By using our "Create Yours" tool and placing an order, you acknowledge that you have read, understood, and agree to these terms of use.'})})]}),e.jsxs("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200",children:[e.jsx("button",{onClick:n,className:"px-6 py-2 text-sm uppercase tracking-wider font-inter bg-btn-secondary hover:bg-btn-secondary-hover text-btn-secondary-text border border-btn-secondary-border hover:border-btn-secondary-hover transition-all duration-200",children:"Close"}),e.jsx("button",{onClick:()=>{s?s():n()},className:"px-6 py-2 text-sm uppercase tracking-wider font-inter bg-btn-primary hover:bg-btn-primary-hover text-btn-primary-text border border-btn-primary-border hover:border-btn-primary-hover transition-all duration-200",children:"I Agree"})]})]})}):null,fr=({show:t,onClose:n,customText:s,setCustomText:i,customTextError:o,setCustomTextError:l,customTextAdded:d,setCustomTextAdded:a})=>{if(f.useEffect(()=>{if(t){const h=window.scrollY||window.pageYOffset,g=window.scrollX||window.pageXOffset,p=document.body.style.overflow,k=document.body.style.position,v=document.body.style.top,P=document.body.style.width,y=document.body.style.left,u=document.documentElement.style.overflow;return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.top=`-${h}px`,document.body.style.width="100%",document.body.style.left=`-${g}px`,document.documentElement.style.overflow="hidden",()=>{document.body.style.overflow=p,document.body.style.position=k,document.body.style.top=v,document.body.style.width=P,document.body.style.left=y,document.documentElement.style.overflow=u,requestAnimationFrame(()=>{window.scrollTo(g,h)})}}},[t]),!t)return null;const r=()=>{if(!s.trim()){l("Please enter the text you want to add.");return}typeof window!="undefined"&&window.addTextToCanvas?(window.addTextToCanvas(s,{fill:Be,fontSize:Oe}),a(!0),l(""),setTimeout(()=>{n()},500)):l("Canvas is still loading. Please try again in a moment.")},x=()=>{i(""),a(!1),l("")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-2 xs:p-3 sm:p-4 md:p-6",onClick:n,children:e.jsxs("div",{className:"bg-white  max-w-md w-full border border-gray-200 shadow-lg",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-3 xs:p-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-xs xs:text-sm font-medium text-gray-900 uppercase tracking-wider",style:{fontFamily:"'Poppins', sans-serif"},children:"Add Text"}),e.jsx("button",{onClick:n,className:"p-1 xs:p-2 hover:bg-gray-50 transition-colors ","aria-label":"Close modal",children:e.jsx("svg",{className:"w-4 h-4 xs:w-5 xs:h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-3 xs:p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("input",{type:"text",value:s||"",onChange:h=>{i(h.target.value),l(""),a(!1)},onFocus:h=>{h.preventDefault(),setTimeout(()=>{h.target.scrollIntoView({behavior:"smooth",block:"center"})},100)},placeholder:"e.g. Your name",className:"w-full px-3 py-2 border border-gray-200 focus:outline-none focus:border-gray-400 bg-white text-gray-900 placeholder-gray-400 font-thin text-sm font-inter",style:{fontSize:"16px"},maxLength:40}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500 font-inter",children:["Up to ",Ae," characters. Double-click the text on the case to edit or move it."]})]}),o&&e.jsx("div",{className:"text-sm text-gray-600 border border-gray-200 bg-gray-50 px-3 py-2 font-inter",children:o}),d&&e.jsx("div",{className:"text-sm text-gray-600  px-3 py-2 font-inter",children:"Text added to your design! You can drag it to reposition it."}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx("button",{onClick:r,disabled:!s.trim(),className:"flex-1 px-3 py-1.5 text-xs font-medium uppercase tracking-wider active:bg-blue-200 disabled:bg-gray-50 disabled:text-gray-400 disabled:cursor-not-allowed  active:scale-95 disabled:scale-100 focus:outline-none focus:ring-2 focus:ring-blue-300 focus:ring-offset-1 font-inter bg-btn-light-blue hover:bg-btn-light-blue-hover text-btn-light-blue-text border border-btn-light-blue-border hover:border-btn-light-blue-hover transition-all duration-200",children:"Add Text"}),e.jsx("button",{onClick:x,disabled:!s.trim(),className:"px-3 py-1.5 text-xs font-medium uppercase tracking-wider active:bg-gray-200 disabled:bg-gray-50 disabled:text-gray-400 disabled:border-gray-100 disabled:cursor-not-allowed active:scale-95 disabled:scale-100 focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-offset-1 font-inter bg-btn-light-gray hover:bg-btn-light-gray-hover text-btn-light-gray-text border border-btn-light-gray-border hover:border-btn-light-gray-hover transition-all duration-200",children:"Clear"})]})]})]})})},gr=t=>{if(!t)return"";let s=t.split("/").pop().replace(".webp","").replace(".png","").replace(".jpg","").toLowerCase().replace(/^economycase/i,"").replace(/^businessclasscase/i,"").replace(/^firstclasscase/i,"").replace(/^smartcase/i,"").replace(/^premiumcase/i,"").replace(/^firstclass/i,"");const i={lightpink:"Light Pink",lightblue:"Light Blue",lightbrown:"Light Brown",darkbrown:"Dark Brown",darkblue:"Dark Blue",jeansblue:"Jeans Blue",brickred:"Brick Red",ligthpink:"Light Pink",navyblue:"Navy Blue",gray:"Gray",grey:"Gray",black:"Black",brown:"Brown",red:"Red",pink:"Pink",blue:"Blue",green:"Green",purple:"Purple",yellow:"Yellow",orange:"Orange"};return i[s]?i[s]:(s=s.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/(dark|light|navy|jeans|brick)([a-z]+)/g,"$1 $2").split(/(?=[A-Z])|(?=dark|light|navy|jeans|brick)/).filter(o=>o.length>0).join(" ").toLowerCase().split(" ").map(o=>i[o]?i[o]:o.charAt(0).toUpperCase()+o.slice(1)).join(" "),s||"Color")},pr=t=>{const n=t==null?void 0:t.get("case"),s=t==null?void 0:t.get("color"),i="economy";let o="",l="";if(n){const a=oe.cases.find(r=>r.type===n);if(a){if(s){const r=a.colors.find(x=>x.color===s);if(r)return{caseType:a.type,color:r.color,image:r.image}}if(a.colors&&a.colors.length>0){const r=a.colors[0];return{caseType:a.type,color:r.color,image:r.image}}}}const d=oe.cases.find(a=>a.type===i);if(d&&d.colors&&d.colors.length>0){const a=d.colors[0];return{caseType:i,color:a.color,image:a.image}}return{caseType:i,color:o,image:l}},yr=t=>t.reduce((n,{pin:s})=>n+((s==null?void 0:s.price)||0),0),br=(t,n,s)=>{const i=Math.max(s,1);return((t+n)*i).toFixed(2)},wr=t=>{const n=t.reduce((s,{pin:i})=>{if(!i)return s;const o=`${i.src}|${i.name}|${i.price}`;return s[o]||(s[o]=Ce(we({},i),{count:0})),s[o].count+=1,s},{});return Object.values(n)},vr=(t,n)=>{var l;const s=(t==null?void 0:t.image)||((l=n==null?void 0:n.images)==null?void 0:l[0])||"",i=[];s&&i.push(se(s));let o=[];return(n==null?void 0:n.type)==="economy"?o=["/images/SmartCase/economycaseinside.webp","/images/SmartCase/economycaseclosure.webp","/images/SmartCase/economycaseclosureinside.webp"]:(n==null?void 0:n.type)==="business"?o=["/images/BusinessClassCase/businessclass.webp","/images/BusinessClassCase/businessclass1.webp"]:(n==null?void 0:n.type)==="firstclass"&&(o=["/images/FirstClassCase/firstclass.webp","/images/FirstClassCase/firstclass1.webp","/images/FirstClassCase/firstclass2.webp"]),o.forEach(d=>{d&&i.push(se(d))}),i.length>0?i:s?[se(s)]:[]},jr=({selectedCaseType:t,selectedColor:n,selectedPins:s,quantity:i,cart:o,selectedCategory:l,selectedCase:d})=>{const[a,r]=f.useState(""),[x,h]=f.useState("warning"),[g,p]=f.useState(""),[k,v]=f.useState("");return f.useEffect(()=>{if(a){const y=setTimeout(()=>{r("")},3e3);return()=>clearTimeout(y)}},[a]),f.useEffect(()=>{if(t&&n){const u=me({caseType:t,color:n},o);u!==null&&u>0&&r("")}if(s.length>0){let y=null;for(const{pin:u}of s){if(!u)continue;const b=(u==null?void 0:u.category)||l||"colorful",C=(u==null?void 0:u.name)||"charm",A=(u==null?void 0:u.src)||"",D=me({type:"charm",category:b,pin:u,name:C},o);if(D===null)continue;let m=0;o.forEach(L=>{if(L.type==="charm"){const N=L.pin||L,z=N.name||N.src,_=N.category||L.category||b;(z===C||z===A)&&_===b&&(m+=L.quantity||1)}});let W=0;o.forEach(L=>{L.pins&&Array.isArray(L.pins)&&L.pins.forEach(N=>{const z=N.name||N.src,_=N.category||b;(z===C||z===A)&&_===b&&(W+=L.quantity||1)})});const Z=s.filter(L=>{const N=L.pin||L,z=N.name||N.src,_=N.category||b;return(z===C||z===A)&&_===b}).length,Q=D+m,Y=m+W+Z*i;if(D===0||Y>Q){y=C;break}}y?(r(`Oops! We don't have any more ${y} in stock right now.`),h("warning")):r(u=>u&&u.includes("can't add more to your basket")?u:u&&!u.includes("Passport Case")&&!u.includes("Case")?"":u)}else r(y=>y&&y.includes("can't add more to your basket")?y:y&&!y.includes("Passport Case")&&!y.includes("Case")?"":y)},[t,n,s,i,o,l]),{inventoryMessage:a,inventoryType:x,quantityError:g,charmInventoryError:k,setInventoryMessage:r,setInventoryType:h,setQuantityError:p,setCharmInventoryError:v,checkQuantityIncrement:y=>{var C;const b=me({caseType:t,color:n},o);if(b!==null&&(b<=0||y+1>b)){const A=(d==null?void 0:d.name)||"Passport Case",U=(C=d==null?void 0:d.colors)==null?void 0:C.find(Z=>Z.color===n),D=U!=null&&U.image?gr(U.image):"",m=D?` in ${D}`:"",W=`Oops! We don't have any more ${A}${m} in stock right now, so you can't add more to your basket.`;return p(`We don't have any more ${A}${m} in stock to be added anymore.`),r(W),h("error"),!1}if(s.length>0)for(const{pin:A}of s){if(!A)continue;const D=A.category?A.category:l||"colorful",m=A.name||A.src||"",W=A.src||"",Z={name:m,price:A.price||2,totalPrice:A.price||2,pin:A,category:D,type:"charm"},Q=me(Z,o);if(Q===null)continue;let Y=0;o.forEach(w=>{if(w.type==="charm"){const O=w.pin||w,j=O.name||O.src,M=O.category||w.category||D;(j===m||j===W)&&M===D&&(Y+=w.quantity||1)}});let L=0;o.forEach(w=>{w.pins&&Array.isArray(w.pins)&&w.pins.forEach(O=>{const j=O.name||O.src,M=O.category||D;(j===m||j===W)&&M===D&&(L+=w.quantity||1)})});const N=s.filter(w=>{const O=w.pin||w,j=O.name||O.src,M=O.category||D;return(j===m||j===W)&&M===D}).length,z=Q+Y,S=Y+L+N*y+N;if(Q===0||S>z){const w=`Oops! We don't have any more ${A.name||"this charm"} in stock right now, so you can't add more to your basket.`;return v(w),r(w),h("error"),!1}}return!0}}},Nr=(t,n,s,i)=>{const l=t.category?t.category:i||"colorful",d=t.name||t.src||"",a=t.src||"",r=Ce(we({},t),{category:l}),x={name:d,price:t.price||2,totalPrice:t.price||2,pin:r,category:l,type:"charm"},h=me(x,n);if(h===null)return{canAdd:!0,errorMessage:"",pinWithCategory:r};let g=0;n.forEach(y=>{if(y.type==="charm"){const u=y.pin||y,b=u.name||u.src,C=u.category||y.category||l;(b===d||b===a)&&C===l&&(g+=y.quantity||1)}});let p=0;n.forEach(y=>{y.pins&&Array.isArray(y.pins)&&y.pins.forEach(u=>{const b=u.name||u.src,C=u.category||l;(b===d||b===a)&&C===l&&(p+=y.quantity||1)})});const k=s.filter(y=>{const u=y.pin||y,b=u.name||u.src,C=u.category||l;return(b===d||b===a)&&C===l}).length,v=h+g,P=g+p+k+1;return h===0||P>v?{canAdd:!1,errorMessage:`Oops! We don't have any more ${t.name||t.src||"this charm"} in stock right now, so you can't add more to your basket.`,pinWithCategory:r}:{canAdd:!0,errorMessage:"",pinWithCategory:r}},Qe=(t,n={})=>{setTimeout(()=>{const s=document.querySelector(t);s&&s.scrollIntoView(we({behavior:"smooth",block:"center"},n))},100)},kr=()=>{var Ie;const t=yt(),[n]=bt(),s=wt(),{addToCart:i,cart:o}=It(),[l,d]=f.useState(""),[a,r]=f.useState([]),[x,h]=f.useState("all"),g=pr(n),[p,k]=f.useState(g.caseType),[v,P]=f.useState(g.color),[y,u]=f.useState(g.image),[b,C]=f.useState([]),[A,U]=f.useState(!1),[D,m]=f.useState(!1),[W,Z]=f.useState(!1),[Q,Y]=f.useState(!1),[L,N]=f.useState(window.innerWidth<768),[z,_]=f.useState(null),[S,w]=f.useState(0),[O,j]=f.useState(""),[M,$]=f.useState(""),[E,T]=f.useState(!1),[c,R]=f.useState(!1),[X,re]=f.useState(0),[ae,H]=f.useState(!1),[G,I]=f.useState(!1),[V,ee]=f.useState(!1),[K,le]=f.useState(!1),[he,ne]=f.useState(!1),[fe,ie]=f.useState(!1),pe=f.useRef(null),ye=Ue(),J=ye.cases.find(B=>B.type===p),{inventoryMessage:ve,inventoryType:je,quantityError:Ne,charmInventoryError:Te,setInventoryMessage:ce,setInventoryType:ge,setQuantityError:ke,setCharmInventoryError:de,checkQuantityIncrement:Le}=jr({selectedCaseType:p,selectedColor:v,selectedPins:b,quantity:S,cart:o,selectedCategory:l,selectedCase:J});f.useEffect(()=>{window.scrollTo({top:0,behavior:"instant"})},[t.pathname]),f.useEffect(()=>{const B=n.get("case"),F=n.get("color");if(B){const q=oe.cases.find(te=>te.type===B);if(q){if(k(q.type),F){const te=q.colors.find(xe=>xe.color===F);if(te){P(te.color),u(te.image);return}}if(q.colors&&q.colors.length>0){const te=q.colors[0];P(te.color),u(te.image)}}}},[n]);const ue=B=>{k(B);const q=Ue().cases.find(te=>te.type===B);if(q&&q.colors.length>0){const te=q.colors.find(xe=>xe.quantity===void 0||xe.quantity>0)||q.colors[0];P(te.color),u(te.image)}L&&_(null)},Ze=(B,F)=>{P(B),u(F),L&&_(null)},Ke=f.useCallback(B=>{const{canAdd:F,errorMessage:q,pinWithCategory:te}=Nr(B,o,b,l);if(!F){ce(q),ge("error"),de(q.replace("Oops! We don't have any more ","").replace(" in stock right now, so you can't add more to your basket.","")),L?(_(null),setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},300)):Qe('[class*="PriceSummary"]',{block:"center"});return}window.addPinToCanvas&&window.addPinToCanvas(te),de(""),L?(_(null),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)):Qe(".happy-card",{block:"center"})},[L,o,b,l,de,ce,ge]);f.useEffect(()=>{var B;if((B=t.state)!=null&&B.selectedPin){const F=t.state.selectedPin,q=Ce(we({},F),{category:F.category||l||"colorful"});setTimeout(()=>{window.addPinToCanvas&&window.addPinToCanvas(q)},1e3),window.history.replaceState({},document.title)}},[t.state,l]),f.useEffect(()=>{l&&r(l==="flags"?oe.pins.flags||[]:oe.pins[l]||[]),h("all")},[l]),f.useEffect(()=>{if(oe.cases.length>0){const B=oe.cases.find(F=>F.type===p)||oe.cases[0];if(B&&B.colors.length>0){const F=B.colors[0];P(F.color),u(F.image)}}},[p]);const Je=()=>{Le(S)&&(w(S+1),ke(""),de(""),ce(""))},et=()=>{S>0&&(w(S-1),ke(""),de(""),ce(""))},tt=()=>{if(!O.trim()){$("Please enter the text you want to add.");return}typeof window!="undefined"&&window.addTextToCanvas?(window.addTextToCanvas(O.trim(),{fill:Be,fontSize:Oe}),T(!0),$(""),setTimeout(()=>{Y(!1)},500)):$("Canvas is still loading. Please try again in a moment.")},Pe=(J==null?void 0:J.basePrice)||0,be=(Ie=J==null?void 0:J.colors)==null?void 0:Ie.find(B=>B.color===v),rt=vr(be,J),Re=yr(b),st=br(Pe,Re,S),nt=wr(b),at=()=>{if(!V){ne(!0),le(!0);return}ne(!1),De()},De=()=>Ee(void 0,null,function*(){var Fe;const B=Math.max(S,1),F=Nt(p,v,o,B,J);if(!F.valid){ce(F.errorMessage),ge("error"),F.maxAvailable!==void 0&&w(F.maxAvailable>0?F.maxAvailable:0);return}const q=kt(b,o,B,l);if(!q.valid){ce(q.errorMessage),ge("error");return}const xe=y||(be==null?void 0:be.image)||((Fe=J==null?void 0:J.images)==null?void 0:Fe[0])||"",ze=xe?se(xe):"";let $e=null;window.getDesignImageDataURL&&($e=window.getDesignImageDataURL());const it=yield Ct(ze,$e),ct=St(b,l),{caseProduct:dt,charmProducts:mt}=At({selectedCase:J,selectedCaseType:p,selectedColor:v,selectedCaseImage:y,selectedPins:b,caseBasePrice:Pe,quantity:B,designImage:it,normalizedCaseImage:ze,pinsDetails:ct,selectedCategory:l});i(dt),mt.forEach(ut=>{i(ut)}),window.clearCanvas&&window.clearCanvas(),C([]),w(0)}),ot=f.useCallback(B=>{B&&B.pinData&&C(F=>[...F,{imgInstance:B,pin:B.pinData}])},[]),lt=f.useCallback(B=>{C(F=>F.filter(q=>q.imgInstance!==B)),de("")},[de]);return f.useEffect(()=>{const B=()=>{N(window.innerWidth<768)};return window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]),f.useEffect(()=>{L&&z!==null&&Y(!1)},[z,L]),f.useEffect(()=>{const B=F=>{pe.current&&!pe.current.contains(F.target)&&m(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]),{selectedCategory:l,setSelectedCategory:d,pins:a,mobileSubCategory:x,setMobileSubCategory:h,selectedCaseType:p,selectedColor:v,selectedCaseImage:y,selectedPins:b,showPriceBreakdown:A,setShowPriceBreakdown:U,isCaseDropdownOpen:D,setIsCaseDropdownOpen:m,isCharmsDropdownOpen:W,setIsCharmsDropdownOpen:Z,isAddTextDropdownOpen:Q,setIsAddTextDropdownOpen:Y,isMobile:L,mobileCurrentStep:z,setMobileCurrentStep:_,quantity:S,setQuantity:w,customText:O,setCustomText:j,customTextError:M,setCustomTextError:$,customTextAdded:E,setCustomTextAdded:T,showImageModal:c,setShowImageModal:R,selectedModalImage:X,setSelectedModalImage:re,showDescriptionModal:ae,setShowDescriptionModal:H,showTermsModal:G,setShowTermsModal:I,agreedToTerms:V,setAgreedToTerms:ee,pendingAddToCart:K,setPendingAddToCart:le,showTermsError:he,setShowTermsError:ne,showAddTextModal:fe,setShowAddTextModal:ie,productsWithQuantities:ye,selectedCase:J,caseBasePrice:Pe,selectedColorData:be,caseImages:rt,pinsPrice:Re,totalPrice:st,groupedPinsList:nt,cart:o,inventoryMessage:ve,inventoryType:je,quantityError:Ne,charmInventoryError:Te,handleCaseTypeSelection:ue,handleColorSelection:Ze,handlePinSelection:Ke,handleIncrementQuantity:Je,handleDecrementQuantity:et,handleMobileAddText:tt,handleAddToCart:at,executeAddToCart:De,handlePinSelect:ot,handlePinRemove:lt,navigate:s}},Or=()=>{const{selectedCategory:t,setSelectedCategory:n,pins:s,mobileSubCategory:i,setMobileSubCategory:o,selectedCaseType:l,selectedColor:d,selectedCaseImage:a,selectedPins:r,showPriceBreakdown:x,setShowPriceBreakdown:h,isCaseDropdownOpen:g,setIsCaseDropdownOpen:p,isCharmsDropdownOpen:k,setIsCharmsDropdownOpen:v,isAddTextDropdownOpen:P,setIsAddTextDropdownOpen:y,isMobile:u,mobileCurrentStep:b,setMobileCurrentStep:C,quantity:A,setQuantity:U,customText:D,setCustomText:m,customTextError:W,setCustomTextError:Z,customTextAdded:Q,setCustomTextAdded:Y,showImageModal:L,setShowImageModal:N,selectedModalImage:z,setSelectedModalImage:_,showDescriptionModal:S,setShowDescriptionModal:w,showTermsModal:O,setShowTermsModal:j,agreedToTerms:M,setAgreedToTerms:$,pendingAddToCart:E,setPendingAddToCart:T,showTermsError:c,setShowTermsError:R,showAddTextModal:X,setShowAddTextModal:re,productsWithQuantities:ae,selectedCase:H,caseBasePrice:G,selectedColorData:I,caseImages:V,pinsPrice:ee,totalPrice:K,groupedPinsList:le,cart:he,inventoryMessage:ne,inventoryType:fe,quantityError:ie,charmInventoryError:pe,handleCaseTypeSelection:ye,handleColorSelection:J,handlePinSelection:ve,handleIncrementQuantity:je,handleDecrementQuantity:Ne,handleMobileAddText:Te,handleAddToCart:ce,executeAddToCart:ge,handlePinSelect:ke,handlePinRemove:de,navigate:Le}=kr();return e.jsx("section",{className:`w-full pt-4 pb-1 md:pb-8 bg-white ${u?"h-screen fixed inset-0 overflow-hidden":"min-h-screen"}`,children:e.jsxs("div",{className:`max-w-7xl mx-auto px-2 xs:px-3 sm:px-4 md:px-8 relative z-10 ${u?"pb-40 xs:pb-44 sm:pb-48 h-full flex flex-col overflow-hidden":"pb-2 sm:pb-24 flex flex-col"}`,children:[u&&e.jsx($t,{onClose:()=>Le("/")}),e.jsx(zt,{}),e.jsxs("div",{className:`flex flex-col ${u?"":"md:flex-row md:gap-8 lg:gap-12"} flex-1 overflow-hidden mt-0 ${u?"":"md:mt-12"}`,children:[e.jsx(qt,{selectedCaseType:l,selectedColor:d,selectedCaseImage:a,selectedCase:H,caseImages:V,isCaseDropdownOpen:g,isCharmsDropdownOpen:k,isAddTextDropdownOpen:P,isMobile:u,onPinSelect:ke,onPinRemove:de,onOpenImageModal:()=>{N(!0),_(0)},onOpenDescriptionModal:()=>w(!0),Products:oe}),e.jsx("div",{className:`flex flex-col ${u?"":"md:w-1/2 md:flex-1"} gap-2 xs:gap-3 sm:gap-4 overflow-hidden`,children:e.jsxs("div",{className:`w-full flex flex-col space-y-4 sm:space-y-6 hide-scrollbar ${g||k||P?"md:max-h-none md:overflow-visible":"md:max-h-[calc(100vh-200px)] md:overflow-y-auto"}`,style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[u&&e.jsx(cr,{mobileCurrentStep:b,setMobileCurrentStep:C,selectedCaseType:l,selectedColor:d,selectedCategory:t,setSelectedCategory:n,mobileSubCategory:i,setMobileSubCategory:o,pins:s,selectedPins:r,handleCaseTypeSelection:ye,handleColorSelection:J,handlePinSelection:ve,Products:ae,cart:he}),e.jsx(Kt,{isOpen:g,onToggle:()=>{v(!1),y(!1),p(!g)},selectedCaseType:l,selectedColor:d,selectedCase:H,onCaseSelect:ye,onColorSelect:J,setIsCaseDropdownOpen:p,Products:oe,cart:he}),e.jsx(or,{isOpen:k,onToggle:()=>{p(!1),y(!1),v(!k)},pins:s,selectedCategory:t,setSelectedCategory:n,selectedPins:r,onPinSelect:ve,Products:oe,cart:he}),e.jsx(ir,{isOpen:P,onToggle:()=>{p(!1),v(!1),y(!P)},customText:D,setCustomText:m,customTextError:W,setCustomTextError:Z,customTextAdded:Q,setCustomTextAdded:Y}),!u&&e.jsx(qe,{totalPrice:K,caseBasePrice:G,groupedPinsList:le,showPriceBreakdown:x,setShowPriceBreakdown:h,quantity:A,setQuantity:U,onIncrementQuantity:je,onDecrementQuantity:Ne,quantityError:ie,charmInventoryError:pe,selectedCase:H,selectedCaseType:l,selectedColor:d,selectedPins:r,selectedCaseImage:a,pinsPrice:ee,onAddToCart:ce,onShowTerms:()=>j(!0),inventoryMessage:ne,inventoryType:fe,agreedToTerms:M,setAgreedToTerms:ue=>{$(ue),ue&&R(!1)},showTermsError:c})]})})]}),u&&e.jsx("div",{className:"fixed left-0 right-0 z-0 bg-white md:hidden w-full",style:{bottom:"calc(80px + 0.75rem)"},children:e.jsxs("div",{className:"px-2 xs:px-3 sm:px-4 py-2 xs:py-2.5 sm:py-3 mb-0 pb-0",children:[e.jsx("p",{className:"text-[14px] text-gray-700 mb-2 xs:mb-2.5 text-center font-thin",style:{fontFamily:"'Poppins', sans-serif"},children:"Choose the options below:"}),e.jsx(dr,{selectedCaseType:l,selectedColor:d,onCaseClick:()=>C("case"),onColorClick:()=>C("color"),onCharmsClick:()=>{C("charms"),window.scrollTo({top:0,behavior:"smooth"})},onTextClick:()=>{p(!1),v(!1),y(!P)},isAddTextDropdownOpen:P}),P&&e.jsx(mr,{customText:D,setCustomText:m,customTextError:W,setCustomTextError:Z,customTextAdded:Q,setCustomTextAdded:Y,onAddText:Te})]})}),u&&e.jsx("div",{className:"fixed left-0 right-0 z-40 bg-gray-100 border-t border-gray-200 shadow-lg md:hidden max-h-[50vh] xs:max-h-[45vh] overflow-y-auto w-full safe-area-inset-bottom",style:{bottom:"0",paddingBottom:"calc(env(safe-area-inset-bottom) + 0.75rem)"},children:e.jsx("div",{className:"px-2 xs:px-2.5 sm:px-3 py-1.5 xs:py-2 sm:py-2.5 ",children:e.jsx(qe,{totalPrice:K,caseBasePrice:G,groupedPinsList:le,showPriceBreakdown:x,setShowPriceBreakdown:h,quantity:A,setQuantity:U,onIncrementQuantity:je,onDecrementQuantity:Ne,quantityError:ie,charmInventoryError:pe,selectedCase:H,selectedCaseType:l,selectedColor:d,selectedPins:r,selectedCaseImage:a,pinsPrice:ee,onAddToCart:ce,onShowTerms:()=>j(!0),agreedToTerms:M,setAgreedToTerms:ue=>{$(ue),ue&&R(!1)},showTermsError:c,inventoryMessage:ne,inventoryType:fe,isMobile:!0})})}),e.jsx(ur,{show:L,selectedCase:H,selectedColorData:I,caseImages:V,selectedModalImage:z,setSelectedModalImage:_,onClose:()=>N(!1)}),e.jsx(xr,{show:S,onClose:()=>w(!1),selectedCase:H}),e.jsx(hr,{show:O,onClose:()=>{j(!1),T(!1)},onAgree:()=>{$(!0),R(!1),j(!1),E&&(T(!1),ge())}}),u&&e.jsx(fr,{show:X,onClose:()=>re(!1),customText:D,setCustomText:m,customTextError:W,setCustomTextError:Z,customTextAdded:Q,setCustomTextAdded:Y})]})})};export{Or as default};
