module.exports=[34287,a=>{"use strict";let b=("u">typeof process?process.env?.NEXT_PUBLIC_API_URL||process.env?.VITE_API_URL:"")||"";a.s(["getApiUrl",0,a=>{let c=a.startsWith("/")?a:`/${a}`;return("u"<typeof process,b)?`${b}${c}`:c}])},53851,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},40460,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DEFAULT_SEGMENT_KEY:function(){return l},NOT_FOUND_SEGMENT_KEY:function(){return m},PAGE_SEGMENT_KEY:function(){return k},addSearchParamsIfPageSegment:function(){return i},computeSelectedLayoutSegment:function(){return j},getSegmentValue:function(){return f},getSelectedLayoutSegmentPath:function(){return function a(b,c,d=!0,e=[]){let g;if(d)g=b[1][c];else{let a=b[1];g=a.children??Object.values(a)[0]}if(!g)return e;let h=f(g[0]);return!h||h.startsWith(k)?e:(e.push(h),a(g,c,!1,e))}},isGroupSegment:function(){return g},isParallelRouteSegment:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return Array.isArray(a)?a[1]:a}function g(a){return"("===a[0]&&a.endsWith(")")}function h(a){return a.startsWith("@")&&"@children"!==a}function i(a,b){if(a.includes(k)){let a=JSON.stringify(b);return"{}"!==a?k+"?"+a:k}return a}function j(a,b){if(!a||0===a.length)return null;let c="children"===b?a[0]:a[a.length-1];return c===l?null:c}let k="__PAGE__",l="__DEFAULT__",m="/_not-found"},7612,a=>{"use strict";a.s(["normalizeImagePath",0,a=>{if(!a||a.startsWith("data:image/")||a.startsWith("data:application/")||a.startsWith("http://")||a.startsWith("https://"))return a;let b=a.replace(/^\/TheHappyCase\//,"/");b=b.replace(/\/+/g,"/");let c=("u">typeof process?process.env?.NEXT_PUBLIC_BASE_URL||process.env?.BASE_URL:"")||"/";if(b.startsWith("/")&&c&&"/"!==c&&"./"!==c&&"."!==c){let a=c.endsWith("/")?c.slice(0,-1):c;if(!b.startsWith(a))return`${a}${b}`}return b}])},83526,56942,a=>{"use strict";var b=a.i(13930);let c=a=>{if(a.customDesign||a.designImage)return`custom-${a.id||Date.now()}`;if("charm"===a.type||a.category&&a.pin){let b=a.category||a.pin&&a.pin.category||"colorful",c=a.pin?.name||a.pin?.src||a.name||"";return`charm-${b}-${c}`}if(a.caseType&&a.color){if(a.pins&&a.pins.length>0){let b=a.pins.map(a=>a.name||a.src).sort().join("-");return`case-${a.caseType}-${a.color}-pins-${b}`}return`case-${a.caseType}-${a.color}`}return a.id&&a.id.startsWith("case-")?`unique-${a.id}`:a.id?`item-${a.id}`:`item-${Date.now()}`},d=(a,b)=>c(a)===c(b);a.s(["areItemsIdentical",0,d],56942);var e=a.i(34287);let f=null,g=null,h=null,i=!1,j=async()=>h||(h=(async()=>{try{f||(i=!0);let a=(0,e.getApiUrl)("/api/inventory"),b=new AbortController,c=setTimeout(()=>b.abort(),1e4),d=async a=>{let b=a.headers.get("content-type"),c=await a.text();if(!b||!b.includes("application/json")){if(c.trim().startsWith("<!DOCTYPE")||c.trim().startsWith("<html"))throw Error("HTML_RESPONSE_FALLBACK");throw Error(`Expected JSON, got: ${c.substring(0,100)}...`)}try{return JSON.parse(c)}catch(a){throw Error(`Failed to parse JSON response: ${a.message}`)}};try{console.log("[INVENTORY] ðŸ” Fetching inventory from:",a);let e=await fetch(a,{signal:b.signal,headers:{"Content-Type":"application/json"}});if(clearTimeout(c),console.log("[INVENTORY] ðŸ“¡ Response status:",e.status,e.statusText),!e.ok)try{let a=await e.text();console.error("[INVENTORY] âŒ Error response body:",a);try{let b=JSON.parse(a);console.error("[INVENTORY] âŒ Error details:",b)}catch(a){}}catch(a){console.error("[INVENTORY] âŒ Could not read error response:",a)}if(e.ok){let a=await d(e);if(console.log("[INVENTORY] âœ… Received inventory data:",{success:a.success,hasInventory:!!a.inventory,inventoryType:typeof a.inventory,inventoryKeys:a.inventory?Object.keys(a.inventory):null,casesType:typeof a.inventory?.cases,casesIsArray:Array.isArray(a.inventory?.cases),casesLength:a.inventory?.cases?.length,casesValue:a.inventory?.cases,caseColorsType:typeof a.inventory?.caseColors,caseColorsIsArray:Array.isArray(a.inventory?.caseColors),caseColorsLength:a.inventory?.caseColors?.length,caseColorsValue:a.inventory?.caseColors,pinsType:typeof a.inventory?.pins,pinsKeys:a.inventory?.pins?Object.keys(a.inventory.pins):null,pinsFlagsLength:a.inventory?.pins?.flags?.length,pinsColorfulLength:a.inventory?.pins?.colorful?.length,pinsBronzeLength:a.inventory?.pins?.bronze?.length,fullInventory:a.inventory}),a.success&&a.inventory){console.log("[INVENTORY] ðŸ”„ STEP 5: Parsing inventory data from API response...");let b={cases:a.inventory.cases,caseColors:a.inventory.caseColors,pins:a.inventory.pins};console.log("[INVENTORY] ðŸ” STEP 5.1: Parsed quantities structure:",{casesType:typeof b.cases,casesIsArray:Array.isArray(b.cases),casesValue:b.cases,caseColorsType:typeof b.caseColors,caseColorsIsArray:Array.isArray(b.caseColors),caseColorsValue:b.caseColors,pinsType:typeof b.pins,pinsValue:b.pins});let c=b.cases&&Array.isArray(b.cases)&&b.cases.some(a=>null!==a)||b.caseColors&&Array.isArray(b.caseColors)&&b.caseColors.some(a=>a&&a.some(a=>null!==a))||b.pins&&(b.pins.flags&&b.pins.flags.some(a=>null!==a)||b.pins.colorful&&b.pins.colorful.some(a=>null!==a)||b.pins.bronze&&b.pins.bronze.some(a=>null!==a));return console.log("[INVENTORY] ðŸ“Š Inventory summary:",{hasInventoryData:c,cacheTimestamp:Date.now(),casesType:typeof b.cases,casesIsArray:Array.isArray(b.cases),casesPreview:Array.isArray(b.cases)?b.cases.slice(0,5):b.cases,caseColorsType:typeof b.caseColors,caseColorsIsArray:Array.isArray(b.caseColors),caseColorsPreview:Array.isArray(b.caseColors)?b.caseColors.slice(0,2).map(a=>Array.isArray(a)?a.slice(0,3):a):b.caseColors,pinsPreview:b.pins}),console.log("[INVENTORY] ðŸ”„ STEP 5.4: Updating in-memory cache..."),f=b,g=Date.now(),i=!1,console.log("[INVENTORY] âœ… STEP 5.7: Inventory fetch complete and cache ready"),b}}else if(404===e.status){let c=a.replace("/api/inventory","/.netlify/functions/inventory");try{let a=await fetch(c,{signal:b.signal,headers:{"Content-Type":"application/json"}});if(a.ok){let b=await d(a);if(b.success&&b.inventory){let a={cases:b.inventory.cases,caseColors:b.inventory.caseColors,pins:b.inventory.pins};return f=a,g=Date.now(),a}}}catch(a){}}}catch(b){if(clearTimeout(c),i=!1,console.error("[INVENTORY] âŒ Error fetching inventory:",{message:b.message,name:b.name,apiUrl:a,errorType:"TypeError"===b.name&&"Failed to fetch"===b.message?"Network error - Backend server may not be running":"Other error"}),"HTML_RESPONSE_FALLBACK"===b.message){console.log("[INVENTORY] ðŸ”„ Trying fallback URL (HTML response detected)");let b=a.replace("/api/inventory","/.netlify/functions/inventory");try{let a=new AbortController,c=setTimeout(()=>a.abort(),1e4),e=await fetch(b,{signal:a.signal,headers:{"Content-Type":"application/json"}});if(clearTimeout(c),e.ok){let a=await d(e);if(a.success&&a.inventory){let b={cases:a.inventory.cases,caseColors:a.inventory.caseColors,pins:a.inventory.pins};return f=b,g=Date.now(),b}}}catch(a){}}}}catch(a){i=!1}finally{h=null,i=!1}return null})()),k=async()=>(f=null,g=null,await j());a.s(["getCachedInventory",0,()=>f,"getMaxAvailableQuantity",0,(a,c)=>{if(!f&&h&&i)return null;let e=g?Date.now()-g:1/0;f&&!(e>6e4)||i||j().catch(()=>{});let k=f;if(!k||!k.caseColors&&!k.cases&&!k.pins)return null;if(a.caseType&&a.color){let d=b.default.cases.find(b=>b.type===a.caseType);if(!d)return null;let e=null;if(k&&k.caseColors){let c=b.default.cases.findIndex(b=>b.type===a.caseType);if(-1!==c&&k.caseColors[c]){let b=d.colors.findIndex(b=>b.color===a.color);-1!==b&&null!==k.caseColors[c][b]&&void 0!==k.caseColors[c][b]&&(e=k.caseColors[c][b])}}if(null===e&&k&&k.cases){let c=b.default.cases.findIndex(b=>b.type===a.caseType);-1!==c&&null!==k.cases[c]&&void 0!==k.cases[c]&&(e=k.cases[c])}return null==e?null:0===e?0:Math.max(0,e-c.reduce((b,c)=>c.caseType===a.caseType&&c.color===a.color?b+(c.quantity||1):b,0))}if("charm"===a.type||a.category||a.pin){let e=a.category||a.pin&&a.pin.category,f=a.pin?.name||a.pin?.src||a.name;if(!e||!f)return null;let g=null;if(b.default.pins&&b.default.pins[e]&&(g=b.default.pins[e].find(a=>a.name===f||a.src===f)),!g)return null;let h=null,i="flags"===e?"flags":e;if(k&&k.pins&&k.pins[i]){let a=b.default.pins[i].findIndex(a=>a.name===f||a.src===f||a.id===g.id);-1!==a&&void 0!==k.pins[i][a]&&(h=k.pins[i][a])}return null==h?null:0===h?0:Math.max(0,h-c.reduce((b,c)=>d(a,c)?b+(c.quantity||1):b,0))}return null},"refreshInventoryFromSupabase",0,k],83526)}];

//# sourceMappingURL=Desktop_HappyCase_TheHappy_TheHappyCase_b0954a78._.js.map