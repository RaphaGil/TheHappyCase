module.exports=[19941,a=>{"use strict";var b,c=a.i(87924),d=a.i(72131),e=a.i(50944),f=a.i(38246),g="basil";"".concat("https://js.stripe.com","/").concat(g,"/stripe.js");var h=function(a,b){a&&a._registerWrapper&&a._registerWrapper({name:"stripe-js",version:"7.9.0",startTime:b})},i=null,j=function(a,b,c){if(null===a)return null;var d,e=b[0].match(/^pk_test/),f=3===(d=a.version)?"v3":d;e&&f!==g&&console.warn("Stripe.js@".concat(f," was loaded on the page, but @stripe/stripe-js@").concat("7.9.0"," expected Stripe.js@").concat(g,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var i=a.apply(void 0,b);return h(i,c),i},k=!1,l=function(){return b?b:b=(null!==i?i:(i=new Promise(function(a,b){a(null)})).catch(function(a){return i=null,Promise.reject(a)})).catch(function(a){return b=null,Promise.reject(a)})};Promise.resolve().then(function(){return l()}).catch(function(a){k||console.warn(a)});var m=a.i(41212);function n(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function o(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?n(Object(c),!0).forEach(function(b){q(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):n(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function p(a){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function q(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function r(a,b){return function(a){if(Array.isArray(a))return a}(a)||function(a,b){var c,d,e=a&&("u">typeof Symbol&&a[Symbol.iterator]||a["@@iterator"]);if(null!=e){var f=[],g=!0,h=!1;try{for(e=e.call(a);!(g=(c=e.next()).done)&&(f.push(c.value),!b||f.length!==b);g=!0);}catch(a){h=!0,d=a}finally{try{g||null==e.return||e.return()}finally{if(h)throw d}}return f}}(a,b)||function(a,b){if(a){if("string"==typeof a)return s(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c)return Array.from(a);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return s(a,b)}}(a,b)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var t=function(a,b,c){var e=!!c,f=d.default.useRef(c);d.default.useEffect(function(){f.current=c},[c]),d.default.useEffect(function(){if(!e||!a)return function(){};var c=function(){f.current&&f.current.apply(f,arguments)};return a.on(b,c),function(){a.off(b,c)}},[e,b,a,f])},u=function(a){var b=d.default.useRef(a);return d.default.useEffect(function(){b.current=a},[a]),b.current},v=function(a){return null!==a&&"object"===p(a)},w="[object Object]",x=function a(b,c){if(!v(b)||!v(c))return b===c;var d=Array.isArray(b);if(d!==Array.isArray(c))return!1;var e=Object.prototype.toString.call(b)===w;if(e!==(Object.prototype.toString.call(c)===w))return!1;if(!e&&!d)return b===c;var f=Object.keys(b),g=Object.keys(c);if(f.length!==g.length)return!1;for(var h={},i=0;i<f.length;i+=1)h[f[i]]=!0;for(var j=0;j<g.length;j+=1)h[g[j]]=!0;var k=Object.keys(h);return k.length===f.length&&k.every(function(d){return a(b[d],c[d])})},y=function(a,b,c){return v(a)?Object.keys(a).reduce(function(d,e){var f=!v(b)||!x(a[e],b[e]);return c.includes(e)?(f&&console.warn("Unsupported prop change: options.".concat(e," is not a mutable property.")),d):f?o(o({},d||{}),{},q({},e,a[e])):d},null):null},z="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",A=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z;if(null===a||v(a)&&"function"==typeof a.elements&&"function"==typeof a.createToken&&"function"==typeof a.createPaymentMethod&&"function"==typeof a.confirmCardPayment)return a;throw Error(b)},B=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z;if(v(a)&&"function"==typeof a.then)return{tag:"async",stripePromise:Promise.resolve(a).then(function(a){return A(a,b)})};var c=A(a,b);return null===c?{tag:"empty"}:{tag:"sync",stripe:c}},C=function(a){a&&a._registerWrapper&&a.registerAppInfo&&(a._registerWrapper({name:"react-stripe-js",version:"4.0.2"}),a.registerAppInfo({name:"react-stripe-js",version:"4.0.2",url:"https://stripe.com/docs/stripe-js/react"}))},D=d.default.createContext(null);D.displayName="ElementsContext";var E=function(a,b){if(!a)throw Error("Could not find Elements context; You need to wrap the part of your app that ".concat(b," in an <Elements> provider."));return a},F=function(a){var b=a.stripe,c=a.options,e=a.children,f=d.default.useMemo(function(){return B(b)},[b]),g=r(d.default.useState(function(){return{stripe:"sync"===f.tag?f.stripe:null,elements:"sync"===f.tag?f.stripe.elements(c):null}}),2),h=g[0],i=g[1];d.default.useEffect(function(){var a=!0,b=function(a){i(function(b){return b.stripe?b:{stripe:a,elements:a.elements(c)}})};return"async"!==f.tag||h.stripe?"sync"!==f.tag||h.stripe||b(f.stripe):f.stripePromise.then(function(c){c&&a&&b(c)}),function(){a=!1}},[f,h,c]);var j=u(b);d.default.useEffect(function(){null!==j&&j!==b&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[j,b]);var k=u(c);return d.default.useEffect(function(){if(h.elements){var a=y(c,k,["clientSecret","fonts"]);a&&h.elements.update(a)}},[c,k,h.elements]),d.default.useEffect(function(){C(h.stripe)},[h.stripe]),d.default.createElement(D.Provider,{value:h},e)};F.propTypes={stripe:m.default.any,options:m.default.object};m.default.func.isRequired;var G=d.default.createContext(null);G.displayName="CheckoutContext",m.default.any,m.default.shape({fetchClientSecret:m.default.func.isRequired,elementsOptions:m.default.object}).isRequired;var H=function(a){var b=d.default.useContext(G),c=d.default.useContext(D);if(!b)return E(c,a);if(!c)return b;throw Error("You cannot wrap the part of your app that ".concat(a," in both <CheckoutProvider> and <Elements> providers."))},I=["mode"],J=function(a,b){var c="".concat(a.charAt(0).toUpperCase()+a.slice(1),"Element"),e=b?function(a){H("mounts <".concat(c,">"));var b=a.id,e=a.className;return d.default.createElement("div",{id:b,className:e})}:function(b){var e,f=b.id,g=b.className,h=b.options,i=void 0===h?{}:h,j=b.onBlur,k=b.onFocus,l=b.onReady,m=b.onChange,n=b.onEscape,o=b.onClick,p=b.onLoadError,q=b.onLoaderStart,s=b.onNetworksChange,v=b.onConfirm,w=b.onCancel,x=b.onShippingAddressChange,z=b.onShippingRateChange,A=b.onSavedPaymentMethodRemove,B=b.onSavedPaymentMethodUpdate,C=H("mounts <".concat(c,">")),D="elements"in C?C.elements:null,E="checkoutState"in C?C.checkoutState:null,F=(null==E?void 0:E.type)==="success"?E.checkout:null,G=r(d.default.useState(null),2),J=G[0],K=G[1],L=d.default.useRef(null),M=d.default.useRef(null);t(J,"blur",j),t(J,"focus",k),t(J,"escape",n),t(J,"click",o),t(J,"loaderror",p),t(J,"loaderstart",q),t(J,"networkschange",s),t(J,"confirm",v),t(J,"cancel",w),t(J,"shippingaddresschange",x),t(J,"shippingratechange",z),t(J,"savedpaymentmethodremove",A),t(J,"savedpaymentmethodupdate",B),t(J,"change",m),l&&(e="expressCheckout"===a?l:function(){l(J)}),t(J,"ready",e),d.default.useLayoutEffect(function(){if(null===L.current&&null!==M.current&&(D||F)){var b=null;if(F)switch(a){case"payment":b=F.createPaymentElement(i);break;case"address":if("mode"in i){var d=i.mode,e=function(a,b){if(null==a)return{};var c,d,e=function(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],b.indexOf(c)>=0||(e[c]=a[c]);return e}(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(b.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}(i,I);if("shipping"===d)b=F.createShippingAddressElement(e);else if("billing"===d)b=F.createBillingAddressElement(e);else throw Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":b=F.createExpressCheckoutElement(i);break;case"currencySelector":b=F.createCurrencySelectorElement();break;case"taxId":b=F.createTaxIdElement(i);break;default:throw Error("Invalid Element type ".concat(c,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else D&&(b=D.create(a,i));L.current=b,K(b),b&&b.mount(M.current)}},[D,F,i]);var N=u(i);return d.default.useEffect(function(){if(L.current){var a=y(i,N,["paymentRequest"]);a&&"update"in L.current&&L.current.update(a)}},[i,N]),d.default.useLayoutEffect(function(){return function(){if(L.current&&"function"==typeof L.current.destroy)try{L.current.destroy(),L.current=null}catch(a){}}},[]),d.default.createElement("div",{id:f,className:g,ref:M})};return e.propTypes={id:m.default.string,className:m.default.string,onChange:m.default.func,onBlur:m.default.func,onFocus:m.default.func,onReady:m.default.func,onEscape:m.default.func,onClick:m.default.func,onLoadError:m.default.func,onLoaderStart:m.default.func,onNetworksChange:m.default.func,onConfirm:m.default.func,onCancel:m.default.func,onShippingAddressChange:m.default.func,onShippingRateChange:m.default.func,onSavedPaymentMethodRemove:m.default.func,onSavedPaymentMethodUpdate:m.default.func,options:m.default.object},e.displayName=c,e.__elementType=a,e},K=d.default.createContext(null);K.displayName="EmbeddedCheckoutProviderContext";J("auBankAccount",!0),J("card",!0),J("cardNumber",!0),J("cardExpiry",!0),J("cardCvc",!0),J("fpxBank",!0),J("iban",!0),J("idealBank",!0),J("p24Bank",!0),J("epsBank",!0);var L=J("payment",!0);J("expressCheckout",!0),J("paymentRequestButton",!0),J("linkAuthentication",!0),J("address",!0),J("shippingAddress",!0),J("paymentMethodMessaging",!0),J("affirmMessage",!0),J("afterpayClearpayMessage",!0),J("taxId",!0);var M=a.i(92250),N=a.i(80169),O=a.i(14772);let P=async a=>{let{amount:b,currency:c="gbp",items:d,customerInfo:e}=a;if(!b||b<=0)throw Error("Amount is required and must be greater than 0");if(!c)throw Error("Currency is required");try{let a=(0,O.getApiUrl)("/api/create-payment-intent"),f=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:b,currency:c,items:d,customerInfo:e})});if(!f.ok){let a,b=f.headers.get("content-type");try{if(b&&b.includes("application/json"))a=await f.json();else{a=await f.text();try{a=JSON.parse(a)}catch(a){}}}catch(b){a="Unable to parse error response"}let c="string"==typeof a?a.substring(0,200):(a?.error||a?.message||JSON.stringify(a)).substring(0,200);throw Error(`Backend responded with ${f.status} ${f.statusText}: ${c}`)}let g=await f.json();if(!g.clientSecret)throw Error("Backend did not return a clientSecret");return{client_secret:g.clientSecret}}catch(a){throw Error(`Failed to create payment intent: ${a.message}. Please ensure your backend server is running on port 3001.`)}};var Q=a.i(1745);let R=({className:a="",showOnDesktop:b=!1,showOnMobile:d=!1,title:e="Custom Duties & Import Fees",message:f="International orders may be subject to customs duties, taxes, and fees imposed by your country. These charges are the responsibility of the recipient and are not included in the order total.",variant:g="yellow"})=>(0,c.jsx)("div",{className:`${b&&d?"":b?"hidden lg:block":d?"lg:hidden":""} ${a}`,children:(0,c.jsx)("div",{className:`${"yellow"===g?"bg-yellow-50":"bg-gray-100"} border ${"yellow"===g?"border-yellow-200":"border-gray-200"} rounded-lg p-4`,children:(0,c.jsxs)("div",{className:"flex items-start gap-3",children:[(0,c.jsx)("div",{className:`${"yellow"===g?"text-yellow-600":"text-gray-600"} text-xl flex-shrink-0`,children:"⚠️"}),(0,c.jsxs)("div",{className:"flex-1 font-inter",children:[(0,c.jsx)("h3",{className:`text-sm font-semibold ${"yellow"===g?"text-yellow-800":"text-gray-800"} mb-1`,children:e}),(0,c.jsx)("p",{className:`text-xs ${"yellow"===g?"text-yellow-700":"text-gray-500"} font-light leading-relaxed font-inter`,children:f})]})]})})}),S=()=>{let{getTotalQuantity:a}=(0,M.useCart)(),b=a();return(0,c.jsx)("div",{className:"border-b border-gray-200 bg-white",children:(0,c.jsxs)("div",{className:"max-w-6xl mx-auto flex items-center justify-between px-4 lg:px-6 py-5",children:[(0,c.jsx)(f.default,{href:"/",className:"hover:opacity-90 transition-opacity duration-300","aria-label":"HappyCase home",children:(0,c.jsx)("img",{src:"/assets/logo.webp",alt:"The Happy Case Logo",className:"h-14 w-auto "})}),(0,c.jsxs)(f.default,{href:"/cart",className:"relative flex items-center justify-center p-2 text-gray-900 hover:text-gray-700 transition-colors z-10","aria-label":"Go to cart",children:[(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 640",className:"w-6 h-6",fill:"currentColor",children:(0,c.jsx)("path",{d:"M8 64C3.6 64 0 67.6 0 72C0 76.4 3.6 80 8 80L53.7 80C65.1 80 75 88.1 77.2 99.4L136.6 402.8C141.7 429.1 164.8 448 191.6 448L488 448C492.4 448 496 444.4 496 440C496 435.6 492.4 432 488 432L191.5 432C172.4 432 155.9 418.5 152.2 399.7L142.9 352L461.2 352C494.7 352 523.7 328.9 531.3 296.4L566.6 145.1C572.5 120 553.4 96 527.7 96L92.8 96C89 77.4 72.7 64 53.7 64L8 64zM96 112L527.7 112C543.2 112 554.6 126.4 551.1 141.5L515.8 292.7C509.9 318 487.3 336 461.3 336L139.8 336L96 112zM176 528C176 510.3 190.3 496 208 496C225.7 496 240 510.3 240 528C240 545.7 225.7 560 208 560C190.3 560 176 545.7 176 528zM256 528C256 501.5 234.5 480 208 480C181.5 480 160 501.5 160 528C160 554.5 181.5 576 208 576C234.5 576 256 554.5 256 528zM432 496C449.7 496 464 510.3 464 528C464 545.7 449.7 560 432 560C414.3 560 400 545.7 400 528C400 510.3 414.3 496 432 496zM432 576C458.5 576 480 554.5 480 528C480 501.5 458.5 480 432 480C405.5 480 384 501.5 384 528C384 554.5 405.5 576 432 576z"})}),b>0&&(0,c.jsx)("span",{className:"absolute top-0 right-0 bg-gray-900 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-light",children:b})]})]})})},T=()=>(0,c.jsx)("div",{className:"min-h-screen bg-white py-8",children:(0,c.jsx)("div",{className:"max-w-2xl mx-auto p-6 bg-white border border-gray-200",children:(0,c.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-300 mx-auto mb-4"}),(0,c.jsx)("p",{className:"text-gray-500 font-light font-inter",children:"Loading checkout..."})]})})})}),U=({customerInfo:a,onInputChange:b,isAuthenticated:f,authenticatedEmail:g,onSignIn:h,onSignOut:i})=>{let j=(0,e.useRouter)(),[k,l]=(0,d.useState)(!1),m=(0,d.useRef)(null);return(0,d.useEffect)(()=>{let a=a=>{m.current&&!m.current.contains(a.target)&&l(!1)};return k&&document.addEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}},[k]),(0,c.jsxs)("div",{className:"space-y-4 ",children:[(0,c.jsx)("h3",{className:"text-md uppercase tracking-wider text-gray-900 mb-4 font-bold font-inter",children:"Contact"}),f?(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-1.5",children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 font-light font-inter",children:"Email Address *"}),(0,c.jsx)("button",{type:"button",onClick:i,className:"text-xs text-gray-600 hover:text-gray-900 font-light font-inter underline",children:"Sign Out"})]}),(0,c.jsx)("div",{className:"w-full px-3 py-2 border border-gray-200 rounded-sm bg-gray-50 text-gray-900 font-light font-inter text-sm",children:g}),(0,c.jsxs)("p",{className:"mt-1 text-xs text-gray-500 font-light font-inter",children:["Signed in as ",g]})]}):(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"flex items-center justify-between mb-1.5 relative",children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 font-light font-inter",children:"Email Address *"}),(0,c.jsxs)("div",{ref:m,className:"relative",children:[(0,c.jsx)("button",{type:"button",onClick:()=>{l(!0)},className:"text-xs text-gray-600 hover:text-gray-900 font-light font-inter underline",children:"Sign In"}),k&&(0,c.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-sm shadow-lg z-50",children:(0,c.jsxs)("div",{className:"p-3",children:[(0,c.jsx)("p",{className:"text-sm text-gray-700 font-light font-inter mb-3",children:"Do you want to sign in?"}),(0,c.jsxs)("div",{className:"flex gap-2",children:[(0,c.jsx)("button",{type:"button",onClick:()=>{l(!1),j.push("/login?redirect=/checkout")},className:"flex-1 px-3 py-1.5 text-xs uppercase tracking-wider font-light font-inter bg-black text-white hover:bg-gray-800 transition-colors",children:"Yes"}),(0,c.jsx)("button",{type:"button",onClick:()=>{l(!1)},className:"flex-1 px-3 py-1.5 text-xs uppercase tracking-wider font-light font-inter border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors",children:"No"})]})]})})]})]}),(0,c.jsx)("input",{type:"email",name:"email",value:a.email,onChange:b,required:!0,placeholder:"your.email@example.com",className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}}),(0,c.jsx)("p",{className:"mt-1 text-xs text-gray-500 font-light font-inter",children:"We'll send your order confirmation to this email"})]}),(0,c.jsx)("h3",{className:"text-md uppercase tracking-wider text-gray-900 mb-4 font-bold font-inter",children:"Delivery"}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:"Name *"}),(0,c.jsx)("input",{type:"text",name:"name",value:a.name,onChange:b,required:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:"Surname *"}),(0,c.jsx)("input",{type:"text",name:"surname",value:a.surname,onChange:b,required:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:"Address Line 1 *"}),(0,c.jsx)("input",{type:"text",name:"address.line1",value:a.address.line1,onChange:b,required:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:"Address Line 2"}),(0,c.jsx)("input",{type:"text",name:"address.line2",value:a.address.line2,onChange:b,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}})]}),(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:"City *"}),(0,c.jsx)("input",{type:"text",name:"address.city",value:a.address.city,onChange:b,required:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:["GB"===a.address.country?"Postcode":"Postal Code"," *"]}),(0,c.jsx)("input",{type:"text",name:"address.postal_code",value:a.address.postal_code,onChange:b,required:!0,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 placeholder-gray-400 font-light font-inter text-base",style:{fontSize:"16px"}})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm text-gray-500 mb-1.5 font-light font-inter",children:"Country/Region *"}),(0,c.jsxs)("select",{name:"address.country",value:a.address.country,onChange:b,className:"w-full px-3 py-2 border border-gray-200 rounded-sm focus:outline-none focus:ring-2 focus:ring-yellow-100 focus:border-yellow-100 bg-white text-gray-900 font-light font-inter text-base",style:{fontSize:"16px"},children:[(0,c.jsx)("option",{value:"GB",children:"England"}),(0,c.jsxs)("optgroup",{label:"Europe",children:[(0,c.jsx)("option",{value:"AL",children:"Albania"}),(0,c.jsx)("option",{value:"AD",children:"Andorra"}),(0,c.jsx)("option",{value:"AT",children:"Austria"}),(0,c.jsx)("option",{value:"BE",children:"Belgium"}),(0,c.jsx)("option",{value:"BA",children:"Bosnia and Herzegovina"}),(0,c.jsx)("option",{value:"BG",children:"Bulgaria"}),(0,c.jsx)("option",{value:"HR",children:"Croatia"}),(0,c.jsx)("option",{value:"CY",children:"Cyprus"}),(0,c.jsx)("option",{value:"CZ",children:"Czech Republic"}),(0,c.jsx)("option",{value:"DK",children:"Denmark"}),(0,c.jsx)("option",{value:"EE",children:"Estonia"}),(0,c.jsx)("option",{value:"FI",children:"Finland"}),(0,c.jsx)("option",{value:"FR",children:"France"}),(0,c.jsx)("option",{value:"DE",children:"Germany"}),(0,c.jsx)("option",{value:"GR",children:"Greece"}),(0,c.jsx)("option",{value:"HU",children:"Hungary"}),(0,c.jsx)("option",{value:"IS",children:"Iceland"}),(0,c.jsx)("option",{value:"IE",children:"Ireland"}),(0,c.jsx)("option",{value:"IT",children:"Italy"}),(0,c.jsx)("option",{value:"LV",children:"Latvia"}),(0,c.jsx)("option",{value:"LI",children:"Liechtenstein"}),(0,c.jsx)("option",{value:"LT",children:"Lithuania"}),(0,c.jsx)("option",{value:"LU",children:"Luxembourg"}),(0,c.jsx)("option",{value:"MT",children:"Malta"}),(0,c.jsx)("option",{value:"MC",children:"Monaco"}),(0,c.jsx)("option",{value:"ME",children:"Montenegro"}),(0,c.jsx)("option",{value:"NL",children:"Netherlands"}),(0,c.jsx)("option",{value:"MK",children:"North Macedonia"}),(0,c.jsx)("option",{value:"NO",children:"Norway"}),(0,c.jsx)("option",{value:"PL",children:"Poland"}),(0,c.jsx)("option",{value:"PT",children:"Portugal"}),(0,c.jsx)("option",{value:"RO",children:"Romania"}),(0,c.jsx)("option",{value:"SM",children:"San Marino"}),(0,c.jsx)("option",{value:"RS",children:"Serbia"}),(0,c.jsx)("option",{value:"SK",children:"Slovakia"}),(0,c.jsx)("option",{value:"SI",children:"Slovenia"}),(0,c.jsx)("option",{value:"ES",children:"Spain"}),(0,c.jsx)("option",{value:"SE",children:"Sweden"}),(0,c.jsx)("option",{value:"CH",children:"Switzerland"})]})]})]})]})]})},V=({paymentElementReady:a,error:b,onPaymentReady:e,onPaymentError:f})=>{let g=(0,d.useRef)(null);return(0,d.useEffect)(()=>{if(!a)return;let b=()=>{(()=>{let a=document.querySelector('[data-testid="payment-element"]');if(!a)return;let b=a.querySelector('[role="tab"][aria-label*="Card"]')||a.querySelector('[role="tab"][aria-label*="card"]')||a.querySelector('[role="tab"][data-testid*="card"]');b&&"true"!==b.getAttribute("aria-expanded")&&b.click()})(),(()=>{let a=document.querySelector('[data-testid="payment-element"]');if(!a)return;let b=["revolut","amazon","link","cash app","cashapp"],c=["card","klarna","clearpay","afterpay","apple pay","google pay"];a.querySelectorAll('[role="tab"], [role="button"], button, [aria-label*="Revolut"], [aria-label*="revolut"], [aria-label*="Amazon"], [aria-label*="amazon"], [aria-label*="Link"], [aria-label*="link"], [data-testid*="revolut"], [data-testid*="amazon"], [data-testid*="link"], [id*="revolut"], [id*="amazon"], [id*="RevolutPay"], [id*="AmazonPay"], [class*="revolut"], [class*="amazon"], iframe[src*="revolut"], iframe[src*="Revolut"], iframe[src*="amazon"], iframe[src*="Amazon"], iframe[title*="revolut"], iframe[title*="Revolut"], iframe[title*="amazon"], iframe[title*="Amazon"]').forEach(a=>{let c=(a.getAttribute("aria-label")||a.textContent||a.getAttribute("data-testid")||"").toLowerCase();if(b.some(a=>c.includes(a))){a.style.display="none !important",a.style.visibility="hidden !important",a.style.opacity="0 !important",a.style.height="0 !important",a.style.margin="0 !important",a.style.padding="0 !important",a.setAttribute("aria-hidden","true"),a.setAttribute("hidden","true");let b=a.getAttribute("aria-controls");if(b){let a=document.getElementById(b);a&&(a.style.display="none",a.style.visibility="hidden",a.setAttribute("aria-hidden","true"))}}}),a.querySelectorAll('[role="tab"]').forEach(a=>{let d=(a.getAttribute("aria-label")||a.textContent||"").toLowerCase(),e=c.some(a=>d.includes(a));if(b.some(a=>d.includes(a))){a.style.display="none",a.style.visibility="hidden",a.setAttribute("aria-hidden","true");let b=a.getAttribute("aria-controls");if(b){let a=document.getElementById(b);a&&(a.style.display="none",a.style.visibility="hidden",a.setAttribute("aria-hidden","true"))}}else e&&(a.style.display="",a.style.visibility="visible",a.setAttribute("aria-hidden","false"),d.includes("klarna")&&(a.style.display="block",a.style.visibility="visible",a.style.opacity="1"))})})()};setTimeout(b,100),setTimeout(b,250),setTimeout(b,500),setTimeout(b,1e3);let c=document.querySelector('[data-testid="payment-element"]');if(!c)return;let d=new MutationObserver(()=>{setTimeout(b,50)});return d.observe(c,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["aria-hidden","style","class"]}),()=>d.disconnect()},[a]),(0,c.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,c.jsx)("h3",{className:"text-md sm:text-md uppercase tracking-wider text-gray-900 mb-3 sm:mb-4 font-bold font-inter",children:"Payment"}),(0,c.jsxs)("div",{ref:g,className:"p-3 sm:p-4 border border-gray-200 rounded-sm overflow-hidden",children:[!a&&(0,c.jsx)("div",{className:"mb-2 text-xs sm:text-sm text-gray-500 font-light font-inter",children:"Loading payment form..."}),(0,c.jsx)("div",{className:"w-full flex flex-col space-y-2",children:(0,c.jsx)(L,{options:{layout:"accordion",fields:{billingDetails:{email:"never",phone:"never",address:"never"}},wallets:{applePay:"auto",googlePay:"auto"},paymentMethodTypes:{card:"always",klarna:"always",afterpayClearpay:"always",paypal:"never",link:"never",amazonPay:"never",revolutPay:"never"},business:{name:"The Happy Case"}},onReady:e,onError:a=>{a?.message?.includes("hcaptcha")||a?.message?.includes("hCaptcha")||f?.(a.message||"Failed to load payment form. Please refresh the page.")}})})]}),b&&(0,c.jsx)("div",{className:"text-red-600 text-xs sm:text-sm bg-red-50 p-2 sm:p-3 rounded-sm font-light font-inter",children:b})]})};var W=a.i(18772);let X=({item:a,index:b,formatPrice:e,onIncrement:f,onDecrement:g,onRemove:h,errorMessage:i})=>{let[j,k]=(0,d.useState)(!1),l=(0,d.useRef)(null);if((0,d.useEffect)(()=>{let a=a=>{let b=a.target,c="BUTTON"===b.tagName||null!==b.closest("button")||null!==b.closest('[role="button"]')||null!==b.closest('[aria-label*="quantity"]'),d="INPUT"===b.tagName||"TEXTAREA"===b.tagName;c||d||j&&l.current&&!l.current.contains(a.target)&&k(!1)};if(j){let b=setTimeout(()=>{document.addEventListener("mousedown",a)},200);return()=>{clearTimeout(b),document.removeEventListener("mousedown",a)}}},[j]),"charm"===a.type){let d=a.pin||a,m=a.price||0,n=a.quantity||1,o=m*n;return(0,c.jsx)("div",{className:" pb-4 ",ref:l,children:(0,c.jsxs)("div",{className:"flex items-start gap-4",children:[(0,c.jsxs)("div",{className:"relative flex-shrink-0 w-20 h-20 bg-gray-50 rounded-sm border border-gray-200 flex items-center justify-center overflow-visible",children:[a.image?(0,c.jsx)("img",{src:(0,W.normalizeImagePath)(a.image),alt:a.name||"Charm",className:"w-full h-full object-contain p-2",loading:"lazy"}):d?.src?(0,c.jsx)("img",{src:(0,W.normalizeImagePath)(d.src),alt:d.name||"Charm",className:"w-full h-full object-contain p-2",loading:"lazy"}):(0,c.jsx)("div",{className:"w-full h-full rounded-sm bg-gray-100"}),(0,c.jsx)("span",{className:"absolute -top-1.5 -right-1.5 bg-gray-900 text-white text-[10px] font-medium rounded-full h-5 w-5 flex items-center justify-center font-inter",children:n})]}),(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 font-inter leading-tight",children:a.name||d?.name||"Charm"}),(0,c.jsx)("p",{className:"text-xs text-gray-500 mt-0.5 font-inter",children:"bronze"===a.category?"Bronze Charm":"flags"===a.category?"Flag":"Colorful Charm"})]}),(0,c.jsx)("div",{className:"flex-shrink-0 text-right",children:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-900 font-inter",children:e(o)})})]}),!j&&(0,c.jsx)("div",{className:"mt-3",children:(0,c.jsx)("button",{onClick:a=>{a.stopPropagation(),k(!0)},className:"text-xs text-gray-600 hover:text-gray-900 font-light font-inter uppercase tracking-wider transition-colors",children:"Edit"})}),j&&f&&g&&(0,c.jsxs)("div",{className:"mt-3 flex items-center gap-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 border border-gray-200 rounded-sm p-1",children:[(0,c.jsx)("button",{onClick:c=>{c.preventDefault(),c.stopPropagation();let d=void 0!==a.id?a.id:b;console.log("➖ Charm item decrement clicked:",{identifier:d,itemId:a.id,index:b,currentQty:a.quantity,itemName:a.name,itemType:a.type,hasOnDecrement:!!g}),g&&g(d)},className:"w-6 h-6 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Decrease quantity",type:"button",children:"−"}),(0,c.jsx)("div",{className:"px-2 py-0.5 text-xs text-gray-900 font-light font-inter min-w-[1.5rem] text-center",children:n}),(0,c.jsx)("button",{onClick:c=>{c.preventDefault(),c.stopPropagation();let d=void 0!==a.id?a.id:b;console.log("➕ Charm item increment clicked:",{identifier:d,itemId:a.id,index:b,currentQty:a.quantity,itemName:a.name,itemType:a.type,hasOnIncrement:!!f}),f&&f(d)},className:"w-6 h-6 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Increase quantity",type:"button",children:"+"})]}),h&&(0,c.jsx)("button",{onClick:()=>{h(b),k(!1)},className:"text-xs text-red-600 hover:text-red-700 font-light font-inter uppercase tracking-wider transition-colors",children:"Remove"})]}),i&&(0,c.jsx)("p",{className:"text-xs text-red-600 font-inter mt-2",children:i})]})]})},b)}let m="number"==typeof a.basePrice?a.basePrice:"number"==typeof a.casePrice?a.casePrice:"number"==typeof a.price?a.price:8,n=a.pinsDetails&&a.pinsDetails.length?a.pinsDetails.reduce((a,b)=>a+(b.price||0),0):0,o=a.quantity||1,p=(m+n)*o;return(0,c.jsx)("div",{className:" pb-4 last:border-b-0",ref:l,children:(0,c.jsxs)("div",{className:"flex items-start gap-4",children:[(0,c.jsxs)("div",{className:"relative flex-shrink-0 w-20 h-20 bg-gray-50 rounded-sm border border-gray-200 flex items-center justify-center overflow-visible",children:[a.designImage?(0,c.jsx)("img",{src:(0,W.normalizeImagePath)(a.designImage),alt:"Custom Case Design",className:"w-full h-full object-contain p-2 rounded-sm",loading:"lazy"}):a.caseImage?(0,c.jsx)("img",{src:(0,W.normalizeImagePath)(a.caseImage),alt:"Custom Case",className:"w-full h-full object-contain p-2 rounded-sm",loading:"lazy"}):(0,c.jsx)("div",{className:"w-full h-full rounded-sm",style:{background:a.color}}),(0,c.jsx)("span",{className:"absolute -top-1.5 -right-1.5 bg-gray-900 text-white text-[10px] font-medium rounded-full h-5 w-5 flex items-center justify-center font-inter",children:o})]}),(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,c.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,c.jsx)("h4",{className:"text-sm font-medium text-gray-900 font-inter leading-tight",children:a.caseName||a.name||"Passport Case"}),(0,c.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,c.jsx)("span",{className:"text-xs text-gray-500 font-inter",children:"Color:"}),(0,c.jsx)("span",{className:"inline-flex h-4 w-4 rounded-full border border-gray-300 shadow-sm",style:{backgroundColor:a.color},"aria-label":`Selected color ${a.color}`})]})]}),(0,c.jsx)("div",{className:"flex-shrink-0 text-right",children:(0,c.jsx)("span",{className:"text-sm font-medium text-gray-900 font-inter",children:e(p)})})]}),!j&&(0,c.jsx)("div",{className:"mt-3",children:(0,c.jsx)("button",{onClick:a=>{a.stopPropagation(),k(!0)},className:"text-xs text-gray-600 hover:text-gray-900 font-light font-inter uppercase tracking-wider transition-colors",children:"Edit"})}),j&&f&&g&&(0,c.jsxs)("div",{className:"mt-3 flex items-center gap-3",children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 border border-gray-200 rounded-sm p-1",children:[(0,c.jsx)("button",{onClick:c=>{c.preventDefault(),c.stopPropagation();let d=void 0!==a.id?a.id:b;console.log("➖ Case item decrement clicked:",{identifier:d,itemId:a.id,index:b,currentQty:a.quantity,itemName:a.caseName||a.name,hasOnDecrement:!!g}),g?g(d):console.error("❌ onDecrement handler is missing!")},className:"w-6 h-6 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Decrease quantity",type:"button",children:"−"}),(0,c.jsx)("div",{className:"px-2 py-0.5 text-xs text-gray-900 font-light font-inter min-w-[1.5rem] text-center",children:o}),(0,c.jsx)("button",{onClick:c=>{c.preventDefault(),c.stopPropagation();let d=void 0!==a.id?a.id:b;console.log("➕ Case item increment clicked:",{identifier:d,itemId:a.id,index:b,currentQty:a.quantity,itemName:a.caseName||a.name,hasOnIncrement:!!f}),f?f(d):console.error("❌ onIncrement handler is missing!")},className:"w-6 h-6 flex items-center justify-center text-gray-600 hover:text-gray-900 transition-colors","aria-label":"Increase quantity",type:"button",children:"+"})]}),h&&(0,c.jsx)("button",{onClick:()=>{h(b),k(!1)},className:"text-xs text-red-600 hover:text-red-700 font-light font-inter uppercase tracking-wider transition-colors",children:"Remove"})]}),a.pinsDetails&&a.pinsDetails.length>0&&(0,c.jsx)("div",{className:"mt-3 pt-3 ",children:(0,c.jsx)("div",{className:"flex flex-col gap-2",children:Object.values(a.pinsDetails.reduce((a,b)=>(a[b.src]=a[b.src]||{...b,quantity:0},a[b.src].quantity++,a),{})).map((a,b)=>{let d=(a.price||0)*a.quantity;return(0,c.jsxs)("div",{className:"flex items-center justify-between",children:[(0,c.jsxs)("div",{className:"flex items-center gap-2",children:[(0,c.jsxs)("div",{className:"relative w-10 h-10 bg-gray-50 rounded-sm border border-gray-200 flex items-center justify-center overflow-visible",children:[(0,c.jsx)("img",{src:a.src,alt:a.name,className:"w-full h-full object-contain p-1",loading:"lazy"}),(0,c.jsx)("span",{className:"absolute -top-1 -right-1 bg-gray-900 text-white text-[10px] font-medium rounded-full h-4 w-4 flex items-center justify-center font-inter",children:a.quantity})]}),(0,c.jsx)("span",{className:"text-xs font-light text-gray-700 font-inter",children:a.name})]}),(0,c.jsx)("span",{className:"text-xs font-medium text-gray-900 font-inter",children:e(d)})]},b)})})})]})]})},b)},Y=({cart:a,formatPrice:b,subtotal:d,shippingCost:e,shippingLabel:g,totalWithShipping:h,showInternationalNote:i,onShowShippingInfo:j,onIncrement:k,onDecrement:l,onRemove:m,itemErrors:n})=>(0,c.jsxs)("div",{className:"flex flex-col h-full min-h-0 mt-4",children:[(0,c.jsx)("div",{className:"flex-1 overflow-y-auto pr-2 -mr-2 min-h-0 order-summary-scroll",style:{scrollbarWidth:"thin",scrollbarColor:"#d1d5db #f3f4f6"},children:(0,c.jsx)("div",{className:"pr-2 pb-2",children:0===a.length?(0,c.jsx)("p",{className:"text-sm text-gray-500 font-inter py-8 text-center",children:"Your cart is empty"}):(0,c.jsx)("div",{className:"space-y-0 mt-2",children:a.map((a,d)=>(0,c.jsx)(X,{item:a,index:d,formatPrice:b,onIncrement:k,onDecrement:l,onRemove:m,errorMessage:n?.[a.id||d]},a.id||`item-${d}`))})})}),(0,c.jsxs)("div",{className:"flex-shrink-0 pt-6  mt-4 ",children:[(0,c.jsxs)("div",{className:"space-y-3",children:[(0,c.jsxs)("div",{className:"flex justify-between text-sm font-light text-gray-700 font-inter",children:[(0,c.jsx)("span",{children:"Subtotal"}),(0,c.jsx)("span",{className:"font-medium text-gray-900 font-inter",children:b(d)})]}),(0,c.jsxs)("div",{className:"flex justify-between text-sm font-light text-gray-700 font-inter",children:[(0,c.jsxs)("span",{className:"flex items-center gap-1.5",children:["Shipping (",g,")",(0,c.jsx)("button",{type:"button",onClick:j,className:"text-gray-400 hover:text-gray-600 transition-colors w-4 h-4 rounded-full border border-gray-300 flex items-center justify-center text-[10px] leading-none",title:"Quick delivery information",children:"?"})]}),(0,c.jsx)("span",{className:"font-medium text-gray-900 font-inter",children:0===e?"Free":b(e)})]})]}),(0,c.jsxs)("div",{className:"flex justify-between py-4 border-t border-gray-200 mt-4 pt-4",children:[(0,c.jsx)("span",{className:"text-base font-medium text-gray-900 font-inter uppercase tracking-wider",children:"Total"}),(0,c.jsx)("span",{className:"text-xl font-semibold text-gray-900 font-inter",children:b(h)})]}),(0,c.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,c.jsxs)("p",{className:"text-xs text-gray-500 font-light font-inter leading-relaxed",children:["Shipping and taxes are calculated at checkout if applicable."," ",(0,c.jsx)(f.default,{href:"/shipping",className:"text-gray-600 hover:text-gray-900 underline transition-colors",title:"Learn more about shipping information",children:"Learn more"})]})}),i&&(0,c.jsx)("div",{className:"mt-4",children:(0,c.jsx)(R,{showOnDesktop:!0,showOnMobile:!1,title:"Custom Duties & Taxes Included",message:"The total amount you pay includes all applicable customs duties & taxes. We guarantee no additional charges on delivery.",variant:"gray"})})]})]}),Z=({isOpen:a,onToggle:b,cartLength:d,totalWithShipping:e,formatPrice:f,cart:g,subtotal:h,shippingCost:i,shippingLabel:j,showInternationalNote:k,onShowShippingInfo:l,onIncrement:m,onDecrement:n,onRemove:o,itemErrors:p})=>(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"lg:hidden ",children:(0,c.jsxs)("button",{type:"button",onClick:b,className:"w-full flex items-center justify-between px-4 py-3 text-xs uppercase tracking-wider text-gray-600 hover:text-gray-900 border border-gray-200 hover:border-gray-400 transition-all duration-200 font-light font-inter","aria-expanded":a,"aria-controls":"mobile-order-summary",children:[(0,c.jsxs)("span",{children:["Order Summary (",d," item",1===d?"":"s",")"]}),(0,c.jsxs)("span",{className:"flex items-center gap-2",children:[(0,c.jsx)("span",{children:f(e)}),(0,c.jsx)("svg",{className:`w-4 h-4 transition-transform ${a?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M19 9l-7 7-7-7"})})]})]})}),a&&(0,c.jsx)("div",{id:"mobile-order-summary",className:"lg:hidden  pb-4",children:(0,c.jsx)("div",{className:"mt-2 bg-yellow-50 p-4",children:(0,c.jsx)(Y,{cart:g,formatPrice:f,subtotal:h,shippingCost:i,shippingLabel:j,totalWithShipping:e,showInternationalNote:k,onShowShippingInfo:l,onIncrement:m,onDecrement:n,onRemove:o,itemErrors:p})})})]}),$=({isOpen:a,onClose:b})=>a?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:(0,c.jsxs)("div",{className:"bg-white border border-gray-200 max-w-md w-full p-6 space-y-4",children:[(0,c.jsxs)("div",{className:"flex items-start justify-between",children:[(0,c.jsx)("h3",{className:"text-sm uppercase tracking-wider text-gray-900 font-light font-inter",children:"Delivery Information"}),(0,c.jsx)("button",{type:"button",onClick:b,className:"text-gray-400 hover:text-gray-900 transition-colors font-inter","aria-label":"Close delivery information",children:(0,c.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,c.jsx)("p",{className:"text-xs text-gray-500 font-light font-inter",children:"We dispatch orders within 2 - 3 business days. Shipping costs depend on your delivery country."}),(0,c.jsx)("p",{className:"text-xs text-gray-500 font-light font-inter",children:"Including Ireland, Europe, Asia, North America, South America, Canada, Australia and New Zealand. Shipping charges are calculated at the checkout depending on location and parcel size."}),(0,c.jsxs)("ul",{className:"text-xs text-gray-600 space-y-2 font-light font-inter font-medium",children:[(0,c.jsxs)("li",{children:[(0,c.jsx)("span",{children:"UK:"})," 3-4 business days"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("span",{className:"font-medium font-medium",children:"Europe:"})," 5-10 business days"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("span",{children:"USA & Canada:"})," 7-14 business days"]}),(0,c.jsxs)("li",{children:[(0,c.jsx)("span",{className:"font-medium",children:"Rest of World:"})," 10-21 business days"]})]}),(0,c.jsx)("div",{className:"pt-2 border-t border-gray-100",children:(0,c.jsx)("p",{className:"text-xs text-gray-500 font-light font-inter leading-relaxed",children:"Orders delivered outside of the UK may be subject to import duties and taxes. These are levied when the delivery reaches its specific destination, and you will be responsible for the payment of any such duties and taxes. For more information, please contact your local customs office."})}),(0,c.jsx)("div",{className:"flex justify-end",children:(0,c.jsx)(f.default,{href:"/shipping",className:"text-xs text-gray-500 hover:text-gray-900 underline transition-colors font-light font-inter",onClick:b,children:"View full shipping policy"})})]})}):null,_="u">typeof process&&process.env?"pk_test_51SRxFZFJzpn39buGuSe4Smdsfrnrm8S3IeVJYCra5wXLFeVBGfAdOeFGYGBfStlhZnUlzUVFvajHzioLv92EVyWn00hOlOtcU4":"",aa=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];k=!0;var d=Date.now();return l().then(function(a){return j(a,b,d)})}(_||"pk_test_51234567890abcdefghijklmnopqrstuvwxyz1234567890"),ab=new Set(["AL","AD","AT","BE","BA","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IS","IE","IT","LV","LI","LT","LU","MT","MC","ME","NL","MK","NO","PL","PT","RO","SM","RS","SK","SI","ES","SE","CH"]),ac={GB:3,...Object.fromEntries(Array.from(ab).map(a=>[a,10]))},ad={GB:"England",AL:"Albania",AD:"Andorra",AT:"Austria",BE:"Belgium",BA:"Bosnia and Herzegovina",BG:"Bulgaria",HR:"Croatia",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",EE:"Estonia",FI:"Finland",FR:"France",DE:"Germany",GR:"Greece",HU:"Hungary",IS:"Iceland",IE:"Ireland",IT:"Italy",LV:"Latvia",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MT:"Malta",MC:"Monaco",ME:"Montenegro",NL:"Netherlands",MK:"North Macedonia",NO:"Norway",PL:"Poland",PT:"Portugal",RO:"Romania",SM:"San Marino",RS:"Serbia",SK:"Slovakia",SI:"Slovenia",ES:"Spain",SE:"Sweden",CH:"Switzerland"},ae=()=>{var a;let b=H("calls useStripe()").stripe,g=(a="calls useElements()",E(d.default.useContext(D),a)).elements,h=(0,e.useRouter)(),{cart:i,getTotalPrice:j,clearCart:k,incrementItemQty:l,decrementItemQty:m,removeFromCart:n}=(0,M.useCart)(),{formatPrice:o,setCurrency:p,currency:q}=(0,N.useCurrency)(),[r,s]=(0,d.useState)(!1),[t,u]=(0,d.useState)(null),[v,w]=(0,d.useState)(!1),[x,y]=(0,d.useState)(!1),[z,A]=(0,d.useState)(!1),[B,C]=(0,d.useState)(!1),[F,G]=(0,d.useState)(""),[I,J]=(0,d.useState)({}),[K,L]=(0,d.useState)({email:"",name:"",address:{line1:"",line2:"",city:"",postal_code:"",country:"GB",state:""}}),O=(0,d.useRef)({}),P=(0,d.useRef)(!1),S=j(),T=K.address.country,W=0===i.length?0:ac[T]??12,X=ad[T]||"International",_=T&&"GB"!==T.toUpperCase()&&i.length>0,aa=S+W;(0,d.useEffect)(()=>{let a=a=>{let b=a.reason?.message||a.reason?.toString()||"",c=a.reason?.url||"";(b.includes("hcaptcha")||b.includes("hCaptcha")||c.includes("api.hcaptcha.com")||b.includes("401")&&b.includes("Unauthorized"))&&a.preventDefault()};return window.addEventListener("unhandledrejection",a),()=>{window.removeEventListener("unhandledrejection",a)}},[]),(0,d.useEffect)(()=>{T&&(ab.has(T)?p("EUR"):"GB"===T&&p("GBP"))},[T,p]),(0,d.useEffect)(()=>{let a=()=>{let a=localStorage.getItem("userEmail");"true"===localStorage.getItem("isLoggedIn")&&a?(C(!0),G(a),L(b=>b.email?b:{...b,email:a})):(C(!1),G(""))};a();let b=()=>{a()},c=b=>{("userEmail"===b.key||"isLoggedIn"===b.key)&&a()};return window.addEventListener("focus",b),window.addEventListener("storage",c),()=>{window.removeEventListener("focus",b),window.removeEventListener("storage",c)}},[]),(0,d.useEffect)(()=>{let a=O.current;return Object.keys(I).forEach(b=>{a[b]&&clearTimeout(a[b]),a[b]=setTimeout(()=>{J(a=>{let c={...a};return"string"==typeof c[b]?delete c[b]:c[b]&&"object"==typeof c[b]&&delete c[b],c}),delete a[b]},3e3)}),()=>{Object.values(a).forEach(a=>{clearTimeout(a)})}},[I]),(0,d.useEffect)(()=>{0!==i.length||P.current||h.push("/cart")},[i,h]),(0,d.useEffect)(()=>{w(!1)},[g]);let ae=a=>{let b="string"==typeof a?i.find(b=>b.id===a):"number"==typeof a&&a>=0&&a<i.length?i[a]:null;if(!b)return;let c=(0,Q.getMaxAvailableQuantity)(b,i);if(null===c||c>0)l(a),J(b=>{let c={...b};return delete c[a],c});else{let c="";if("charm"===b.type){c=b.name||b.pin?.name||"Charm";let d=`Oops! We don't have any more ${c} in stock right now, so you can't add more to your basket.`;J(b=>({...b,[a]:d}))}else console.log("⚠️ Case item - incrementing anyway despite inventory check"),l(a)}},af=a=>{m(a),J(b=>{let c={...b};return delete c[a],c})};(0,d.useEffect)(()=>{0!==i.length||P.current||h.push("/cart")},[i,h]);let ag=async a=>{if(a.preventDefault(),!b||!g)return void u("Stripe is not loaded. Please wait...");if(!g.getElement("payment"))return void u("Payment form is not ready. Please wait...");if(!v)return void u("Payment form is still loading. Please wait...");s(!0),u(null);try{await (0,Q.refreshInventoryFromSupabase)();let a=[],c=new Map;for(let a of i){let b="",d="";if("charm"===a.type){let c=a.category||a.pin?.category||"colorful",e=a.pin?.name||a.name||"";b=`charm-${c}-${e}`,d=a.name||a.pin?.name||"Charm"}else a.caseType&&a.color?(b=`case-${a.caseType}-${a.color}`,d=a.caseName||a.name||"Passport Case"):(b=a.id||`item-${a.name}`,d=a.name||"Item");c.has(b)||c.set(b,{item:a,name:d,totalQuantity:0});let e=c.get(b);e.totalQuantity+=a.quantity||1}for(let[b,d]of c){let b=(0,Q.getMaxAvailableQuantity)(d.item,[]);null!==b&&(0===b||d.totalQuantity>b)&&a.push(d.name)}if(a.length>0){let b=1===a.length?a[0]:a.slice(0,-1).join(", ")+" and "+a[a.length-1],c=`Sorry, ${b} ${1===a.length?"is":"are"} no longer available. Please remove ${1===a.length?"it":"them"} from your cart and try again.`;u(c),s(!1);return}let{error:d,paymentIntent:e}=await b.confirmPayment({elements:g,confirmParams:{return_url:`${window.location.origin}/payment-success`,payment_method_data:{billing_details:{name:K.name,email:K.email,phone:null,address:{line1:K.address.line1,line2:K.address.line2,city:K.address.city,postal_code:K.address.postal_code,country:K.address.country,state:K.address.state}}}},redirect:"if_required"});if(d){u(d.message||"An error occurred while processing your payment."),s(!1);return}e&&"succeeded"===e.status?(P.current=!0,[...i],k(),h.push("/payment-success")):e&&"requires_action"===e.status||e&&(P.current=!0,[...i],k(),h.push("/payment-success"))}catch(a){u("An error occurred while processing your payment.")}finally{s(!1)}};return(0,c.jsxs)("div",{className:"h-full w-full",children:[(0,c.jsx)(Z,{isOpen:z,onToggle:()=>A(a=>!a),cartLength:i.length,totalWithShipping:aa,formatPrice:o,cart:i,subtotal:S,shippingCost:W,shippingLabel:X,showInternationalNote:_,onShowShippingInfo:()=>y(!0),onIncrement:ae,onDecrement:af,onRemove:n,itemErrors:I}),(0,c.jsxs)("div",{className:"flex flex-col lg:flex-row  w-full ",children:[(0,c.jsxs)("form",{onSubmit:ag,className:"space-y-6  mt-6 lg:mt-0 lg:p-6 w-full lg:w-1/2 lg:flex-shrink-0",children:[(0,c.jsx)(U,{customerInfo:K,onInputChange:a=>{let{name:b,value:c}=a.target;if(b.includes(".")){let[a,d]=b.split(".");L(b=>({...b,[a]:{...b[a],[d]:c}}))}else L(a=>({...a,[b]:c}))},isAuthenticated:B,authenticatedEmail:F,onSignIn:a=>{C(!0),G(a)},onSignOut:()=>{C(!1),G(""),localStorage.removeItem("userId")}}),(0,c.jsx)(V,{paymentElementReady:v,error:t,onPaymentReady:()=>w(!0),onPaymentError:a=>{u(a)}}),(0,c.jsx)("button",{type:"submit",disabled:!b||!g||r||!v,className:"w-full py-3 text-sm uppercase tracking-wider font-light disabled:opacity-50 disabled:cursor-not-allowed font-inter bg-btn-primary hover:bg-btn-primary-hover text-btn-primary-text border border-btn-primary-border hover:border-btn-primary-hover transition-all duration-200",children:r?"Processing...":"Complete Payment"}),_&&(0,c.jsx)(R,{className:"mt-4",showOnDesktop:!1,showOnMobile:!0,title:"Custom Duties & Taxes Included",message:"The total amount you pay includes all applicable customs duties & taxes. We guarantee no additional charges on delivery.",variant:"gray"})]}),(0,c.jsx)("aside",{className:"hidden lg:flex border border-gray-200 bg-yellow-50 p-6 w-full lg:w-1/2 lg:sticky lg:top-20 mt-4 lg:mt-0 flex-col max-h-[calc(100vh-8rem)]",children:(0,c.jsx)("div",{className:"flex-1 overflow-hidden flex flex-col min-h-0",children:(0,c.jsx)(Y,{cart:i,formatPrice:o,subtotal:S,shippingCost:W,shippingLabel:X,totalWithShipping:aa,showInternationalNote:_,onShowShippingInfo:()=>y(!0),onIncrement:ae,onDecrement:af,onRemove:n,itemErrors:I})})}),(0,c.jsx)($,{isOpen:x,onClose:()=>y(!1)})]}),(0,c.jsx)("div",{className:"w-full border-t border-gray-200 mt-8 pt-6 pb-6",children:(0,c.jsx)("div",{className:"max-w-6xl mx-auto px-4 lg:px-6",children:(0,c.jsxs)("div",{className:"flex flex-wrap justify-center gap-4 md:gap-6 text-xs text-gray-600 font-light font-inter",children:[(0,c.jsx)(f.default,{href:"/returns",className:"hover:text-gray-900 transition-colors underline",children:"Refund Policy"}),(0,c.jsx)("span",{className:"text-gray-300",children:"|"}),(0,c.jsx)(f.default,{href:"/shipping",className:"hover:text-gray-900 transition-colors underline",children:"Shipping"}),(0,c.jsx)("span",{className:"text-gray-300",children:"|"}),(0,c.jsx)(f.default,{href:"/returns",className:"hover:text-gray-900 transition-colors underline",children:"Cancellations"}),(0,c.jsx)("span",{className:"text-gray-300",children:"|"}),(0,c.jsx)(f.default,{href:"/about",className:"hover:text-gray-900 transition-colors underline",children:"Contact"})]})})})]})};a.s(["default",0,()=>{let{cart:a,getTotalPrice:b}=(0,M.useCart)(),{currency:f,convertPrice:g}=(0,N.useCurrency)();(0,e.useRouter)();let[h,i]=(0,d.useState)(null),[j,k]=(0,d.useState)(!0),[l,m]=(0,d.useState)(null),n=(0,d.useRef)(!1);if((0,d.useEffect)(()=>{0===a.length||n.current||null!==h||(async()=>{try{n.current=!0,k(!0),m(null);let c=b(),d=g(c),e={jpy:1,krw:1,vnd:1}[f.toLowerCase()]||100,h=Math.round(d*e),j=f.toLowerCase(),l=await P({amount:h,currency:j,items:a,customerInfo:{}});i({clientSecret:l.client_secret,appearance:{theme:"stripe",variables:{colorPrimary:"#3b82f6",colorBackground:"#ffffff",colorText:"#1f2937",colorDanger:"#ef4444",fontFamily:"system-ui, sans-serif",spacingUnit:"4px",borderRadius:"8px"}}})}catch(b){let a="Failed to initialize payment. ";b?.message?a+=b.message:a+="Please ensure the backend server is running on port 3001.",m(a),n.current=!1}finally{k(!1)}})()},[a.length]),j)return(0,c.jsx)(T,{});if(l)return(0,c.jsxs)("div",{className:"min-h-screen flex flex-col bg-white",children:[(0,c.jsx)(S,{}),(0,c.jsx)("div",{className:"flex-1 flex items-center justify-center bg-white py-10",children:(0,c.jsx)("div",{className:"max-w-md mx-auto px-4 text-center",children:(0,c.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-red-900 mb-3",style:{fontFamily:"'Poppins', sans-serif"},children:"Payment Setup Error"}),(0,c.jsx)("p",{className:"text-red-700 mb-4 font-inter",children:l}),(0,c.jsxs)("div",{className:"text-sm text-red-600 mb-4 font-inter",children:[(0,c.jsx)("p",{className:"mb-2",children:"To fix this issue:"}),(0,c.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-left",children:[(0,c.jsxs)("li",{children:["Make sure your backend server is running: ",(0,c.jsx)("code",{className:"bg-red-100 px-1 rounded",children:"npm run server"})]}),(0,c.jsx)("li",{children:"Verify the server is running on port 3001"}),(0,c.jsx)("li",{children:"Check that the proxy is configured correctly"}),(0,c.jsx)("li",{children:"Refresh this page to retry"})]})]}),(0,c.jsx)("button",{onClick:()=>{m(null),n.current=!1,window.location.reload()},className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors font-inter",children:"Retry"})]})})})]});if(!h)return(0,c.jsx)(T,{});let o="pk_test_51234567890abcdefghijklmnopqrstuvwxyz1234567890"===_;return!_||o?(0,c.jsxs)("div",{className:"min-h-screen flex flex-col bg-white",children:[(0,c.jsx)(S,{}),(0,c.jsx)("div",{className:"flex-1 flex items-center justify-center bg-white py-10",children:(0,c.jsx)("div",{className:"max-w-md mx-auto px-4 text-center",children:(0,c.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-yellow-900 mb-3",style:{fontFamily:"'Poppins', sans-serif"},children:"Stripe Configuration Missing"}),(0,c.jsx)("p",{className:"text-yellow-700 mb-4 font-inter",children:"Please set NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY in your environment variables."}),(0,c.jsx)("p",{className:"text-xs text-yellow-600 mb-2 font-inter",children:"(Also supports VITE_STRIPE_PUBLISHABLE_KEY for backward compatibility)"}),(0,c.jsx)("p",{className:"text-sm text-yellow-600 font-inter",children:"The Stripe publishable key is required to process payments."})]})})})]}):(0,c.jsxs)("div",{className:"min-h-screen flex flex-col bg-white",children:[(0,c.jsx)(S,{}),(0,c.jsx)("div",{className:"flex-1 flex items-stretch bg-white py-10",children:(0,c.jsx)("div",{className:"flex-1 max-w-6xl mx-auto px-4 lg:px-6",children:(0,c.jsx)(F,{stripe:aa,options:h,children:(0,c.jsx)(ae,{})})})})]})}],19941)}];

//# sourceMappingURL=src_component_Checkout_index_jsx_1c78712b._.js.map