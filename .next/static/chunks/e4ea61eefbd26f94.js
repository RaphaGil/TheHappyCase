(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19790,e=>{"use strict";var s=e.i(43476);e.i(71645);var r=e.i(22123),t=e.i(28690);e.s(["default",0,e=>{let{item:a}=e,n=a.design_image||a.designImage||a.case_image||a.caseImage||a.image,i=a.caseName||a.name||"Custom Case",o=0;void 0!==a.total_price?o=parseFloat(a.total_price)||0:void 0!==a.totalPrice?o=(parseFloat(a.totalPrice)||0)*(a.quantity||1):void 0!==a.price&&(o=(parseFloat(a.price)||0)*(a.quantity||1));let l=a.color?(0,t.getColorName)(a.color,a.case_image||a.caseImage||a.image):null;return(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[n&&(0,s.jsx)("img",{src:(0,r.normalizeImagePath)(n),alt:i,className:"w-16 h-16 md:w-20 md:h-20 object-contain rounded",loading:"lazy"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-semibold text-gray-900 mb-1 font-inter",children:i}),l&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1 font-inter",children:["Color: ",(0,s.jsx)("span",{className:"font-medium",children:l})]}),(a.pinsDetails&&a.pinsDetails.length>0||a.pins&&Array.isArray(a.pins)&&a.pins.length>0)&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1 font-inter",children:["Charms: ",(0,s.jsx)("span",{className:"font-medium",children:(a.pinsDetails||a.pins||[]).length})]}),a.quantity>1&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1 font-inter",children:["Quantity: ",(0,s.jsx)("span",{className:"font-medium",children:a.quantity})]}),(0,s.jsxs)("p",{className:"text-sm font-semibold text-gray-900 mt-2 font-inter",children:["Â£",o.toFixed(2)]})]})]})})}])},62038,e=>{"use strict";var s=e.i(43476),r=e.i(71645),t=e.i(18566),a=e.i(34290),n=e.i(63707),i=e.i(19790),o=e.i(11488),l=e.i(68757);let d=(0,a.getSupabaseClient)();e.s(["default",0,()=>{let e=(0,t.useRouter)(),[a,c]=(0,r.useState)([]),[m,x]=(0,r.useState)(!0),[h,g]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1),[y,f]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{let s=localStorage.getItem("userEmail");if("true"!==localStorage.getItem("isLoggedIn")||!s)return void e.push("/login?redirect=/my-orders");let r=null==s?void 0:s.toLowerCase().trim(),t="thehappycase.shop@gmail.com".trim();r===t&&f(!0),d?d.auth.getUser().then(e=>{let{data:r,error:a}=e;if(!a&&(null==r?void 0:r.user)){var n,i,o;f((null==(i=r.user)||null==(n=i.email)?void 0:n.toLowerCase().trim())===t),(null==(o=r.user)?void 0:o.id)?(v(r.user.id),j(r.user.id,s)):j(null,s)}else j(null,s)}):j(null,s)},[e]);let j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;x(!0),g("");try{let r,t;if(e)r=(0,n.getApiUrl)("/get-orders?user_id=".concat(encodeURIComponent(e))),console.log("ðŸ“¡ Fetching orders by user_id:",e);else if(s)r=(0,n.getApiUrl)("/get-orders?email=".concat(encodeURIComponent(s))),console.log("ðŸ“¡ Fetching orders by email:",s);else throw Error("No user_id or email provided");console.log("ðŸ“¡ Fetching orders from:",r);let a=await fetch(r);if((a.headers.get("content-type")||"").includes("text/html"))throw Error("Backend server returned HTML (likely 404). Is the server running on port 3001?");let i=await a.text();if(!i||""===i.trim())throw console.error("âŒ Empty response received. Status:",a.status,a.statusText),console.error("âŒ Response headers:",Object.fromEntries(a.headers.entries())),Error("Server returned empty response (".concat(a.status,"). Check server logs for errors. Make sure the backend server is running on port 3001."));try{t=JSON.parse(i)}catch(e){throw console.error("âŒ Failed to parse JSON response:",e),console.error("âŒ Response status:",a.status,a.statusText),console.error("âŒ Response text (first 500 chars):",i.substring(0,500)),Error("Server returned invalid JSON (".concat(a.status,"): ").concat(e.message,". Response: ").concat(i.substring(0,200)))}if(!a.ok){console.error("âŒ Server error response:",{status:a.status,data:t});let e=(null==t?void 0:t.error)||(null==t?void 0:t.message)||"Server error: ".concat(a.status," ").concat(a.statusText);throw Error(e)}t.success&&void 0!==t.orders?c(t.orders||[]):t.error?g(t.error||"Failed to load orders"):c(Array.isArray(t)?t:t.orders||[])}catch(e){console.error("Error fetching orders:",e),g(e.message||"Failed to load your orders. Please try again later.")}finally{x(!1)}},N=localStorage.getItem("userEmail");return m?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 md:py-12",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600 font-inter",children:"Loading your orders..."})]})})}):h?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 md:py-12",children:(0,s.jsx)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 md:p-8 text-center",children:[(0,s.jsx)("div",{className:"text-red-600 mb-4",children:(0,s.jsx)("svg",{className:"mx-auto h-12 w-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",style:{fontFamily:"'Poppins', sans-serif"},children:"Error Loading Orders"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6 font-inter",children:h}),(0,s.jsx)("button",{onClick:()=>j(N),className:"px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-md transition-colors font-inter",children:"Try Again"})]})})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 py-8 md:py-12",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsx)("div",{className:"mb-8",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",style:{fontFamily:"'Poppins', sans-serif"},children:"My Orders"}),(0,s.jsx)("p",{className:"text-gray-600 font-inter",children:N})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 self-start",children:[y&&(0,s.jsxs)("button",{onClick:()=>e.push("/dashboard"),className:"px-4 py-2 text-sm text-white bg-gray-900 hover:bg-gray-800 rounded-md transition-colors font-inter flex items-center gap-2",children:[(0,s.jsx)(o.FontAwesomeIcon,{icon:l.faChartLine,className:"w-4 h-4"}),"Dashboard"]}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("userEmail"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userId"),e.push("/login")},className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors font-inter",children:"Sign Out"})]})]})}),0===a.length?(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 md:p-12 text-center",children:[(0,s.jsx)("div",{className:"text-gray-400 mb-4",children:(0,s.jsx)("svg",{className:"mx-auto h-16 w-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",style:{fontFamily:"'Poppins', sans-serif"},children:"No Orders Yet"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6 font-inter",children:"You haven't placed any orders yet. Start shopping to see your orders here!"}),(0,s.jsx)("button",{onClick:()=>e.push("/"),className:"px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-md transition-colors font-inter",children:"Start Shopping"})]}):(0,s.jsx)("div",{className:"space-y-6",children:a.map(e=>{var r,t,a,n,o,l,d;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-1 font-inter",children:["Order #",e.order_id.slice(-8).toUpperCase()]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 font-inter",children:["Placed on ",(e=>{let s;if(!e)return"N/A";if("string"==typeof e)s=new Date(e);else{if("number"!=typeof e)return"N/A";s=new Date(1e3*e)}return s.toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})(e.order_date)]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:items-end gap-2",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold font-inter ".concat("succeeded"===e.status||"complete"===e.status?"bg-green-100 text-green-800":"processing"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:(null==(r=e.status)?void 0:r.charAt(0).toUpperCase())+(null==(t=e.status)?void 0:t.slice(1))})}),(0,s.jsxs)("p",{className:"text-lg font-bold text-gray-900 font-inter",children:["Â£",parseFloat(e.total_amount).toFixed(2)]})]})]})}),(0,s.jsxs)("div",{className:"p-6",children:[e.items&&Array.isArray(e.items)&&e.items.length>0?(0,s.jsx)("div",{className:"space-y-3",children:e.items.map((e,r)=>(0,s.jsx)(i.default,{item:e},r))}):(0,s.jsx)("p",{className:"text-gray-600 font-inter",children:"No items found in this order."}),(null==(a=e.metadata)?void 0:a.dispatched)&&((null==(n=e.tracking)?void 0:n.tracking_number)||(null==(o=e.tracking)?void 0:o.tracking_link))&&(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold text-gray-900 mb-3 font-inter flex items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Tracking Information"]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3",children:[(null==(l=e.tracking)?void 0:l.tracking_number)&&(0,s.jsxs)("div",{className:"text-sm font-inter",children:[(0,s.jsx)("span",{className:"font-semibold text-gray-700",children:"Tracking Number:"})," ",(0,s.jsx)("span",{className:"text-gray-900 font-mono",children:e.tracking.tracking_number})]}),(null==(d=e.tracking)?void 0:d.tracking_link)&&(0,s.jsx)("div",{className:"text-sm font-inter",children:(0,s.jsxs)("a",{href:e.tracking.tracking_link,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 hover:underline font-medium",children:[(0,s.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Track Your Package"]})})]})]}),e.shipping_address&&(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2 font-inter",children:"Shipping Address"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 font-inter",children:[e.customer_name&&(0,s.jsx)("p",{children:e.customer_name}),e.shipping_address.line1&&(0,s.jsx)("p",{children:e.shipping_address.line1}),e.shipping_address.line2&&(0,s.jsx)("p",{children:e.shipping_address.line2}),(0,s.jsxs)("p",{children:[e.shipping_address.city,e.shipping_address.postal_code&&" ".concat(e.shipping_address.postal_code)]}),e.shipping_address.country&&(0,s.jsx)("p",{children:e.shipping_address.country})]})]}),(0,s.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,s.jsx)("button",{onClick:()=>p(!0),className:"px-4 py-2 text-sm text-gray-700 hover:text-gray-900 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors font-inter",children:"Request Refund"})})]})]},e.order_id)})}),u&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6 md:p-8",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",style:{fontFamily:"'Poppins', sans-serif"},children:"Refund Policy"}),(0,s.jsx)("div",{className:"w-12 h-px bg-gray-300 mb-4"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("p",{className:"text-gray-700 mt-4 mb-4 leading-relaxed font-inter",children:["If you find there is an issue with your item, please contact us at"," ",(0,s.jsx)("a",{href:"mailto:thehappycase.shop@gmail.com",className:"text-blue-600 hover:text-blue-800 underline font-inter",children:"thehappycase.shop@gmail.com"}),". Please allow us to reply in 5 working days and we will do our best to assist you."]}),(0,s.jsx)("p",{className:"text-gray-700 leading-relaxed font-inter",children:"Please note that there is no returns or refunds for customised products. We only offer returns/refunds if there has been a fault on our end. This is due to our stock being made-to-order."}),(0,s.jsx)("p",{className:"text-gray-700 mt-3 font-semibold font-inter",children:"Thanks for understanding!"})]}),(0,s.jsx)("button",{onClick:()=>p(!1),className:"w-full px-4 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-md transition-colors font-inter",children:"Understood"})]})})]})})}])}]);